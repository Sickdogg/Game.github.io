var Rs=Object.defineProperty;var Os=(d,i,a)=>i in d?Rs(d,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):d[i]=a;var cr=(d,i,a)=>(Os(d,typeof i!="symbol"?i+"":i,a),a);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const w of document.querySelectorAll('link[rel="modulepreload"]'))g(w);new MutationObserver(w=>{for(const x of w)if(x.type==="childList")for(const y of x.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&g(y)}).observe(document,{childList:!0,subtree:!0});function a(w){const x={};return w.integrity&&(x.integrity=w.integrity),w.referrerPolicy&&(x.referrerPolicy=w.referrerPolicy),w.crossOrigin==="use-credentials"?x.credentials="include":w.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function g(w){if(w.ep)return;w.ep=!0;const x=a(w);fetch(w.href,x)}})();function De(){}function oi(d){return d()}function ei(){return Object.create(null)}function zt(d){d.forEach(oi)}function si(d){return typeof d=="function"}function mr(d,i){return d!=d?i==i:d!==i||d&&typeof d=="object"||typeof d=="function"}function Vs(d){return Object.keys(d).length===0}function zs(d,...i){if(d==null){for(const g of i)g(void 0);return De}const a=d.subscribe(...i);return a.unsubscribe?()=>a.unsubscribe():a}function Rt(d,i,a){d.$$.on_destroy.push(zs(i,a))}function Ot(d,i,a){d.insertBefore(i,a||null)}function Ct(d){d.parentNode&&d.parentNode.removeChild(d)}function vr(d){return document.createElement(d)}function Ns(d){return document.createTextNode(d)}function Hs(){return Ns(" ")}function Ws(d,i,a){a==null?d.removeAttribute(i):d.getAttribute(i)!==a&&d.setAttribute(i,a)}function Ys(d){return Array.from(d.childNodes)}function ti(d,i,a,g){a==null?d.style.removeProperty(i):d.style.setProperty(i,a,g?"important":"")}let It;function St(d){It=d}function qs(){if(!It)throw new Error("Function called outside component initialization");return It}function js(d){qs().$$.on_mount.push(d)}const ct=[],ri=[];let ht=[];const ni=[],Xs=Promise.resolve();let pr=!1;function Gs(){pr||(pr=!0,Xs.then(ai))}function gr(d){ht.push(d)}const hr=new Set;let lt=0;function ai(){if(lt!==0)return;const d=It;do{try{for(;lt<ct.length;){const i=ct[lt];lt++,St(i),Us(i.$$)}}catch(i){throw ct.length=0,lt=0,i}for(St(null),ct.length=0,lt=0;ri.length;)ri.pop()();for(let i=0;i<ht.length;i+=1){const a=ht[i];hr.has(a)||(hr.add(a),a())}ht.length=0}while(ct.length);for(;ni.length;)ni.pop()();pr=!1,hr.clear(),St(d)}function Us(d){if(d.fragment!==null){d.update(),zt(d.before_update);const i=d.dirty;d.dirty=[-1],d.fragment&&d.fragment.p(d.ctx,i),d.after_update.forEach(gr)}}function Zs(d){const i=[],a=[];ht.forEach(g=>d.indexOf(g)===-1?i.push(g):a.push(g)),a.forEach(g=>g()),ht=i}const Vt=new Set;let $s;function li(d,i){d&&d.i&&(Vt.delete(d),d.i(i))}function Ks(d,i,a,g){if(d&&d.o){if(Vt.has(d))return;Vt.add(d),$s.c.push(()=>{Vt.delete(d),g&&(a&&d.d(1),g())}),d.o(i)}else g&&g()}function Js(d){d&&d.c()}function ui(d,i,a){const{fragment:g,after_update:w}=d.$$;g&&g.m(i,a),gr(()=>{const x=d.$$.on_mount.map(oi).filter(si);d.$$.on_destroy?d.$$.on_destroy.push(...x):zt(x),d.$$.on_mount=[]}),w.forEach(gr)}function ci(d,i){const a=d.$$;a.fragment!==null&&(Zs(a.after_update),zt(a.on_destroy),a.fragment&&a.fragment.d(i),a.on_destroy=a.fragment=null,a.ctx=[])}function Qs(d,i){d.$$.dirty[0]===-1&&(ct.push(d),Gs(),d.$$.dirty.fill(0)),d.$$.dirty[i/31|0]|=1<<i%31}function hi(d,i,a,g,w,x,y=null,_=[-1]){const b=It;St(d);const C=d.$$={fragment:null,ctx:[],props:x,update:De,not_equal:w,bound:ei(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(b?b.$$.context:[])),callbacks:ei(),dirty:_,skip_bound:!1,root:i.target||b.$$.root};y&&y(C.root);let D=!1;if(C.ctx=a?a(d,i.props||{},(k,B,...z)=>{const H=z.length?z[0]:B;return C.ctx&&w(C.ctx[k],C.ctx[k]=H)&&(!C.skip_bound&&C.bound[k]&&C.bound[k](H),D&&Qs(d,k)),B}):[],C.update(),D=!0,zt(C.before_update),C.fragment=g?g(C.ctx):!1,i.target){if(i.hydrate){const k=Ys(i.target);C.fragment&&C.fragment.l(k),k.forEach(Ct)}else C.fragment&&C.fragment.c();i.intro&&li(d.$$.fragment),ui(d,i.target,i.anchor),ai()}St(b)}class di{constructor(){cr(this,"$$");cr(this,"$$set")}$destroy(){ci(this,1),this.$destroy=De}$on(i,a){if(!si(a))return De;const g=this.$$.callbacks[i]||(this.$$.callbacks[i]=[]);return g.push(a),()=>{const w=g.indexOf(a);w!==-1&&g.splice(w,1)}}$set(i){this.$$set&&!Vs(i)&&(this.$$.skip_bound=!0,this.$$set(i),this.$$.skip_bound=!1)}}const ea="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ea);var ta=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},vi={exports:{}},fr={exports:{}};/**
 * @license
 * KLineChart v9.6.0
 * Copyright (c) 2019 lihu.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */(function(d,i){(function(a,g){g(i)})(ta,function(a){var g,w,x,y,_,b,C,D,k;function B(o,e){if(Z(o)||Z(e)){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=o[t],n=e[t];Z(n)&&Z(r)?B(r,n):q(e[t])&&(o[t]=z(e[t]))}}}function z(o){if(!Z(o))return o;var e;for(var t in e=H(o)?[]:{},o)if(Object.prototype.hasOwnProperty.call(o,t)){var r=o[t];e[t]=Z(r)?z(r):r}return e}function H(o){return Object.prototype.toString.call(o)==="[object Array]"}function U(o){return typeof o=="function"}function Z(o){return typeof o=="object"&&q(o)}function se(o){return typeof o=="number"&&!isNaN(o)}function q(o){return o!=null}function fe(o){return typeof o=="boolean"}function oe(o){return typeof o=="string"}a.LineType=void 0,(g=a.LineType||(a.LineType={})).Dashed="dashed",g.Solid="solid",a.PolygonType=void 0,(w=a.PolygonType||(a.PolygonType={})).Stroke="stroke",w.Fill="fill",w.StrokeFill="stroke_fill",a.TooltipShowRule=void 0,(x=a.TooltipShowRule||(a.TooltipShowRule={})).Always="always",x.FollowCross="follow_cross",x.None="none",a.TooltipShowType=void 0,(y=a.TooltipShowType||(a.TooltipShowType={})).Standard="standard",y.Rect="rect",a.TooltipIconPosition=void 0,(_=a.TooltipIconPosition||(a.TooltipIconPosition={})).Left="left",_.Middle="middle",_.Right="right",function(o){o.Fixed="fixed",o.Pointer="pointer"}(b||(b={})),a.CandleType=void 0,(C=a.CandleType||(a.CandleType={})).CandleSolid="candle_solid",C.CandleStroke="candle_stroke",C.CandleUpStroke="candle_up_stroke",C.CandleDownStroke="candle_down_stroke",C.Ohlc="ohlc",C.Area="area",a.YAxisPosition=void 0,(D=a.YAxisPosition||(a.YAxisPosition={})).Left="left",D.Right="right",a.YAxisType=void 0,(k=a.YAxisType||(a.YAxisType={})).Normal="normal",k.Percentage="percentage",k.Log="log";var de,xe=/\\(\\)?/g,re=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g");function te(o,e,t){if(q(o)){var r=[];e.replace(re,function(u){for(var c=[],h=1;arguments.length>h;h++)c[h-1]=arguments[h];var v=u;return q(c[1])?v=c[2].replace(xe,"$1"):q(c[0])&&(v=c[0].trim()),r.push(v),""});for(var n=o,s=0,l=r.length;q(n)&&l>s;)n=n==null?void 0:n[r[s++]];return q(n)?n:t??"--"}return t??"--"}function ke(o,e,t){var r=o.format(new Date(e)).split(", "),n=r[0].split("/"),s=r[1].split(":"),l={YYYY:n[2],MM:n[0],DD:n[1],HH:s[0]==="24"?"00":s[0],mm:s[1],ss:s[2]};return t.replace(/YYYY|MM|DD|HH|mm|ss/g,function(u){return l[u]})}function ne(o,e){var t=+o;return se(t)?t.toFixed(e??2):"".concat(o)}function vt(o){var e=+o;if(se(e)){if(e>1e9)return"".concat(+(e/1e9).toFixed(3),"B");if(e>1e6)return"".concat(+(e/1e6).toFixed(3),"M");if(e>1e3)return"".concat(+(e/1e3).toFixed(3),"K")}return"".concat(o)}function ue(o,e){var t="".concat(o);if(e.length===0)return t;if(t.includes(".")){var r=t.split(".");return"".concat(r[0].replace(/(\d)(?=(\d{3})+$)/g,function(n){return"".concat(n).concat(e)}),".").concat(r[1])}return t.replace(/(\d)(?=(\d{3})+$)/g,function(n){return"".concat(n).concat(e)})}a.FormatDateType=void 0,(de=a.FormatDateType||(a.FormatDateType={}))[de.Tooltip=0]="Tooltip",de[de.Crosshair=1]="Crosshair",de[de.XAxis=2]="XAxis";var nt=function(o,e){return nt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])},nt(o,e)};function $(o,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+e+" is not a constructor or null");function t(){this.constructor=o}nt(o,e),o.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ae,j=function(){return j=Object.assign||function(o){for(var e,t=1,r=arguments.length;r>t;t++)for(var n in e=arguments[t])Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=e[n]);return o},j.apply(this,arguments)};function Xe(o,e,t,r){return new(t||(t=Promise))(function(n,s){function l(h){try{c(r.next(h))}catch(v){s(v)}}function u(h){try{c(r.throw(h))}catch(v){s(v)}}function c(h){var v;h.done?n(h.value):(v=h.value,v instanceof t?v:new t(function(p){p(v)})).then(l,u)}c((r=r.apply(o,e||[])).next())})}function Ge(o,e){var t,r,n,s,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(c){return function(h){return function(v){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,v[0]&&(l=0)),l;)try{if(t=1,r&&(n=2&v[0]?r.return:v[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,v[1])).done)return n;switch(r=0,n&&(v=[2&v[0],n.value]),v[0]){case 0:case 1:n=v;break;case 4:return l.label++,{value:v[1],done:!1};case 5:l.label++,r=v[1],v=[0];continue;case 7:v=l.ops.pop(),l.trys.pop();continue;default:if(n=l.trys,!((n=n.length>0&&n[n.length-1])||v[0]!==6&&v[0]!==2)){l=0;continue}if(v[0]===3&&(!n||v[1]>n[0]&&n[3]>v[1])){l.label=v[1];break}if(v[0]===6&&n[1]>l.label){l.label=n[1],n=v;break}if(n&&n[2]>l.label){l.label=n[2],l.ops.push(v);break}n[2]&&l.ops.pop(),l.trys.pop();continue}v=e.call(o,l)}catch(p){v=[6,p],r=0}finally{t=n=0}if(5&v[0])throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}([c,h])}}}function Fe(o){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&o[e],r=0;if(t)return t.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&r>=o.length&&(o=void 0),{value:o&&o[r++],done:!o}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ge(o,e){var t=typeof Symbol=="function"&&o[Symbol.iterator];if(!t)return o;var r,n,s=t.call(o),l=[];try{for(;(e===void 0||e-- >0)&&!(r=s.next()).done;)l.push(r.value)}catch(u){n={error:u}}finally{try{r&&!r.done&&(t=s.return)&&t.call(s)}finally{if(n)throw n.error}}return l}function nn(o,e,t){if(t||arguments.length===2)for(var r,n=0,s=e.length;s>n;n++)!r&&n in e||(r||(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return o.concat(r||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError,a.ActionType=void 0,(Ae=a.ActionType||(a.ActionType={})).OnZoom="onZoom",Ae.OnScroll="onScroll",Ae.OnVisibleRangeChange="onVisibleRangeChange",Ae.OnTooltipIconClick="onTooltipIconClick",Ae.OnCrosshairChange="onCrosshairChange",Ae.OnCandleBarClick="onCandleBarClick",Ae.OnPaneDrag="onPaneDrag";var Mt,Po=function(){function o(){this._callbacks=[]}return o.prototype.subscribe=function(e){var t;0>((t=this._callbacks.indexOf(e))!==null&&t!==void 0?t:-1)&&this._callbacks.push(e)},o.prototype.unsubscribe=function(e){var t;if(e!==void 0){var r=(t=this._callbacks.indexOf(e))!==null&&t!==void 0?t:-1;r>-1&&this._callbacks.splice(r,1)}else this._callbacks=[]},o.prototype.execute=function(e){this._callbacks.forEach(function(t){t(e)})},o.prototype.isEmpty=function(){return this._callbacks.length===0},o}(),Ut=1,on=new Date().getTime();function sn(o){var e=new Date().getTime();return e===on?++Ut:Ut=1,on=e,"".concat(o??"").concat(e,"_").concat(Ut)}function Le(o,e){var t,r=document.createElement(o),n=e??{};for(var s in n)r.style[s]=(t=n[s])!==null&&t!==void 0?t:"";return r}function Ue(o){var e,t,r;return Math.ceil((r=(t=(e=o.ownerDocument)===null||e===void 0?void 0:e.defaultView)===null||t===void 0?void 0:t.devicePixelRatio)!==null&&r!==void 0?r:2)}function Ze(o,e,t){return"".concat(e??"normal"," ").concat(o??12,"px ").concat(t??"Helvetica Neue")}function pt(o,e,t,r){if(Mt===void 0){var n=document.createElement("canvas"),s=Ue(n);(Mt=n.getContext("2d")).scale(s,s)}return Mt.font=Ze(e,t,r),Math.round(Mt.measureText(o).width)}function Zt(o,e,t){var r=0,n=0;for(n=o.length-1;r!==n;){var s=Math.floor((n+r)/2),l=n-r,u=o[s][e];if(t===o[r][e])return r;if(t===o[n][e])return n;if(t===u)return s;if(t>u?r=s:n=s,2>=l)break}return r}function an(o,e){return e==null&&(e=10),+(+o).toFixed(e=Math.min(Math.max(0,e),20))}function ln(o,e,t){var r=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];return o.forEach(function(n){var s,l;r[0]=Math.max((s=n[e])!==null&&s!==void 0?s:n,r[0]),r[1]=Math.min((l=n[t])!==null&&l!==void 0?l:n,r[1])}),r}function gt(o){return Math.log(o)/Math.log(10)}function $e(o){return Math.pow(10,o)}var $t,Mo=1,Do=50,ko=function(){function o(e){this._dateTimeFormat=this._buildDateTimeFormat(),this._zoomEnabled=!0,this._scrollEnabled=!0,this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalBarSpace=0,this._barSpace=6,this._offsetRightDistance=50,this._startScrollOffsetRightBarCount=0,this._minVisibleBarCount={left:2,right:2},this._visibleRange={from:0,to:0,realFrom:0,realTo:0},this._chartStore=e,this._gapBarSpace=this._calcGapBarSpace(),this._offsetRightBarCount=this._offsetRightDistance/this._barSpace}return o.prototype._calcGapBarSpace=function(){return Math.max(1,Math.min(Math.floor(.82*this._barSpace),Math.floor(this._barSpace)-1))},o.prototype.adjustVisibleRange=function(){var e,t=this._chartStore.getDataList(),r=t.length,n=this._totalBarSpace/this._barSpace,s=n-Math.min(this._minVisibleBarCount.left,r);this._offsetRightBarCount>s&&(this._offsetRightBarCount=s);var l=-r+Math.min(this._minVisibleBarCount.right,r);l>this._offsetRightBarCount&&(this._offsetRightBarCount=l);var u=Math.round(this._offsetRightBarCount+r+.5);u>r&&(u=r);var c=Math.round(u-n)-1;if(0>c&&(c=0),this._visibleRange={from:c,to:u,realFrom:this._offsetRightBarCount>0?Math.round(r+this._offsetRightBarCount-n)-1:c,realTo:u},this._chartStore.getActionStore().execute(a.ActionType.OnVisibleRangeChange,this._visibleRange),this._chartStore.adjustVisibleDataList(),c===0&&this._more&&!this._loading&&this._loadMoreCallback!==null){this._loading=!0;var h=t[0];this._loadMoreCallback((e=h==null?void 0:h.timestamp)!==null&&e!==void 0?e:null)}},o.prototype.setMore=function(e){return this._more=e,this},o.prototype.setLoading=function(e){return this._loading=e,this},o.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},o.prototype._buildDateTimeFormat=function(e){var t={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};e!==void 0&&(t.timeZone=e);var r=null;try{r=new Intl.DateTimeFormat("en",t)}catch{}return r},o.prototype.setTimezone=function(e){var t=this._buildDateTimeFormat(e);t!==null&&(this._dateTimeFormat=t)},o.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},o.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:this._gapBarSpace/2}},o.prototype.setBarSpace=function(e,t){Mo>e||e>Do||this._barSpace===e||(this._barSpace=e,this._gapBarSpace=this._calcGapBarSpace(),t==null||t(),this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0))},o.prototype.setTotalBarSpace=function(e){return this._totalBarSpace!==e&&(this._totalBarSpace=e,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0)),this},o.prototype.setOffsetRightDistance=function(e,t){return this._offsetRightDistance=e,this._offsetRightBarCount=e/this._barSpace,t!=null&&t&&(this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)),this},o.prototype.resetOffsetRightDistance=function(){this.setOffsetRightDistance(this._offsetRightDistance)},o.prototype.getInitialOffsetRightDistance=function(){return this._offsetRightDistance},o.prototype.getOffsetRightDistance=function(){return Math.max(0,this._offsetRightBarCount*this._barSpace)},o.prototype.getOffsetRightBarCount=function(){return this._offsetRightBarCount},o.prototype.setOffsetRightBarCount=function(e){return this._offsetRightBarCount=e,this},o.prototype.setLeftMinVisibleBarCount=function(e){return this._minVisibleBarCount.left=e,this},o.prototype.setRightMinVisibleBarCount=function(e){return this._minVisibleBarCount.right=e,this},o.prototype.getVisibleRange=function(){return this._visibleRange},o.prototype.startScroll=function(){this._startScrollOffsetRightBarCount=this._offsetRightBarCount},o.prototype.scroll=function(e){if(this._scrollEnabled){var t=e/this._barSpace;this._chartStore.getActionStore().execute(a.ActionType.OnScroll),this._offsetRightBarCount=this._startScrollOffsetRightBarCount-t,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)}},o.prototype.getDataByDataIndex=function(e){var t;return(t=this._chartStore.getDataList()[e])!==null&&t!==void 0?t:null},o.prototype.coordinateToFloatIndex=function(e){var t=this._chartStore.getDataList().length;return Math.round(1e6*(t+this._offsetRightBarCount-(this._totalBarSpace-e)/this._barSpace))/1e6},o.prototype.dataIndexToTimestamp=function(e){var t,r=this.getDataByDataIndex(e);return(t=r==null?void 0:r.timestamp)!==null&&t!==void 0?t:null},o.prototype.timestampToDataIndex=function(e){var t=this._chartStore.getDataList();return t.length===0?0:Zt(t,"timestamp",e)},o.prototype.dataIndexToCoordinate=function(e){var t=this._chartStore.getDataList().length;return this._totalBarSpace-(t+this._offsetRightBarCount-e-.5)*this._barSpace},o.prototype.coordinateToDataIndex=function(e){return Math.ceil(this.coordinateToFloatIndex(e))-1},o.prototype.zoom=function(e,t){var r,n=this;if(this._zoomEnabled){if((t==null?void 0:t.x)===void 0){var s=this._chartStore.getTooltipStore().getCrosshair();t={x:(r=s==null?void 0:s.x)!==null&&r!==void 0?r:this._totalBarSpace/2}}this._chartStore.getActionStore().execute(a.ActionType.OnZoom);var l=this.coordinateToFloatIndex(t.x);this.setBarSpace(this._barSpace+e*(this._barSpace/10),function(){n._offsetRightBarCount+=l-n.coordinateToFloatIndex(t==null?void 0:t.x)})}},o.prototype.setZoomEnabled=function(e){return this._zoomEnabled=e,this},o.prototype.getZoomEnabled=function(){return this._zoomEnabled},o.prototype.setScrollEnabled=function(e){return this._scrollEnabled=e,this},o.prototype.getScrollEnabled=function(){return this._scrollEnabled},o.prototype.setLoadMoreCallback=function(e){return this._loadMoreCallback=e,this},o.prototype.clear=function(){this._more=!0,this._loading=!0,this._visibleRange={from:0,to:0,realFrom:0,realTo:0}},o}();function Kt(o,e,t,r,n){var s,l=e.result,u=e.figures,c=e.styles,h=te(c,"circles",r.circles),v=h.length,p=te(c,"bars",r.bars),f=p.length,m=te(c,"lines",r.lines),S=m.length,I=0,T=0,E=0;u.forEach(function(P){var M;switch(P.type){case"circle":var A=h[I%v];s=j(j({},A),{color:A.noChangeColor}),I++;break;case"bar":var L=p[T%f];s=j(j({},L),{color:L.noChangeColor}),T++;break;case"line":s=m[E%S],E++}if(q(s)){var R=(M=P.styles)===null||M===void 0?void 0:M.call(P,{prev:{kLineData:o[t-1],indicatorData:l[t-1]},current:{kLineData:o[t],indicatorData:l[t]},next:{kLineData:o[t+1],indicatorData:l[t+1]}},e,r);n(P,j(j({},s),R))}})}a.IndicatorSeries=void 0,($t=a.IndicatorSeries||(a.IndicatorSeries={})).Normal="normal",$t.Price="price",$t.Volume="volume";var un=function(){function o(e){this.result=[],this._precisionFlag=!1;var t=e.name,r=e.shortName,n=e.series,s=e.calcParams,l=e.figures,u=e.precision,c=e.shouldOhlc,h=e.shouldFormatBigNumber,v=e.visible,p=e.minValue,f=e.maxValue,m=e.styles,S=e.extendData,I=e.regenerateFigures,T=e.createTooltipDataSource,E=e.draw;this.name=t,this.shortName=r??t,this.series=n??a.IndicatorSeries.Normal,this.precision=u??4,this.calcParams=s??[],this.figures=l??[],this.shouldOhlc=c!=null&&c,this.shouldFormatBigNumber=h!=null&&h,this.visible=v==null||v,this.minValue=p??null,this.maxValue=f??null,this.styles=z(m??{}),this.extendData=S,this.regenerateFigures=I??null,this.createTooltipDataSource=T??null,this.draw=E??null}return o.prototype.setShortName=function(e){return this.shortName!==e&&(this.shortName=e,!0)},o.prototype.setSeries=function(e){return this.series!==e&&(this.series=e,!0)},o.prototype.setPrecision=function(e,t){var r=t!=null&&t,n=Math.floor(e);return!(n===this.precision||0>e||r&&(!r||this._precisionFlag))&&(this.precision=n,r||(this._precisionFlag=!0),!0)},o.prototype.setCalcParams=function(e){var t,r;return this.calcParams=e,this.figures=(r=(t=this.regenerateFigures)===null||t===void 0?void 0:t.call(this,e))!==null&&r!==void 0?r:this.figures,!0},o.prototype.setShouldOhlc=function(e){return this.shouldOhlc!==e&&(this.shouldOhlc=e,!0)},o.prototype.setShouldFormatBigNumber=function(e){return this.shouldFormatBigNumber!==e&&(this.shouldFormatBigNumber=e,!0)},o.prototype.setVisible=function(e){return this.visible!==e&&(this.visible=e,!0)},o.prototype.setStyles=function(e){return e!==null&&(B(this.styles,e),!0)},o.prototype.setExtendData=function(e){return this.extendData!==e&&(this.extendData=e,!0)},o.prototype.setFigures=function(e){return this.figures!==e&&(this.figures=e,!0)},o.prototype.setMinValue=function(e){return this.minValue!==e&&(this.minValue=e,!0)},o.prototype.setMaxValue=function(e){return this.maxValue!==e&&(this.maxValue=e,!0)},o.prototype.setRegenerateFigures=function(e){return this.regenerateFigures!==e&&(this.regenerateFigures=e,!0)},o.prototype.setCreateTooltipDataSource=function(e){return this.createTooltipDataSource!==e&&(this.createTooltipDataSource=e,!0)},o.prototype.setDraw=function(e){return this.draw!==e&&(this.draw=e,!0)},o.prototype.calcIndicator=function(e){return Xe(this,void 0,void 0,function(){var t;return Ge(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.calc(e,this)];case 1:return t=r.sent(),this.result=t,[2,!0];case 2:return r.sent(),[2,!1];case 3:return[2]}})})},o.extend=function(e){return function(t){function r(){return t.call(this,e)||this}return $(r,t),r.prototype.calc=function(n,s){return e.calc(n,s)},r}(o)},o}(),Ao={name:"AVP",shortName:"AVP",series:a.IndicatorSeries.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(o){var e=0,t=0;return o.map(function(r){var n,s,l={},u=(n=r==null?void 0:r.turnover)!==null&&n!==void 0?n:0,c=(s=r==null?void 0:r.volume)!==null&&s!==void 0?s:0;return e+=u,(t+=c)!==0&&(l.avp=e/t),l})}},Fo={name:"EMA",shortName:"EMA",series:a.IndicatorSeries.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(o){return o.map(function(e,t){return{key:"ema".concat(t+1),title:"EMA".concat(e,": "),type:"line"}})},calc:function(o,e){var t=e.calcParams,r=e.figures,n=0,s=[];return o.map(function(l,u){var c={},h=l.close;return n+=h,t.forEach(function(v,p){v-1>u||(s[p]=u>v-1?(2*h+(v-1)*s[p])/(v+1):n/v,c[r[p].key]=s[p])}),c})}},Lo={name:"MA",shortName:"MA",series:a.IndicatorSeries.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(o){return o.map(function(e,t){return{key:"ma".concat(t+1),title:"MA".concat(e,": "),type:"line"}})},calc:function(o,e){var t=e.calcParams,r=e.figures,n=[];return o.map(function(s,l){var u={},c=s.close;return t.forEach(function(h,v){var p;n[v]=((p=n[v])!==null&&p!==void 0?p:0)+c,h-1>l||(u[r[v].key]=n[v]/h,n[v]-=o[l-(h-1)].close)}),u})}},Bo={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(o){return o.map(function(e,t){var r=t+1;return{key:"rsi".concat(r),title:"RSI".concat(r,": "),type:"line"}})},calc:function(o,e){var t=e.calcParams,r=e.figures,n=[],s=[];return o.map(function(l,u){var c,h={},v=((c=o[u-1])!==null&&c!==void 0?c:l).close,p=l.close-v;return t.forEach(function(f,m){var S,I,T;if(p>0?n[m]=((S=n[m])!==null&&S!==void 0?S:0)+p:s[m]=((I=s[m])!==null&&I!==void 0?I:0)+Math.abs(p),u>=f-1){h[r[m].key]=s[m]!==0?100-100/(1+n[m]/s[m]):0;var E=o[u-(f-1)],P=(T=o[u-f])!==null&&T!==void 0?T:E,M=E.close-P.close;M>0?n[m]-=M:s[m]-=Math.abs(M)}}),h})}},Ro={name:"VOL",shortName:"VOL",series:a.IndicatorSeries.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(o,e,t){var r=o.current.kLineData;return{color:r.close>r.open?te(e.styles,"bars[0].upColor",t.bars[0].upColor):r.open>r.close?te(e.styles,"bars[0].downColor",t.bars[0].downColor):te(e.styles,"bars[0].noChangeColor",t.bars[0].noChangeColor)}}}],regenerateFigures:function(o){var e=o.map(function(t,r){return{key:"ma".concat(r+1),title:"MA".concat(t,": "),type:"line"}});return e.push({key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t,r,n){var s=t.current.kLineData;return{color:s.close>s.open?te(r.styles,"bars[0].upColor",n.bars[0].upColor):s.open>s.close?te(r.styles,"bars[0].downColor",n.bars[0].downColor):te(r.styles,"bars[0].noChangeColor",n.bars[0].noChangeColor)}}}),e},calc:function(o,e){var t=e.calcParams,r=e.figures,n=[];return o.map(function(s,l){var u,c=(u=s.volume)!==null&&u!==void 0?u:0,h={volume:c};return t.forEach(function(v,p){var f,m;n[p]=((f=n[p])!==null&&f!==void 0?f:0)+c,v-1>l||(h[r[p].key]=n[p]/v,n[p]-=(m=o[l-(v-1)].volume)!==null&&m!==void 0?m:0)}),h})}},Oo={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(o){return o.map(function(e,t){return{key:"wr".concat(t+1),title:"WR".concat(t+1,": "),type:"line"}})},calc:function(o,e){var t=e.calcParams,r=e.figures;return o.map(function(n,s){var l={},u=n.close;return t.forEach(function(c,h){var v=c-1;if(s>=v){var p=ln(o.slice(s-v,s+1),"high","low"),f=p[0],m=f-p[1];l[r[h].key]=m===0?0:(u-f)/m*100}}),l})}},Dt={},Vo=[Ao,{name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(o,e,t){var r,n,s,l,u,c=(n=(r=o.prev.indicatorData)===null||r===void 0?void 0:r.ao)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER,h=(l=(s=o.current.indicatorData)===null||s===void 0?void 0:s.ao)!==null&&l!==void 0?l:Number.MIN_SAFE_INTEGER;return{color:u=h>c?te(e.styles,"bars[0].upColor",t.bars[0].upColor):te(e.styles,"bars[0].downColor",t.bars[0].downColor),style:h>c?a.PolygonType.Stroke:a.PolygonType.Fill,borderColor:u}}}],calc:function(o,e){var t=e.calcParams,r=Math.max(t[0],t[1]),n=0,s=0,l=0,u=0;return o.map(function(c,h){var v,p={},f=(c.low+c.high)/2;return n+=f,s+=f,h<t[0]-1||(l=n/t[0],n-=((v=o[h-(t[0]-1)]).low+v.high)/2),h<t[1]-1||(u=s/t[1],s-=((v=o[h-(t[1]-1)]).low+v.high)/2),r-1>h||(p.ao=l-u),p})}},{name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(o){return o.map(function(e,t){return{key:"bias".concat(t+1),title:"BIAS".concat(e,": "),type:"line"}})},calc:function(o,e){var t=e.calcParams,r=e.figures,n=[];return o.map(function(s,l){var u={},c=s.close;return t.forEach(function(h,v){var p;if(n[v]=((p=n[v])!==null&&p!==void 0?p:0)+c,l>=h-1){var f=n[v]/t[v];u[r[v].key]=(c-f)/f*100,n[v]-=o[l-(h-1)].close}}),u})}},{name:"BOLL",shortName:"BOLL",series:a.IndicatorSeries.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=t[0]-1,n=0;return o.map(function(s,l){var u={};if(n+=s.close,l>=r){u.mid=n/t[0];var c=function(h,v){var p=h.length,f=0;return h.forEach(function(m){var S=m.close-v;f+=S*S}),Math.sqrt((f=Math.abs(f))/p)}(o.slice(l-r,l+1),u.mid);u.up=u.mid+t[1]*c,u.dn=u.mid-t[1]*c,n-=o[l-r].close}return u})}},{name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=0,n=0,s=0,l=0;return o.map(function(u,c){var h,v,p={},f=u.high,m=u.low,S=u.open,I=((h=o[c-1])!==null&&h!==void 0?h:u).close;if(s+=f-S,l+=S-m,r+=f-I,n+=I-m,c>=t[0]-1){p.ar=l!==0?s/l*100:0,p.br=n!==0?r/n*100:0;var T=o[c-(t[0]-1)],E=T.high,P=T.low,M=T.open,A=((v=o[c-t[0]])!==null&&v!==void 0?v:o[c-(t[0]-1)]).close;r-=E-A,n-=A-P,s-=E-M,l-=M-P}return p})}},{name:"BBI",shortName:"BBI",series:a.IndicatorSeries.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=Math.max.apply(Math,nn([],ge(t),!1)),n=[],s=[];return o.map(function(l,u){var c={},h=l.close;if(t.forEach(function(p,f){var m;n[f]=((m=n[f])!==null&&m!==void 0?m:0)+h,p-1>u||(s[f]=n[f]/p,n[f]-=o[u-(p-1)].close)}),u>=r-1){var v=0;s.forEach(function(p){v+=p}),c.bbi=v/4}return c})}},{name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=t[0]-1,n=0,s=[];return o.map(function(l,u){var c={},h=(l.high+l.low+l.close)/3;if(n+=h,s.push(h),u>=r){var v=n/t[0],p=s.slice(u-r,u+1),f=0;p.forEach(function(S){f+=Math.abs(S-v)});var m=f/t[0];c.cci=m!==0?(h-v)/m/.015:0,n-=(o[u-r].high+o[u-r].low+o[u-r].close)/3}return c})}},{name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=Math.ceil(t[1]/2.5+1),n=Math.ceil(t[2]/2.5+1),s=Math.ceil(t[3]/2.5+1),l=Math.ceil(t[4]/2.5+1),u=0,c=[],h=0,v=[],p=0,f=[],m=0,S=[],I=[];return o.forEach(function(T,E){var P,M,A,L,R,O={},V=(P=o[E-1])!==null&&P!==void 0?P:T,N=(V.high+V.close+V.low+V.open)/4,Y=Math.max(0,T.high-N),W=Math.max(0,N-T.low);t[0]-1>E||(O.cr=W!==0?Y/W*100:0,u+=O.cr,h+=O.cr,p+=O.cr,m+=O.cr,t[0]+t[1]-2>E||(c.push(u/t[1]),t[0]+t[1]+r-3>E||(O.ma1=c[c.length-1-r]),u-=(M=I[E-(t[1]-1)].cr)!==null&&M!==void 0?M:0),t[0]+t[2]-2>E||(v.push(h/t[2]),t[0]+t[2]+n-3>E||(O.ma2=v[v.length-1-n]),h-=(A=I[E-(t[2]-1)].cr)!==null&&A!==void 0?A:0),t[0]+t[3]-2>E||(f.push(p/t[3]),t[0]+t[3]+s-3>E||(O.ma3=f[f.length-1-s]),p-=(L=I[E-(t[3]-1)].cr)!==null&&L!==void 0?L:0),t[0]+t[4]-2>E||(S.push(m/t[4]),t[0]+t[4]+l-3>E||(O.ma4=S[S.length-1-l]),m-=(R=I[E-(t[4]-1)].cr)!==null&&R!==void 0?R:0)),I.push(O)}),I}},{name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=Math.max(t[0],t[1]),n=0,s=0,l=0,u=[];return o.forEach(function(c,h){var v,p={},f=c.close;n+=f,s+=f;var m=0,S=0;if(t[0]-1>h||(m=n/t[0],n-=o[h-(t[0]-1)].close),t[1]-1>h||(S=s/t[1],s-=o[h-(t[1]-1)].close),h>=r-1){var I=m-S;p.dma=I,l+=I,r+t[2]-2>h||(p.ama=l/t[2],l-=(v=u[h-(t[2]-1)].dma)!==null&&v!==void 0?v:0)}u.push(p)}),u}},{name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=0,n=0,s=0,l=0,u=0,c=0,h=0,v=0,p=[];return o.forEach(function(f,m){var S,I,T={},E=(S=o[m-1])!==null&&S!==void 0?S:f,P=E.close,M=f.high,A=f.low,L=M-A,R=Math.abs(M-P),O=Math.abs(P-A),V=M-E.high,N=E.low-A,Y=Math.max(Math.max(L,R),O),W=V>0&&V>N?V:0,G=N>0&&N>V?N:0;if(r+=Y,n+=W,s+=G,m>=t[0]-1){m>t[0]-1?(l=l-l/t[0]+Y,u=u-u/t[0]+W,c=c-c/t[0]+G):(l=r,u=n,c=s);var X=0,K=0;l!==0&&(X=100*u/l,K=100*c/l),T.pdi=X,T.mdi=K;var J=0;K+X!==0&&(J=Math.abs(K-X)/(K+X)*100),h+=J,2*t[0]-2>m||(T.adx=v=m>2*t[0]-2?(v*(t[0]-1)+J)/t[0]:h/t[0],2*t[0]+t[1]-3>m||(T.adxr=(((I=p[m-(t[1]-1)].adx)!==null&&I!==void 0?I:0)+v)/2))}p.push(T)}),p}},{name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=0,n=[];return o.map(function(s,l){var u,c={};if(l>0){var h=o[l-1],v=s.high,p=s.low,f=(u=s.volume)!==null&&u!==void 0?u:0,m=(v+p)/2-(h.high+h.low)/2;f===0||v-p==0?c.emv=0:c.emv=m/(f/1e8/(v-p)),r+=c.emv,n.push(c.emv),t[0]>l||(c.maEmv=r/t[0],r-=n[l-t[0]])}return c})}},Fo,{name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=0,n=[];return o.forEach(function(s,l){var u,c={};l<t[0]||(c.mtm=s.close-o[l-t[0]].close,r+=c.mtm,t[0]+t[1]-1>l||(c.maMtm=r/t[1],r-=(u=n[l-(t[1]-1)].mtm)!==null&&u!==void 0?u:0)),n.push(c)}),n}},Lo,{name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(o,e,t){var r,n,s,l,u,c=(n=(r=o.prev.indicatorData)===null||r===void 0?void 0:r.macd)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER,h=(l=(s=o.current.indicatorData)===null||s===void 0?void 0:s.macd)!==null&&l!==void 0?l:Number.MIN_SAFE_INTEGER;return u=h>0?te(e.styles,"bars[0].upColor",t.bars[0].upColor):0>h?te(e.styles,"bars[0].downColor",t.bars[0].downColor):te(e.styles,"bars[0].noChangeColor",t.bars[0].noChangeColor),{style:h>c?a.PolygonType.Stroke:a.PolygonType.Fill,color:u,borderColor:u}}}],calc:function(o,e){var t,r,n=e.calcParams,s=0,l=0,u=0,c=0,h=Math.max(n[0],n[1]);return o.map(function(v,p){var f={},m=v.close;return s+=m,n[0]-1>p||(t=p>n[0]-1?(2*m+(n[0]-1)*t)/(n[0]+1):s/n[0]),n[1]-1>p||(r=p>n[1]-1?(2*m+(n[1]-1)*r)/(n[1]+1):s/n[1]),h-1>p||(f.dif=l=t-r,u+=l,h+n[2]-2>p||(f.macd=2*(l-(c=p>h+n[2]-2?(2*l+c*(n[2]-1))/(n[2]+1):u/n[2])),f.dea=c)),f})}},{name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=0,n=0,s=[];return o.forEach(function(l,u){var c,h,v,p,f=(c=o[u-1])!==null&&c!==void 0?c:l;f.close>l.close?n-=(h=l.volume)!==null&&h!==void 0?h:0:l.close>f.close&&(n+=(v=l.volume)!==null&&v!==void 0?v:0);var m={obv:n};r+=n,t[0]-1>u||(m.maObv=r/t[0],r-=(p=s[u-(t[0]-1)].obv)!==null&&p!==void 0?p:0),s.push(m)}),s}},{name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(o){var e=0;return o.map(function(t,r){var n,s,l={},u=(n=t.volume)!==null&&n!==void 0?n:1,c=((s=o[r-1])!==null&&s!==void 0?s:t).close,h=0,v=c*u;return v!==0&&(h=(t.close-c)/v),l.pvt=e+=h,l})}},{name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=0,n=0,s=[],l=[];return o.forEach(function(u,c){var h,v,p={},f=((h=o[c-1])!==null&&h!==void 0?h:u).close,m=u.close-f>0?1:0;s.push(m),r+=m,t[0]-1>c||(p.psy=r/t[0]*100,n+=p.psy,t[0]+t[1]-2>c||(p.maPsy=n/t[1],n-=(v=l[c-(t[1]-1)].psy)!==null&&v!==void 0?v:0),r-=s[c-(t[0]-1)]),l.push(p)}),l}},{name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=[],n=0;return o.forEach(function(s,l){var u,c,h={};if(l>=t[0]-1){var v=((u=o[l-t[0]])!==null&&u!==void 0?u:o[l-(t[0]-1)]).close;h.roc=v!==0?(s.close-v)/v*100:0,n+=h.roc,t[0]-1+t[1]-1>l||(h.maRoc=n/t[1],n-=(c=r[l-(t[1]-1)].roc)!==null&&c!==void 0?c:0)}r.push(h)}),r}},Bo,{name:"SMA",shortName:"SMA",series:a.IndicatorSeries.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(o,e){var t=e.calcParams,r=0,n=0;return o.map(function(s,l){var u={},c=s.close;return r+=c,t[0]-1>l||(u.sma=n=l>t[0]-1?(c*t[1]+n*(t[0]-t[1]+1))/(t[0]+1):r/t[0]),u})}},{name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=[];return o.forEach(function(n,s){var l,u,c,h,v={},p=n.close;if(s>=t[0]-1){var f=ln(o.slice(s-(t[0]-1),s+1),"high","low"),m=f[1],S=f[0]-m;v.k=((t[1]-1)*((u=(l=r[s-1])===null||l===void 0?void 0:l.k)!==null&&u!==void 0?u:50)+(p-m)/(S===0?1:S)*100)/t[1],v.d=((t[2]-1)*((h=(c=r[s-1])===null||c===void 0?void 0:c.d)!==null&&h!==void 0?h:50)+v.k)/t[2],v.j=3*v.k-2*v.d}r.push(v)}),r}},{name:"SAR",shortName:"SAR",series:a.IndicatorSeries.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(o,e,t){var r,n,s=o.current,l=(n=(r=s.indicatorData)===null||r===void 0?void 0:r.sar)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER,u=s.kLineData;return{color:((u==null?void 0:u.high)+(u==null?void 0:u.low))/2>l?te(e.styles,"circles[0].upColor",t.circles[0].upColor):te(e.styles,"circles[0].downColor",t.circles[0].downColor)}}}],calc:function(o,e){var t=e.calcParams,r=t[0]/100,n=t[1]/100,s=t[2]/100,l=r,u=-100,c=!1,h=0;return o.map(function(v,p){var f=h,m=v.high,S=v.low;if(c){(u===-100||m>u)&&(u=m,l=Math.min(l+n,s)),h=f+l*(u-f);var I=Math.min(o[Math.max(1,p)-1].low,S);h>v.low?(h=u,l=r,u=-100,c=!c):h>I&&(h=I)}else{(u===-100||u>S)&&(u=S,l=Math.min(l+n,s)),h=f+l*(u-f);var T=Math.max(o[Math.max(1,p)-1].high,m);v.high>h?(h=u,l=0,u=-100,c=!c):T>h&&(h=T)}return{sar:h}})}},{name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(o,e){var t,r,n,s=e.calcParams,l=0,u=0,c=0,h=0,v=[];return o.forEach(function(p,f){var m,S={},I=p.close;if(l+=I,f>=s[0]-1&&(u+=t=f>s[0]-1?(2*I+(s[0]-1)*t)/(s[0]+1):l/s[0],f>=2*s[0]-2&&(c+=r=f>2*s[0]-2?(2*t+(s[0]-1)*r)/(s[0]+1):u/s[0],f>=3*s[0]-3))){var T=void 0,E=0;f>3*s[0]-3?E=((T=(2*r+(s[0]-1)*n)/(s[0]+1))-n)/n*100:T=c/s[0],n=T,S.trix=E,h+=E,3*s[0]+s[1]-4>f||(S.maTrix=h/s[1],h-=(m=v[f-(s[1]-1)].trix)!==null&&m!==void 0?m:0)}v.push(S)}),v}},Ro,{name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(o,e){var t=e.calcParams,r=0,n=0,s=0,l=0,u=[];return o.forEach(function(c,h){var v,p,f,m,S,I={},T=c.close,E=((v=o[h-1])!==null&&v!==void 0?v:c).close,P=(p=c.volume)!==null&&p!==void 0?p:0;if(T>E?r+=P:E>T?n+=P:s+=P,h>=t[0]-1){var M=s/2;I.vr=n+M===0?0:(r+M)/(n+M)*100,l+=I.vr,t[0]+t[1]-2>h||(I.maVr=l/t[1],l-=(f=u[h-(t[1]-1)].vr)!==null&&f!==void 0?f:0);var A=o[h-(t[0]-1)],L=(m=o[h-t[0]])!==null&&m!==void 0?m:A,R=A.close,O=(S=A.volume)!==null&&S!==void 0?S:0;R>L.close?r-=O:L.close>R?n-=O:s-=O}u.push(I)}),u}},Oo];function cn(o){var e;return(e=Dt[o])!==null&&e!==void 0?e:null}Vo.forEach(function(o){Dt[o.name]=un.extend(o)});var Jt,zo=function(){function o(e){this._instances=new Map,this._chartStore=e}return o.prototype._overrideInstance=function(e,t){var r=t.shortName,n=t.series,s=t.calcParams,l=t.precision,u=t.figures,c=t.minValue,h=t.maxValue,v=t.shouldOhlc,p=t.shouldFormatBigNumber,f=t.visible,m=t.styles,S=t.extendData,I=t.regenerateFigures,T=t.createTooltipDataSource,E=t.draw,P=t.calc,M=!1;r!==void 0&&e.setShortName(r)&&(M=!0),n!==void 0&&e.setSeries(n)&&(M=!0);var A=!1;return s!==void 0&&e.setCalcParams(s)&&(M=!0,A=!0),u!==void 0&&e.setFigures(u)&&(M=!0,A=!0),c!==void 0&&e.setMinValue(c)&&(M=!0),h!==void 0&&e.setMinValue(h)&&(M=!0),l!==void 0&&e.setPrecision(l)&&(M=!0),v!==void 0&&e.setShouldOhlc(v)&&(M=!0),p!==void 0&&e.setShouldFormatBigNumber(p)&&(M=!0),f!==void 0&&e.setVisible(f)&&(M=!0),m!==void 0&&e.setStyles(m)&&(M=!0),S!==void 0&&e.setExtendData(S)&&(M=!0,A=!0),I!==void 0&&e.setRegenerateFigures(I)&&(M=!0),T!==void 0&&e.setCreateTooltipDataSource(T)&&(M=!0),E!==void 0&&e.setDraw(E)&&(M=!0),P!==void 0&&(e.calc=P,A=!0),[M,A]},o.prototype.addInstance=function(e,t,r){var n;return Xe(this,void 0,void 0,function(){var s,l,u,c;return Ge(this,function(h){switch(h.label){case 0:return s=e.name,l=this._instances.get(t),(n=l==null?void 0:l.has(s))!==null&&n!==void 0&&n?[4,Promise.reject(Error("Duplicate indicators."))]:[3,2];case 1:case 3:return[2,h.sent()];case 2:return l===void 0&&(l=new Map,this._instances.set(t,l)),u=cn(s),c=new u,this._overrideInstance(c,e),r||l.clear(),l.set(s,c),[4,c.calcIndicator(this._chartStore.getDataList())]}})})},o.prototype.getInstances=function(e){var t;return(t=this._instances.get(e))!==null&&t!==void 0?t:new Map},o.prototype.removeInstance=function(e,t){var r=!1,n=this._instances.get(e);return n!==void 0&&(t!==void 0?n.has(t)&&(n.delete(t),r=!0):(n.clear(),r=!0),n.size===0&&this._instances.delete(e)),r},o.prototype.hasInstances=function(e){return this._instances.has(e)},o.prototype.calcInstance=function(e,t){var r;return Xe(this,void 0,void 0,function(){var n,s,l,u=this;return Ge(this,function(c){switch(c.label){case 0:return n=[],e!==void 0?t!==void 0?(s=this._instances.get(t),(r=s==null?void 0:s.has(e))!==null&&r!==void 0&&r&&(l=s==null?void 0:s.get(e),n.push(l.calcIndicator(this._chartStore.getDataList())))):this._instances.forEach(function(h){if(h.has(e)){var v=h==null?void 0:h.get(e);n.push(v.calcIndicator(u._chartStore.getDataList()))}}):this._instances.forEach(function(h){h.forEach(function(v){n.push(v.calcIndicator(u._chartStore.getDataList()))})}),[4,Promise.all(n)];case 1:return[2,c.sent().includes(!0)]}})})},o.prototype.getInstanceByPaneId=function(e,t){var r;if(e!==void 0){var n=this._instances.get(e);return t!==void 0?(r=n==null?void 0:n.get(t))!==null&&r!==void 0?r:null:n??null}return this._instances},o.prototype.setSeriesPrecision=function(e){this._instances.forEach(function(t){t.forEach(function(r){r.series===a.IndicatorSeries.Price&&r.setPrecision(e.price,!0),r.series===a.IndicatorSeries.Volume&&r.setPrecision(e.volume,!0)})})},o.prototype.override=function(e,t){return Xe(this,void 0,void 0,function(){var r,n,s,l,u,c,h=this;return Ge(this,function(v){switch(v.label){case 0:return r=e.name,n=new Map,t!==null?(s=this._instances.get(t))!==void 0&&n.set(t,s):n=this._instances,l=!1,u=[],n.forEach(function(p){var f=p.get(r);if(f!==void 0){var m=h._overrideInstance(f,e);m[1]?u.push(f.calcIndicator(h._chartStore.getDataList())):m[0]&&(l=!0)}}),[4,Promise.all(u)];case 1:return c=v.sent(),[2,[l,c.includes(!0)]]}})})},o}(),No=function(){function o(e){this._crosshair={},this._activeIcon=null,this._chartStore=e}return o.prototype.setCrosshair=function(e,t){var r,n,s=this._chartStore.getDataList(),l=e??{},u=s[n=l.x!==void 0?0>(r=this._chartStore.getTimeScaleStore().coordinateToDataIndex(l.x))?0:r>s.length-1?s.length-1:r:r=s.length-1],c=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(r),h=this._crosshair.x,v=this._crosshair.y,p=this._crosshair.paneId;this._crosshair=j(j({},l),{realX:c,kLineData:u,realDataIndex:r,dataIndex:n}),h===l.x&&v===l.y&&p===l.paneId||(u!==null&&this._chartStore.getChart().crosshairChange(this._crosshair),t!=null&&t||this._chartStore.getChart().updatePane(1))},o.prototype.recalculateCrosshair=function(e){this.setCrosshair(this._crosshair,e)},o.prototype.getCrosshair=function(){return this._crosshair},o.prototype.setActiveIcon=function(e){this._activeIcon=e??null},o.prototype.getActiveIcon=function(){return this._activeIcon},o.prototype.clear=function(){this.setCrosshair({},!0),this.setActiveIcon()},o}();a.OverlayMode=void 0,(Jt=a.OverlayMode||(a.OverlayMode={})).Normal="normal",Jt.WeakMagnet="weak_magnet",Jt.StrongMagnet="strong_magnet";var it="overlay_figure_",Ho=Number.MAX_SAFE_INTEGER,hn=function(){function o(e){this.currentStep=1,this.points=[],this._prevPressedPoint=null,this._prevPressedPoints=[];var t=e.mode,r=e.modeSensitivity,n=e.extendData,s=e.styles,l=e.totalStep,u=e.lock,c=e.visible,h=e.zLevel,v=e.needDefaultPointFigure,p=e.needDefaultXAxisFigure,f=e.needDefaultYAxisFigure,m=e.createPointFigures,S=e.createXAxisFigures,I=e.createYAxisFigures,T=e.performEventPressedMove,E=e.performEventMoveForDrawing,P=e.onDrawStart,M=e.onDrawing,A=e.onDrawEnd,L=e.onClick,R=e.onDoubleClick,O=e.onRightClick,V=e.onPressedMoveStart,N=e.onPressedMoving,Y=e.onPressedMoveEnd,W=e.onMouseEnter,G=e.onMouseLeave,X=e.onRemoved,K=e.onSelected,J=e.onDeselected;this.name=e.name,this.totalStep=!se(l)||2>l?1:l,this.lock=u!=null&&u,this.visible=c==null||c,this.zLevel=h??0,this.needDefaultPointFigure=v!=null&&v,this.needDefaultXAxisFigure=p!=null&&p,this.needDefaultYAxisFigure=f!=null&&f,this.mode=t??a.OverlayMode.Normal,this.modeSensitivity=r??8,this.extendData=n,this.styles=z(s??{}),this.createPointFigures=m??null,this.createXAxisFigures=S??null,this.createYAxisFigures=I??null,this.performEventPressedMove=T??null,this.performEventMoveForDrawing=E??null,this.onDrawStart=P??null,this.onDrawing=M??null,this.onDrawEnd=A??null,this.onClick=L??null,this.onDoubleClick=R??null,this.onRightClick=O??null,this.onPressedMoveStart=V??null,this.onPressedMoving=N??null,this.onPressedMoveEnd=Y??null,this.onMouseEnter=W??null,this.onMouseLeave=G??null,this.onRemoved=X??null,this.onSelected=K??null,this.onDeselected=J??null}return o.prototype.setId=function(e){return this.id===void 0&&(this.id=e,!0)},o.prototype.setGroupId=function(e){return this.groupId===void 0&&(this.groupId=e,!0)},o.prototype.setDefaultZLevel=function(e){return this.defaultZLevel===void 0&&(this.defaultZLevel=e,!0)},o.prototype.setPaneId=function(e){this.paneId=e},o.prototype.setExtendData=function(e){return e!==this.extendData&&(this.extendData=e,!0)},o.prototype.setStyles=function(e){return e!==null&&(B(this.styles,e),!0)},o.prototype.setPoints=function(e){if(e.length>0){var t=void 0;if(this.points=nn([],ge(e),!1),this.totalStep-1>e.length?(this.currentStep=e.length+1,t=e.length):(this.currentStep=-1,t=this.totalStep-1),this.performEventMoveForDrawing!==null)for(var r=0;t>r;r++)this.performEventMoveForDrawing({currentStep:r+2,mode:this.mode,points:this.points,performPointIndex:r,performPoint:this.points[r]});return this.currentStep===-1&&this.performEventPressedMove!==null&&this.performEventPressedMove({currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}),!0}return!1},o.prototype.setLock=function(e){return this.lock!==e&&(this.lock=e,!0)},o.prototype.setVisible=function(e){return this.visible!==e&&(this.visible=e,!0)},o.prototype.resetZLevel=function(){this.zLevel=this.defaultZLevel},o.prototype.setZLevel=function(e){return this.zLevel!==e&&(this.zLevel=e,!0)},o.prototype.setMode=function(e){return this.mode!==e&&(this.mode=e,!0)},o.prototype.setModeSensitivity=function(e){return this.modeSensitivity!==e&&(this.modeSensitivity=e,!0)},o.prototype.setOnDrawStartCallback=function(e){return this.onDrawStart!==e&&(this.onDrawStart=e,!0)},o.prototype.setOnDrawingCallback=function(e){return this.onDrawing!==e&&(this.onDrawing=e,!0)},o.prototype.setOnDrawEndCallback=function(e){return this.onDrawEnd!==e&&(this.onDrawEnd=e,!0)},o.prototype.setOnClickCallback=function(e){return this.onClick!==e&&(this.onClick=e,!0)},o.prototype.setOnDoubleClickCallback=function(e){return this.onDoubleClick!==e&&(this.onDoubleClick=e,!0)},o.prototype.setOnRightClickCallback=function(e){return this.onRightClick!==e&&(this.onRightClick=e,!0)},o.prototype.setOnPressedMoveStartCallback=function(e){return this.onPressedMoveStart!==e&&(this.onPressedMoveStart=e,!0)},o.prototype.setOnPressedMovingCallback=function(e){return this.onPressedMoving!==e&&(this.onPressedMoving=e,!0)},o.prototype.setOnPressedMoveEndCallback=function(e){return this.onPressedMoveEnd!==e&&(this.onPressedMoveEnd=e,!0)},o.prototype.setOnMouseEnterCallback=function(e){return this.onMouseEnter!==e&&(this.onMouseEnter=e,!0)},o.prototype.setOnMouseLeaveCallback=function(e){return this.onMouseLeave!==e&&(this.onMouseLeave=e,!0)},o.prototype.setOnRemovedCallback=function(e){return this.onRemoved!==e&&(this.onRemoved=e,!0)},o.prototype.setOnSelectedCallback=function(e){return this.onSelected!==e&&(this.onSelected=e,!0)},o.prototype.setOnDeselectedCallback=function(e){return this.onDeselected!==e&&(this.onDeselected=e,!0)},o.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=-1:this.currentStep++},o.prototype.forceComplete=function(){this.currentStep=-1},o.prototype.isDrawing=function(){return this.currentStep!==-1},o.prototype.isStart=function(){return this.currentStep===1},o.prototype.eventMoveForDrawing=function(e){var t,r=this.currentStep-1,n={};e.timestamp!==void 0&&(n.timestamp=e.timestamp),e.dataIndex!==void 0&&(n.dataIndex=e.dataIndex),e.value!==void 0&&(n.value=e.value),this.points[r]=n,(t=this.performEventMoveForDrawing)===null||t===void 0||t.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:r,performPoint:n})},o.prototype.eventPressedPointMove=function(e,t){var r;e.dataIndex!==void 0&&(this.points[t].dataIndex=e.dataIndex,this.points[t].timestamp=e.timestamp),e.value!==void 0&&(this.points[t].value=e.value),(r=this.performEventPressedMove)===null||r===void 0||r.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:t,performPoint:this.points[t]})},o.prototype.startPressedMove=function(e){this._prevPressedPoint=j({},e),this._prevPressedPoints=z(this.points)},o.prototype.eventPressedOtherMove=function(e,t){var r,n;this._prevPressedPoint!==null&&(e.dataIndex!==void 0&&this._prevPressedPoint.dataIndex!==void 0&&(r=e.dataIndex-this._prevPressedPoint.dataIndex),e.value!==void 0&&this._prevPressedPoint.value!==void 0&&(n=e.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map(function(s){var l;s.dataIndex===void 0&&s.timestamp!==void 0&&(s.dataIndex=t.timestampToDataIndex(s.timestamp));var u=j({},s);return r!==void 0&&s.dataIndex!==void 0&&(u.dataIndex=s.dataIndex+r,u.timestamp=(l=t.dataIndexToTimestamp(u.dataIndex))!==null&&l!==void 0?l:void 0),n!==void 0&&s.value!==void 0&&(u.value=s.value+n),u}))},o.extend=function(e){return function(t){function r(){return t.call(this,e)||this}return $(r,t),r}(o)},o}(),Wo={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){var e=o.coordinates,t=o.precision,r=o.thousandsSeparator,n=o.overlay.points;if(e.length>0){var s=[],l=[],u=o.bounding.width;if(e.length>1&&n[0].value!==void 0&&n[1].value!==void 0){var c=e[0].y-e[1].y,h=n[0].value-n[1].value;[1,.786,.618,.5,.382,.236,0].forEach(function(v){var p,f=e[1].y+c*v,m=ue((((p=n[1].value)!==null&&p!==void 0?p:0)+h*v).toFixed(t.price),r);s.push({coordinates:[{x:0,y:f},{x:u,y:f}]}),l.push({x:0,y:f,text:"".concat(m," (").concat((100*v).toFixed(1),"%)"),baseline:"bottom"})})}return[{type:"line",attrs:s},{type:"text",isCheckEvent:!1,attrs:l}]}return[]}},Yo={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){var e=o.coordinates,t={x:0,y:e[0].y};return e[1]!==void 0&&e[1].x>e[0].x&&(t.x=o.bounding.width),[{type:"line",attrs:{coordinates:[e[0],t]}}]},performEventPressedMove:function(o){var e=o.points,t=o.performPoint;e[0].value=t.value,e[1].value=t.value},performEventMoveForDrawing:function(o){o.currentStep===2&&(o.points[0].value=o.performPoint.value)}},Qt=function(){function o(){this._children=[],this._callbacks=new Map}return o.prototype.registerEvent=function(e,t){return this._callbacks.set(e,t),this},o.prototype.onEvent=function(e,t,r){var n=this._callbacks.get(e);return!(n===void 0||!this.checkEventOn(t))&&n(t,r)},o.prototype.checkEventOn=function(e){var t,r;try{for(var n=Fe(this._children),s=n.next();!s.done;s=n.next())if(s.value.checkEventOn(e))return!0}catch(l){t={error:l}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!1},o.prototype.dispatchEvent=function(e,t,r){var n=this._children.length-1;if(n>-1){for(var s=n;s>-1;s--)if(this._children[s].dispatchEvent(e,t,r))return!0}return this.onEvent(e,t,r)},o.prototype.addChild=function(e){return this._children.push(e),this},o.prototype.clear=function(){this._children=[]},o}(),dn=function(o){function e(t){var r=o.call(this)||this;return r.attrs=t.attrs,r.styles=t.styles,r}return $(e,o),e.prototype.checkEventOn=function(t){return this.checkEventOnImp(t,this.attrs,this.styles)},e.prototype.draw=function(t){this.drawImp(t,this.attrs,this.styles)},e.extend=function(t){var r=function(n){function s(){return n!==null&&n.apply(this,arguments)||this}return $(s,n),s.prototype.checkEventOnImp=function(l,u,c){return t.checkEventOn(l,u,c)},s.prototype.drawImp=function(l,u,c){t.draw(l,u,c)},s}(e);return r},e}(Qt);function vn(o,e){return Math.sqrt(Math.pow(o.x+e.x,2)+Math.pow(o.y+e.y,2))}function qo(o){var e=vn(o[0],o[1]),t=e+vn(o[1],o[2]),r=[o[2].x-o[0].x,o[2].y-o[0].y];return[{x:o[1].x-.5*r[0]*e/t,y:o[1].y-.5*r[1]*e/t},{x:o[1].x+.5*r[0]*e/t,y:o[1].y+.5*r[1]*e/t}]}function pn(o,e){var t=e.coordinates;if(t.length>1)for(var r=1;t.length>r;r++){var n=t[r-1],s=t[r];if(n.x===s.x){if(4>Math.abs(n.y-o.y)+Math.abs(s.y-o.y)-Math.abs(n.y-s.y)&&2>Math.abs(o.x-n.x))return!0}else{var l=kt(n,s),u=er(l,o),c=Math.abs(u-o.y);if(4>Math.abs(n.x-o.x)+Math.abs(s.x-o.x)-Math.abs(n.x-s.x)&&4>c*c/(l[0]*l[0]+1))return!0}}return!1}function er(o,e){return o!=null?e.x*o[0]+o[1]:e.y}function ft(o,e,t){return er(kt(o,e),t)}function kt(o,e){var t=o.x-e.x;if(t!==0){var r=(o.y-e.y)/t;return[r,o.y-r*o.x]}return null}function gn(o,e,t){var r=e.coordinates,n=r.length;if(n>1){var s=t.style,l=s===void 0?a.LineType.Solid:s,u=t.smooth,c=t.size,h=t.color,v=h===void 0?"currentColor":h,p=t.dashedValue,f=p===void 0?[2,2]:p;if(o.lineWidth=c===void 0?1:c,o.strokeStyle=v,o.setLineDash(l===a.LineType.Dashed?f:[]),o.beginPath(),o.moveTo(r[0].x,r[0].y),u!=null&&u){for(var m=[],S=1;n-1>S;S++)m=m.concat(qo([r[S-1],r[S],r[S+1]]));o.quadraticCurveTo(m[0].x,m[0].y,r[1].x,r[1].y);for(var I=2;n-1>I;I++)o.bezierCurveTo(m[2*(I-2)+1].x,m[2*(I-2)+1].y,m[2*(I-1)].x,m[2*(I-1)].y,r[I].x,r[I].y);o.quadraticCurveTo(m[2*(I-2)+1].x,m[2*(I-2)+1].y,r[I].x,r[I].y)}else for(I=1;r.length>I;I++)o.lineTo(r[I].x,r[I].y);o.stroke(),o.closePath()}}var jo={name:"line",checkEventOn:pn,draw:function(o,e,t){gn(o,e,t)}};function fn(o,e,t){var r=t??0,n=[];if(o.length>1)if(o[0].x===o[1].x){var s=e.height;if(n.push({coordinates:[{x:o[0].x,y:0},{x:o[0].x,y:s}]}),o.length>2){n.push({coordinates:[{x:o[2].x,y:0},{x:o[2].x,y:s}]});for(var l=o[0].x-o[2].x,u=0;r>u;u++){var c=l*(u+1);n.push({coordinates:[{x:o[0].x+c,y:0},{x:o[0].x+c,y:s}]})}}}else{var h=e.width,v=kt(o[0],o[1]),p=v[0],f=v[1];if(n.push({coordinates:[{x:0,y:0*p+f},{x:h,y:h*p+f}]}),o.length>2){var m=o[2].y-p*o[2].x;for(n.push({coordinates:[{x:0,y:0*p+m},{x:h,y:h*p+m}]}),l=f-m,u=0;r>u;u++){var S=f+l*(u+1);n.push({coordinates:[{x:0,y:0*p+S},{x:h,y:h*p+S}]})}}}return n}function Xo(o,e){if(o.length>1){var t=void 0;return t=o[0].x===o[1].x&&o[0].y!==o[1].y?o[1].y>o[0].y?{x:o[0].x,y:e.height}:{x:o[0].x,y:0}:o[0].x>o[1].x?{x:0,y:ft(o[0],o[1],{x:0,y:o[0].y})}:{x:e.width,y:ft(o[0],o[1],{x:e.width,y:o[0].y})},{coordinates:[o[0],t]}}return[]}var Go={name:"simpleAnnotation",totalStep:2,styles:{line:{style:a.LineType.Dashed}},createPointFigures:function(o){var e,t,r=o.overlay,n=o.coordinates;q(r.extendData)&&(t=U(r.extendData)?r.extendData(r):(e=r.extendData)!==null&&e!==void 0?e:"");var s=n[0].x,l=n[0].y-6,u=l-50,c=u-5;return[{type:"line",attrs:{coordinates:[{x:s,y:l},{x:s,y:u}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:s,y:u},{x:s-4,y:c},{x:s+4,y:c}]},ignoreEvent:!0},{type:"text",attrs:{x:s,y:c,text:t??"",align:"center",baseline:"bottom"},ignoreEvent:!0}]}},Uo={name:"simpleTag",totalStep:2,styles:{line:{style:a.LineType.Dashed}},createPointFigures:function(o){var e=o.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:o.bounding.width,y:e[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(o){var e,t,r,n,s,l=o.overlay,u=o.coordinates,c=o.bounding,h=o.yAxis,v=o.precision;return(e=h==null?void 0:h.isFromZero())!==null&&e!==void 0&&e?(r="left",n=0):(r="right",n=c.width),q(l.extendData)&&(s=U(l.extendData)?l.extendData(l):(t=l.extendData)!==null&&t!==void 0?t:""),q(s)||l.points[0].value===void 0||(s=ne(l.points[0].value,v.price)),{type:"text",attrs:{x:n,y:u[0].y,text:s??"",align:r,baseline:"middle"}}}},mt={};function Zo(o){var e;return(e=mt[o])!==null&&e!==void 0?e:null}[Wo,Yo,{name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){var e=o.coordinates,t=[];return e.length===2&&t.push({coordinates:e}),[{type:"line",attrs:t}]},performEventPressedMove:function(o){var e=o.points,t=o.performPoint;e[0].value=t.value,e[1].value=t.value},performEventMoveForDrawing:function(o){o.currentStep===2&&(o.points[0].value=o.performPoint.value)}},{name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){var e=o.coordinates;return[{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:o.bounding.width,y:e[0].y}]}}]}},{name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){return[{type:"line",attrs:fn(o.coordinates,o.bounding)}]}},{name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){return[{type:"line",attrs:fn(o.coordinates,o.bounding,1)}]}},{name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){var e=o.coordinates,t=o.thousandsSeparator,r=o.overlay.points[0].value;return[{type:"line",attrs:{coordinates:[e[0],{x:o.bounding.width,y:e[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:e[0].x,y:e[0].y,text:ue((r===void 0?0:r).toFixed(o.precision.price),t),baseline:"bottom"}}]}},{name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){return[{type:"line",attrs:Xo(o.coordinates,o.bounding)}]}},{name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){var e=o.coordinates;return e.length===2?[{type:"line",attrs:{coordinates:e}}]:[]}},{name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){var e=o.coordinates,t=o.bounding;return e.length===2?e[0].x===e[1].x?[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:t.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:ft(e[0],e[1],{x:0,y:e[0].y})},{x:t.width,y:ft(e[0],e[1],{x:t.width,y:e[0].y})}]}}]:[]}},{name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){var e=o.coordinates;if(e.length===2){var t={x:e[0].x,y:0};return e[1].y>e[0].y&&(t.y=o.bounding.height),[{type:"line",attrs:{coordinates:[e[0],t]}}]}return[]},performEventPressedMove:function(o){var e=o.points,t=o.performPoint;e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex,e[1].timestamp=t.timestamp,e[1].dataIndex=t.dataIndex},performEventMoveForDrawing:function(o){var e=o.points,t=o.performPoint;o.currentStep===2&&(e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex)}},{name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){var e=o.coordinates;return e.length===2?[{type:"line",attrs:{coordinates:e}}]:[]},performEventPressedMove:function(o){var e=o.points,t=o.performPoint;e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex,e[1].timestamp=t.timestamp,e[1].dataIndex=t.dataIndex},performEventMoveForDrawing:function(o){var e=o.points,t=o.performPoint;o.currentStep===2&&(e[0].timestamp=t.timestamp,e[0].dataIndex=t.dataIndex)}},{name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(o){var e=o.coordinates;return[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:o.bounding.height}]}}]}},Go,Uo].forEach(function(o){mt[o.name]=hn.extend(o)});var _e="candle_pane",$o="indicator_pane_",we="x_axis_pane",Ko=function(){function o(e){this._instances=new Map,this._counter=new Map,this._progressInstanceInfo=null,this._pressedInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._hoverInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._clickInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._chartStore=e}return o.prototype._overrideInstance=function(e,t){var r=t.id,n=t.groupId,s=t.points,l=t.styles,u=t.lock,c=t.visible,h=t.zLevel,v=t.mode,p=t.modeSensitivity,f=t.extendData,m=t.onDrawStart,S=t.onDrawing,I=t.onDrawEnd,T=t.onClick,E=t.onDoubleClick,P=t.onRightClick,M=t.onPressedMoveStart,A=t.onPressedMoving,L=t.onPressedMoveEnd,R=t.onMouseEnter,O=t.onMouseLeave,V=t.onRemoved,N=t.onSelected,Y=t.onDeselected,W=!1,G=!1;return r!==void 0&&e.setId(r),n!==void 0&&e.setGroupId(n),s!==void 0&&e.setPoints(s)&&(W=!0),l!==void 0&&e.setStyles(l)&&(W=!0),u!==void 0&&e.setLock(u),c!==void 0&&e.setVisible(c)&&(W=!0),h!==void 0&&e.setZLevel(h)&&(W=!0,G=!0),v!==void 0&&e.setMode(v),p!==void 0&&e.setModeSensitivity(p),f!==void 0&&e.setExtendData(f)&&(W=!0),m!==void 0&&e.setOnDrawStartCallback(m),S!==void 0&&e.setOnDrawingCallback(S),I!==void 0&&e.setOnDrawEndCallback(I),T!==void 0&&e.setOnClickCallback(T),E!==void 0&&e.setOnDoubleClickCallback(E),P!==void 0&&e.setOnRightClickCallback(P),M!==void 0&&e.setOnPressedMoveStartCallback(M),A!==void 0&&e.setOnPressedMovingCallback(A),L!==void 0&&e.setOnPressedMoveEndCallback(L),R!==void 0&&e.setOnMouseEnterCallback(R),O!==void 0&&e.setOnMouseLeaveCallback(O),V!==void 0&&e.setOnRemovedCallback(V),N!==void 0&&e.setOnSelectedCallback(N),Y!==void 0&&e.setOnDeselectedCallback(Y),[W,G]},o.prototype.getInstanceById=function(e){var t,r;try{for(var n=Fe(this._instances),s=n.next();!s.done;s=n.next()){var l=s.value[1].find(function(u){return u.id===e});if(l!==void 0)return l}}catch(u){t={error:u}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return this._progressInstanceInfo!==null&&this._progressInstanceInfo.instance.id===e?this._progressInstanceInfo.instance:null},o.prototype._sort=function(e){var t;e!==void 0?(t=this._instances.get(e))===null||t===void 0||t.sort(function(r,n){return r.defaultZLevel-n.defaultZLevel}).sort(function(r,n){return r.zLevel-n.zLevel}):this._instances.forEach(function(r){r.sort(function(n,s){return n.defaultZLevel-s.defaultZLevel}).sort(function(n,s){return n.zLevel-s.zLevel})})},o.prototype.addInstances=function(e,t,r){var n=this,s=e.map(function(l){var u,c,h,v,p,f=(u=l.id)!==null&&u!==void 0?u:sn("overlay_");if(n.getInstanceById(f)===null){var m=Zo(l.name);if(m!==null){var S=new m,I=((c=n._counter.get(t))!==null&&c!==void 0?c:0)+1;n._counter.set(t,I),S.setDefaultZLevel(I),S.setPaneId(t);var T=(h=l.groupId)!==null&&h!==void 0?h:f;return l.id=f,l.groupId=T,n._overrideInstance(S,l),S.isDrawing()?n._progressInstanceInfo={paneId:t,instance:S,appointPaneFlag:r}:(n._instances.has(t)||n._instances.set(t,[]),(v=n._instances.get(t))===null||v===void 0||v.push(S)),S.isStart()&&((p=S.onDrawStart)===null||p===void 0||p.call(S,{overlay:S})),f}}return null});return s.some(function(l){return l!==null})&&(this._sort(),this._chartStore.getChart().updatePane(1,t)),s},o.prototype.getProgressInstanceInfo=function(){return this._progressInstanceInfo},o.prototype.progressInstanceComplete=function(){var e;if(this._progressInstanceInfo!==null){var t=this._progressInstanceInfo,r=t.instance,n=t.paneId;r.isDrawing()||(this._instances.has(n)||this._instances.set(n,[]),(e=this._instances.get(n))===null||e===void 0||e.push(r),this._sort(n),this._progressInstanceInfo=null)}},o.prototype.updateProgressInstanceInfo=function(e,t){this._progressInstanceInfo!==null&&(t!==void 0&&t&&(this._progressInstanceInfo.appointPaneFlag=t),this._progressInstanceInfo.paneId=e,this._progressInstanceInfo.instance.setPaneId(e))},o.prototype.getInstances=function(e){var t;if(e===void 0){var r=[];return this._instances.forEach(function(n){r=r.concat(n)}),r}return(t=this._instances.get(e))!==null&&t!==void 0?t:[]},o.prototype.override=function(e){var t=this,r=e.id,n=e.groupId,s=e.name,l=!1,u=!1,c=function(p){var f=t._overrideInstance(p,e);f[0]&&(l=!0),f[1]&&(u=!0)};if(r!==void 0){var h=this.getInstanceById(r);h!==null&&c(h)}else if(this._instances.forEach(function(p){p.forEach(function(f){(s!==void 0&&f.name===s||n!==void 0&&f.groupId===n||s===void 0&&n===void 0)&&c(f)})}),this._progressInstanceInfo!==null){var v=this._progressInstanceInfo.instance;(s!==void 0&&v.name===s||n!==void 0&&v.groupId===n||s===void 0&&n===void 0)&&c(v)}u&&this._sort(),l&&this._chartStore.getChart().updatePane(1)},o.prototype.removeInstance=function(e){var t,r,n,s=function(m,S){if(m.id!==void 0){if(S.id!==m.id)return!1}else if(m.groupId!==void 0){if(S.groupId!==m.groupId)return!1}else if(m.name!==void 0&&S.name!==m.name)return!1;return!0},l=[];if(this._progressInstanceInfo!==null){var u=this._progressInstanceInfo.instance;(e===void 0||e!==void 0&&s(e,u))&&(l.push(this._progressInstanceInfo.paneId),(n=u.onRemoved)===null||n===void 0||n.call(u,{overlay:u}),this._progressInstanceInfo=null)}if(e!==void 0){var c=new Map,h=function(m){var S=m[1].filter(function(I){var T;return!s(e,I)||(l.includes(m[0])||l.push(m[0]),(T=I.onRemoved)===null||T===void 0||T.call(I,{overlay:I}),!1)});S.length>0&&c.set(m[0],S)};try{for(var v=Fe(this._instances),p=v.next();!p.done;p=v.next())h(p.value)}catch(m){t={error:m}}finally{try{p&&!p.done&&(r=v.return)&&r.call(v)}finally{if(t)throw t.error}}this._instances=c}else this._instances.forEach(function(m,S){l.push(S),m.forEach(function(I){var T;(T=I.onRemoved)===null||T===void 0||T.call(I,{overlay:I})})}),this._instances.clear();if(l.length>0){var f=this._chartStore.getChart();l.forEach(function(m){f.updatePane(1,m)}),f.updatePane(1,we)}},o.prototype.setPressedInstanceInfo=function(e){this._pressedInstanceInfo=e},o.prototype.getPressedInstanceInfo=function(){return this._pressedInstanceInfo},o.prototype.setHoverInstanceInfo=function(e,t){var r,n,s=this._hoverInstanceInfo,l=s.instance,u=s.figureKey,c=s.figureIndex;if(((l==null?void 0:l.id)!==((r=e.instance)===null||r===void 0?void 0:r.id)||s.figureType!==e.figureType||c!==e.figureIndex)&&(this._hoverInstanceInfo=e,(l==null?void 0:l.id)!==((n=e.instance)===null||n===void 0?void 0:n.id))){var h=!1,v=!1;l!==null&&(v=!0,l.resetZLevel(),U(l.onMouseLeave)&&(l.onMouseLeave(j({overlay:l,figureKey:u,figureIndex:c},t)),h=!0)),e.instance!==null&&(v=!0,e.instance.setZLevel(Ho),U(e.instance.onMouseEnter)&&(e.instance.onMouseEnter(j({overlay:e.instance,figureKey:e.figureKey,figureIndex:e.figureIndex},t)),h=!0)),v&&this._sort(),h||this._chartStore.getChart().updatePane(1)}},o.prototype.getHoverInstanceInfo=function(){return this._hoverInstanceInfo},o.prototype.setClickInstanceInfo=function(e,t){var r,n,s,l,u,c,h,v,p,f=this._clickInstanceInfo,m=f.paneId,S=f.instance,I=f.figureType,T=f.figureKey,E=f.figureIndex;if((n=(r=e.instance)===null||r===void 0?void 0:r.isDrawing())!==null&&n!==void 0&&n||(l=(s=e.instance)===null||s===void 0?void 0:s.onClick)===null||l===void 0||l.call(s,j({overlay:e.instance,figureKey:e.figureKey,figureIndex:e.figureIndex},t)),((S==null?void 0:S.id)!==((u=e.instance)===null||u===void 0?void 0:u.id)||I!==e.figureType||E!==e.figureIndex)&&(this._clickInstanceInfo=e,(S==null?void 0:S.id)!==((c=e.instance)===null||c===void 0?void 0:c.id))){(h=S==null?void 0:S.onDeselected)===null||h===void 0||h.call(S,j({overlay:S,figureKey:T,figureIndex:E},t)),(p=(v=e.instance)===null||v===void 0?void 0:v.onSelected)===null||p===void 0||p.call(v,j({overlay:e.instance,figureKey:e.figureKey,figureIndex:e.figureIndex},t));var P=this._chartStore.getChart();P.updatePane(1,e.paneId),m!==e.paneId&&P.updatePane(1,m),P.updatePane(1,we)}},o.prototype.getClickInstanceInfo=function(){return this._clickInstanceInfo},o.prototype.isEmpty=function(){return this._instances.size===0&&this._progressInstanceInfo===null},o.prototype.isDrawing=function(){var e,t;return this._progressInstanceInfo!==null&&(t=(e=this._progressInstanceInfo)===null||e===void 0?void 0:e.instance.isDrawing())!==null&&t!==void 0&&t},o}(),Jo=function(){function o(){this._actions=new Map}return o.prototype.execute=function(e,t){var r;(r=this._actions.get(e))===null||r===void 0||r.execute(t)},o.prototype.subscribe=function(e,t){var r;this._actions.has(e)||this._actions.set(e,new Po),(r=this._actions.get(e))===null||r===void 0||r.subscribe(t)},o.prototype.unsubscribe=function(e,t){var r=this._actions.get(e);r!==void 0&&(r.unsubscribe(t),r.isEmpty()&&this._actions.delete(e))},o.prototype.has=function(e){var t=this._actions.get(e);return t!==void 0&&!t.isEmpty()},o}(),mn={light:{grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},dark:{grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}}};function yn(o){var e;return(e=mn[o])!==null&&e!==void 0?e:null}var Qo=function(){function o(e,t){this._styles={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:a.LineType.Dashed,dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:a.LineType.Dashed,dashedValue:[2,2]}},candle:{type:a.CandleType.CandleSolid,bar:{upColor:"#2DC08E",downColor:"#F92855",noChangeColor:"#888888",upBorderColor:"#2DC08E",downBorderColor:"#F92855",noChangeBorderColor:"#888888",upWickColor:"#2DC08E",downWickColor:"#F92855",noChangeWickColor:"#888888"},area:{lineSize:2,lineColor:"#1677FF",value:"close",backgroundColor:[{offset:0,color:"rgba(22, 119, 255, 0.01)"},{offset:1,color:"rgba(22, 119, 255, 0.2)"}]},priceMark:{show:!0,high:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},low:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},last:{show:!0,upColor:"#2DC08E",downColor:"#F92855",noChangeColor:"#888888",line:{show:!0,style:a.LineType.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:a.PolygonType.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:a.LineType.Solid,borderSize:0,borderDashedValue:[2,2],color:"#FFFFFF",family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:a.TooltipShowRule.Always,showType:a.TooltipShowType.Standard,custom:null,defaultValue:"n/a",rect:{position:b.Fixed,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:8,offsetLeft:10,offsetTop:8,offsetRight:10,offsetBottom:8,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},indicator:{ohlc:{upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"},bars:[{style:a.PolygonType.Fill,borderStyle:a.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"}],lines:[{style:a.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#FF9600"},{style:a.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#935EBD"},{style:a.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#1677FF"},{style:a.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#E11D74"},{style:a.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#01C5C4"}],circles:[{style:a.PolygonType.Fill,borderStyle:a.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"}],lastValueMark:{show:!1,text:{show:!1,style:a.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:a.LineType.Solid,borderColor:"transparent",borderSize:1,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{showRule:a.TooltipShowRule.Always,showType:a.TooltipShowType.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},xAxis:{show:!0,size:"auto",axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},yAxis:{show:!0,size:"auto",type:a.YAxisType.Normal,position:a.YAxisPosition.Right,inside:!1,reverse:!1,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},separator:{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:"rgba(33, 150, 243, 0.08)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:a.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:a.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:a.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:"#686D76",borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}},vertical:{show:!0,line:{show:!0,style:a.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:a.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:a.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#686D76",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}}},overlay:{point:{color:"#1677FF",borderColor:"rgba(22, 119, 255, 0.35)",borderSize:1,radius:5,activeColor:"#1677FF",activeBorderColor:"rgba(22, 119, 255, 0.35)",activeBorderSize:3,activeRadius:5},line:{style:a.LineType.Solid,smooth:!1,color:"#1677FF",size:1,dashedValue:[2,2]},rect:{style:a.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderRadius:0,borderStyle:a.LineType.Solid,borderDashedValue:[2,2]},polygon:{style:a.PolygonType.Fill,color:"#1677FF",borderColor:"#1677FF",borderSize:1,borderStyle:a.LineType.Solid,borderDashedValue:[2,2]},circle:{style:a.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderStyle:a.LineType.Solid,borderDashedValue:[2,2]},arc:{style:a.LineType.Solid,color:"#1677FF",size:1,dashedValue:[2,2]},text:{style:a.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:a.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"},rectText:{style:a.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:a.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"}}},this._customApi={formatDate:ke,formatBigNumber:vt},this._locale="en-US",this._precision={price:2,volume:0},this._thousandsSeparator=",",this._dataList=[],this._timeScaleStore=new ko(this),this._indicatorStore=new zo(this),this._overlayStore=new Ko(this),this._tooltipStore=new No(this),this._actionStore=new Jo,this._visibleDataList=[],this._chart=e,this.setOptions(t)}return o.prototype.adjustVisibleDataList=function(){this._visibleDataList=[];for(var e=this._timeScaleStore.getVisibleRange(),t=e.to,r=e.from;t>r;r++){var n=this._dataList[r],s=this._timeScaleStore.dataIndexToCoordinate(r);this._visibleDataList.push({dataIndex:r,x:s,data:n})}},o.prototype.setOptions=function(e){if(e!==void 0){var t=e.locale,r=e.timezone,n=e.styles,s=e.customApi;t!==void 0&&(this._locale=t),r!==void 0&&this._timeScaleStore.setTimezone(r),n!==void 0&&(oe(n)?B(this._styles,yn(n)):B(this._styles,n)),s!==void 0&&B(this._customApi,s),e.thousandsSeparator!==void 0&&(this._thousandsSeparator=e.thousandsSeparator)}return this},o.prototype.getStyles=function(){return this._styles},o.prototype.getLocale=function(){return this._locale},o.prototype.getCustomApi=function(){return this._customApi},o.prototype.getThousandsSeparator=function(){return this._thousandsSeparator},o.prototype.getPrecision=function(){return this._precision},o.prototype.setPrecision=function(e){return this._precision=e,this._indicatorStore.setSeriesPrecision(e),this},o.prototype.getDataList=function(){return this._dataList},o.prototype.getVisibleDataList=function(){return this._visibleDataList},o.prototype.addData=function(e,t,r){if(H(e)){this._timeScaleStore.setLoading(!1),this._timeScaleStore.setMore(r==null||r);var n=this._dataList.length===0;this._dataList=e.concat(this._dataList),n&&this._timeScaleStore.resetOffsetRightDistance(),this._timeScaleStore.adjustVisibleRange()}else if(t<this._dataList.length)this._dataList[t]=e,this.adjustVisibleDataList();else{this._dataList.push(e);var s=this._timeScaleStore.getOffsetRightBarCount();0>s&&this._timeScaleStore.setOffsetRightBarCount(--s),this._timeScaleStore.adjustVisibleRange()}this._tooltipStore.recalculateCrosshair(!0)},o.prototype.clear=function(){this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear(),this._tooltipStore.clear()},o.prototype.getTimeScaleStore=function(){return this._timeScaleStore},o.prototype.getIndicatorStore=function(){return this._indicatorStore},o.prototype.getOverlayStore=function(){return this._overlayStore},o.prototype.getTooltipStore=function(){return this._tooltipStore},o.prototype.getActionStore=function(){return this._actionStore},o.prototype.getChart=function(){return this._chart},o}(),me="main",Be="xAxis",Re="yAxis",yt="separator";function xn(o){var e={width:0,height:0,left:0,right:0,top:0,bottom:0};return o!==void 0&&B(e,o),e}var _n=function(o){function e(t,r){var n=o.call(this)||this;return n._bounding=xn(),n._pane=r,n.init(t),n}return $(e,o),e.prototype.init=function(t){this._rootContainer=t,this._container=this.createContainer(),t.appendChild(this._container)},e.prototype.setBounding=function(t){return B(this._bounding,t),this},e.prototype.getContainer=function(){return this._container},e.prototype.getBounding=function(){return this._bounding},e.prototype.getPane=function(){return this._pane},e.prototype.update=function(t){this.updateImp(this._container,this._bounding,t??3)},e.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},e}(Qt);function tr(o){return window.requestAnimationFrame==null?window.setTimeout(o,20):window.requestAnimationFrame(o)}function At(o){window.cancelAnimationFrame==null&&window.clearTimeout(o),window.cancelAnimationFrame(o)}var ot=-1,rr=function(o){function e(){var t=o!==null&&o.apply(this,arguments)||this;return t._mainRequestAnimationId=ot,t._overlayRequestAnimationId=ot,t}return $(e,o),e.prototype.init=function(t){o.prototype.init.call(this,t),this._mainCanvas=Le("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._mainCtx=this._mainCanvas.getContext("2d"),this._overlayCanvas=Le("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._overlayCtx=this._overlayCanvas.getContext("2d");var r=this.getContainer();r.appendChild(this._mainCanvas),r.appendChild(this._overlayCanvas)},e.prototype.createContainer=function(){return Le("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box",zIndex:"1"})},e.prototype._optimalUpdateMain=function(t,r){var n=this;this._mainRequestAnimationId!==ot&&(At(this._mainRequestAnimationId),this._mainRequestAnimationId=ot),this._mainRequestAnimationId=tr(function(){if(t!==n._mainCanvas.offsetWidth||r!==n._mainCanvas.offsetHeight){n._mainCtx.clearRect(0,0,n._mainCanvas.offsetWidth,n._mainCanvas.offsetHeight);var s=Ue(n._mainCanvas),l=Math.floor(t*s),u=Math.floor(r*s);n._mainCanvas.style.width="".concat(t,"px"),n._mainCanvas.style.height="".concat(r,"px"),n._mainCanvas.width=l,n._mainCanvas.height=u,n._mainCtx.scale(s,s)}else n._mainCtx.clearRect(0,0,n._mainCanvas.offsetWidth,n._mainCanvas.offsetHeight);n.updateMain(n._mainCtx)})},e.prototype._optimalUpdateOverlay=function(t,r){var n=this;this._overlayRequestAnimationId!==ot&&(At(this._overlayRequestAnimationId),this._overlayRequestAnimationId=ot),this._overlayRequestAnimationId=tr(function(){if(t!==n._overlayCanvas.offsetWidth||r!==n._overlayCanvas.offsetHeight){n._overlayCtx.clearRect(0,0,n._overlayCanvas.offsetWidth,n._overlayCanvas.offsetHeight);var s=Ue(n._overlayCanvas),l=Math.floor(t*s),u=Math.floor(r*s);n._overlayCanvas.style.width="".concat(t,"px"),n._overlayCanvas.style.height="".concat(r,"px"),n._overlayCanvas.width=l,n._overlayCanvas.height=u,n._overlayCtx.scale(s,s)}else n._overlayCtx.clearRect(0,0,n._overlayCanvas.offsetWidth,n._overlayCanvas.offsetHeight);n.updateOverlay(n._overlayCtx)})},e.prototype.updateImp=function(t,r,n){var s=r.width,l=r.height;t.style.left="".concat(r.left,"px");var u=n;switch(s===t.offsetWidth&&l===t.offsetHeight||(t.style.width="".concat(s,"px"),t.style.height="".concat(l,"px"),u=3),u){case 0:this._optimalUpdateMain(s,l);break;case 1:this._optimalUpdateOverlay(s,l);break;case 3:case 4:this._optimalUpdateMain(s,l),this._optimalUpdateOverlay(s,l)}},e.prototype.getImage=function(t){var r=this.getBounding(),n=r.width,s=r.height,l=Le("canvas",{width:"".concat(n,"px"),height:"".concat(s,"px"),boxSizing:"border-box"}),u=l.getContext("2d"),c=Ue(l);return l.width=n*c,l.height=s*c,u.scale(c,c),u.drawImage(this._mainCanvas,0,0,n,s),t&&u.drawImage(this._overlayCanvas,0,0,n,s),l},e}(_n);function wn(o,e){var t=o.x-e.x,r=o.y-e.y,n=e.r;return!(t*t+r*r>n*n)}function Cn(o,e,t){var r=e.x,n=e.y,s=e.r,l=t.style,u=l===void 0?a.PolygonType.Fill:l,c=t.color,h=t.borderSize,v=h===void 0?1:h,p=t.borderColor,f=p===void 0?"currentColor":p,m=t.borderStyle,S=m===void 0?a.LineType.Solid:m,I=t.borderDashedValue,T=I===void 0?[2,2]:I;u!==a.PolygonType.Fill&&t.style!==a.PolygonType.StrokeFill||(o.fillStyle=c===void 0?"currentColor":c,o.beginPath(),o.arc(r,n,s,0,2*Math.PI),o.closePath(),o.fill()),u!==a.PolygonType.Stroke&&t.style!==a.PolygonType.StrokeFill||(o.strokeStyle=f,o.lineWidth=v,o.setLineDash(S===a.LineType.Dashed?T:[]),o.beginPath(),o.arc(r,n,s,0,2*Math.PI),o.closePath(),o.stroke())}var es={name:"circle",checkEventOn:wn,draw:function(o,e,t){Cn(o,e,t)}};function Sn(o,e){for(var t=!1,r=e.coordinates,n=0,s=r.length-1;r.length>n;s=n++)r[n].y>o.y!=r[s].y>o.y&&(r[s].x-r[n].x)*(o.y-r[n].y)/(r[s].y-r[n].y)+r[n].x>o.x&&(t=!t);return t}function bn(o,e,t){var r=e.coordinates,n=t.style,s=n===void 0?a.PolygonType.Fill:n,l=t.color,u=t.borderSize,c=u===void 0?1:u,h=t.borderColor,v=h===void 0?"currentColor":h,p=t.borderStyle,f=p===void 0?a.LineType.Solid:p,m=t.borderDashedValue,S=m===void 0?[2,2]:m;if(s===a.PolygonType.Fill||t.style===a.PolygonType.StrokeFill){o.fillStyle=l===void 0?"currentColor":l,o.beginPath(),o.moveTo(r[0].x,r[0].y);for(var I=1;r.length>I;I++)o.lineTo(r[I].x,r[I].y);o.closePath(),o.fill()}if(s===a.PolygonType.Stroke||t.style===a.PolygonType.StrokeFill){for(o.strokeStyle=v,o.lineWidth=c,o.setLineDash(f===a.LineType.Dashed?S:[]),o.beginPath(),o.moveTo(r[0].x,r[0].y),I=1;r.length>I;I++)o.lineTo(r[I].x,r[I].y);o.closePath(),o.stroke()}}var ts={name:"polygon",checkEventOn:Sn,draw:function(o,e,t){bn(o,e,t)}};function In(o){return o==="transparent"}function Tn(o,e){var t=e.x,r=e.width;4>r&&(t-=2,r=4);var n=e.y,s=e.height;return 4>s&&(n-=2,s=4),!(t>o.x||o.x>t+r||n>o.y||o.y>n+s)}function nr(o,e,t){var r=e.x,n=e.y,s=e.width,l=e.height,u=t.style,c=u===void 0?a.PolygonType.Fill:u,h=t.color,v=h===void 0?"transparent":h,p=t.borderSize,f=p===void 0?1:p,m=t.borderColor,S=m===void 0?"transparent":m,I=t.borderStyle,T=I===void 0?a.LineType.Solid:I,E=t.borderRadius,P=E===void 0?0:E,M=t.borderDashedValue,A=M===void 0?[2,2]:M;if(c===a.PolygonType.Fill||t.style===a.PolygonType.StrokeFill){var L=!0;oe(v)&&(L=!In(v)),L&&(o.fillStyle=v,o.beginPath(),o.moveTo(r+P,n),o.arcTo(r+s,n,r+s,n+l,P),o.arcTo(r+s,n+l,r,n+l,P),o.arcTo(r,n+l,r,n,P),o.arcTo(r,n,r+s,n,P),o.closePath(),o.fill())}c!==a.PolygonType.Stroke&&t.style!==a.PolygonType.StrokeFill||In(S)||0>f||(o.strokeStyle=S,o.lineWidth=f,o.setLineDash(T===a.LineType.Dashed?A:[]),o.beginPath(),o.moveTo(r+P,n),o.arcTo(r+s,n,r+s,n+l,P),o.arcTo(r+s,n+l,r,n+l,P),o.arcTo(r,n+l,r,n,P),o.arcTo(r,n,r+s,n,P),o.closePath(),o.stroke())}var rs={name:"rect",checkEventOn:Tn,draw:function(o,e,t){nr(o,e,t)}};function En(o,e){var t,r,n=e.size,s=n===void 0?12:n,l=e.paddingLeft,u=e.paddingTop,c=u===void 0?0:u,h=e.paddingRight,v=h===void 0?0:h,p=e.paddingBottom,f=p===void 0?0:p,m=e.weight,S=o.x,I=o.y,T=o.align,E=T===void 0?"left":T,P=o.baseline,M=P===void 0?"top":P,A=o.width,L=o.height,R=A??(l===void 0?0:l)+pt(o.text,s,m===void 0?"normal":m,e.family)+v,O=L??c+s+f;switch(E){case"left":case"start":t=S;break;case"right":case"end":t=S-R;break;default:t=S-R/2}switch(M){case"top":case"hanging":r=I;break;case"bottom":case"ideographic":case"alphabetic":r=I-O;break;default:r=I-O/2}return{x:t,y:r,width:R,height:O}}function Pn(o,e,t){var r=En(e,t),n=r.x,s=r.y;return!(n>o.x||o.x>n+r.width||s>o.y||o.y>s+r.height)}function ir(o,e,t){var r=e.text,n=t.color,s=n===void 0?"currentColor":n,l=t.size,u=l===void 0?12:l,c=t.family,h=t.weight,v=t.paddingLeft,p=v===void 0?0:v,f=t.paddingTop,m=f===void 0?0:f,S=t.paddingRight,I=S===void 0?0:S,T=En(e,t);nr(o,T,j(j({},t),{color:t.backgroundColor})),o.textAlign="left",o.textBaseline="top",o.font=Ze(u,h,c),o.fillStyle=s,o.fillText(r,T.x+p,T.y+m,T.width-p-I)}var Mn={name:"text",checkEventOn:function(o,e,t){return Pn(o,e,t)},draw:function(o,e,t){ir(o,e,t)}},ns=ir;function Dn(o,e){if(2>Math.abs(Math.sqrt((p=(h=o).x-(v=e).x)*p+(f=h.y-v.y)*f)-e.r)){var t=e.r,r=e.startAngle,n=e.endAngle,s=t*Math.cos(r)+e.x,l=t*Math.sin(r)+e.y,u=t*Math.cos(n)+e.x,c=t*Math.sin(n)+e.y;return!(o.x>Math.max(s,u)+2||Math.min(s,u)-2>o.x||o.y>Math.max(l,c)+2||Math.min(l,c)-2>o.y)}var h,v,p,f;return!1}function kn(o,e,t){var r=e.x,n=e.y,s=e.r,l=e.startAngle,u=e.endAngle,c=t.style,h=c===void 0?a.LineType.Solid:c,v=t.size,p=t.color,f=p===void 0?"currentColor":p,m=t.dashedValue,S=m===void 0?[2,2]:m;o.lineWidth=v===void 0?1:v,o.strokeStyle=f,o.setLineDash(h===a.LineType.Dashed?S:[]),o.beginPath(),o.arc(r,n,s,l,u),o.stroke(),o.closePath()}var is={name:"arc",checkEventOn:Dn,draw:function(o,e,t){kn(o,e,t)}},xt={};[es,jo,ts,rs,Mn,Mn,is].forEach(function(o){xt[o.name]=dn.extend(o)});var Oe=function(o){function e(t){var r=o.call(this)||this;return r._widget=t,r}return $(e,o),e.prototype.getWidget=function(){return this._widget},e.prototype.createFigure=function(t,r,n,s){var l=function(h){var v;return(v=xt[h])!==null&&v!==void 0?v:null}(t);if(l!==null){var u=new l({name:t,attrs:r,styles:n});if(s!==void 0){for(var c in s)s.hasOwnProperty(c)&&u.registerEvent(c,s[c]);this.addChild(u)}return u}return null},e.prototype.draw=function(t){this.clear(),this.drawImp(t)},e}(Qt),os=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.drawImp=function(t){var r=this,n=this.getWidget(),s=this.getWidget().getPane(),l=s.getChart(),u=n.getBounding(),c=l.getStyles().grid;if(c.show){t.save(),t.globalCompositeOperation="destination-over";var h=c.horizontal;h.show&&s.getAxisComponent().getTicks().forEach(function(p){var f;(f=r.createFigure("line",{coordinates:[{x:0,y:p.coord},{x:u.width,y:p.coord}]},h))===null||f===void 0||f.draw(t)});var v=c.vertical;v.show&&l.getXAxisPane().getAxisComponent().getTicks().forEach(function(p){var f;(f=r.createFigure("line",{coordinates:[{x:p.coord,y:0},{x:p.coord,y:u.height}]},v))===null||f===void 0||f.draw(t)}),t.restore()}},e}(Oe),or=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.eachChildren=function(t){var r=this.getWidget().getPane().getChart().getChartStore(),n=r.getVisibleDataList(),s=r.getTimeScaleStore().getBarSpace();n.forEach(function(l,u){t(l,s,u)})},e}(Oe),An=function(o){function e(){var t=o!==null&&o.apply(this,arguments)||this;return t._boundCandleBarClickEvent=function(r){return function(){return t.getWidget().getPane().getChart().getChartStore().getActionStore().execute(a.ActionType.OnCandleBarClick,r),!1}},t}return $(e,o),e.prototype.drawImp=function(t){var r=this,n=this.getWidget().getPane(),s=n.getId()===_e,l=n.getChart().getChartStore(),u=this.getCandleBarOptions(l);if(u!==null){var c=n.getAxisComponent();this.eachChildren(function(h,v){r._drawCandleBar(t,c,h,v,u,s)})}},e.prototype.getCandleBarOptions=function(t){var r=t.getStyles().candle;return{type:r.type,styles:r.bar}},e.prototype._drawCandleBar=function(t,r,n,s,l,u){var c,h,v,p=this,f=n.data,m=n.x,S=f.open,I=f.high,T=f.low,E=f.close,P=s.halfGapBar,M=s.gapBar,A=l.type,L=l.styles;E>S?(c=L.upColor,h=L.upBorderColor,v=L.upWickColor):S>E?(c=L.downColor,h=L.downBorderColor,v=L.downWickColor):(c=L.noChangeColor,h=L.noChangeBorderColor,v=L.noChangeWickColor);var R=r.convertToPixel(S),O=r.convertToPixel(E),V=[R,O,r.convertToPixel(I),r.convertToPixel(T)];V.sort(function(W,G){return W-G});var N=Math.max(1,V[2]-V[1]),Y=[];A!==a.CandleType.Ohlc?(Y.push({name:"rect",attrs:{x:m-.5,y:V[0],width:1,height:V[1]-V[0]},styles:{color:v}}),Y.push(A===a.CandleType.CandleStroke||A===a.CandleType.CandleUpStroke&&E>S||A===a.CandleType.CandleDownStroke&&S>E?{name:"rect",attrs:{x:m-P+.5,y:V[1],width:M-1,height:N},styles:{style:a.PolygonType.Stroke,borderColor:h}}:{name:"rect",attrs:{x:m-P+.5,y:V[1],width:M-1,height:N},styles:{style:a.PolygonType.StrokeFill,color:c,borderColor:h}}),Y.push({name:"rect",attrs:{x:m-.5,y:V[2],width:1,height:V[3]-V[2]},styles:{color:v}})):Y=[{name:"rect",attrs:{x:m-.5,y:V[0],width:1,height:V[3]-V[0]},styles:{color:c}},{name:"rect",attrs:{x:m-P,y:R,width:P,height:1},styles:{color:c}},{name:"rect",attrs:{x:m,y:O,width:P,height:1},styles:{color:c}}],Y.forEach(function(W){var G,X,K=W.attrs,J=W.styles;u&&(X={mouseClickEvent:p._boundCandleBarClickEvent(n)}),(G=p.createFigure("rect",K,J,X))===null||G===void 0||G.draw(t)})},e}(or),ss=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.getCandleBarOptions=function(t){var r,n,s=this.getWidget().getPane();if(!s.getAxisComponent().isInCandle()){var l=t.getIndicatorStore().getInstances(s.getId());try{for(var u=Fe(l),c=u.next();!c.done;c=u.next()){var h=c.value[1];if(h.shouldOhlc&&h.visible){var v=h.styles,p=t.getStyles().indicator,f=te(v,"ohlc.upColor",p.ohlc.upColor),m=te(v,"ohlc.downColor",p.ohlc.downColor),S=te(v,"ohlc.noChangeColor",p.ohlc.noChangeColor);return{type:a.CandleType.Ohlc,styles:{upColor:f,downColor:m,noChangeColor:S,upBorderColor:f,downBorderColor:m,noChangeBorderColor:S,upWickColor:f,downWickColor:m,noChangeWickColor:S}}}}}catch(I){r={error:I}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}}return null},e.prototype.drawImp=function(t){var r=this;o.prototype.drawImp.call(this,t);var n=this.getWidget(),s=n.getPane(),l=s.getChart(),u=n.getBounding(),c=l.getXAxisPane().getAxisComponent(),h=s.getAxisComponent(),v=l.getChartStore(),p=v.getDataList(),f=v.getTimeScaleStore(),m=f.getVisibleRange(),S=v.getIndicatorStore().getInstances(s.getId()),I=v.getStyles().indicator;S.forEach(function(T){var E;if(T.visible){var P=!1;if(T.draw!==null&&(t.save(),P=(E=T.draw({ctx:t,kLineDataList:p,indicator:T,visibleRange:m,bounding:u,barSpace:f.getBarSpace(),defaultStyles:I,xAxis:c,yAxis:h}))!==null&&E!==void 0&&E,t.restore()),!P){var M=T.result;r.eachChildren(function(A,L){var R,O,V,N=L.halfGapBar,Y=L.gapBar,W=A.dataIndex,G=A.x,X=c.convertToPixel(W-1),K=c.convertToPixel(W+1),J=(R=M[W-1])!==null&&R!==void 0?R:{},ie=(O=M[W])!==null&&O!==void 0?O:{},ve=(V=M[W+1])!==null&&V!==void 0?V:{},ae={x:X},he={x:G},Ce={x:K};T.figures.forEach(function(Q){var le=Q.key;ae[le]=h.convertToPixel(J[le]),he[le]=h.convertToPixel(ie[le]),Ce[le]=h.convertToPixel(ve[le])}),Kt(p,T,W,I,function(Q,le){var Se,ye,be;if(q(ie[Q.key])){var He=he[Q.key],Ie=(Se=Q.attrs)===null||Se===void 0?void 0:Se.call(Q,{coordinate:{prev:ae,current:he,next:Ce},bounding:u,barSpace:L,xAxis:c,yAxis:h});if(!q(Ie))switch(Q.type){case"circle":Ie={x:G,y:He,r:N};break;case"rect":case"bar":var Ke=(ye=Q.baseValue)!==null&&ye!==void 0?ye:h.getExtremum().min,We=h.convertToPixel(Ke),Ve=Math.abs(We-He);Ke!==ie[Q.key]&&(Ve=Math.max(1,Ve)),Ie={x:G-N,y:He>We?We:He,width:Y,height:Ve};break;case"line":se(he[Q.key])&&se(Ce[Q.key])&&(Ie={coordinates:[{x:he.x,y:he[Q.key]},{x:Ce.x,y:Ce[Q.key]}]})}if(q(Ie)){var Pe=Q.type;(be=r.createFigure(Pe==="bar"?"rect":Pe,Ie,le))===null||be===void 0||be.draw(t)}}})})}}})},e}(An),as=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.drawImp=function(t){var r=this.getWidget(),n=r.getPane(),s=r.getBounding(),l=r.getPane().getChart().getChartStore(),u=l.getTooltipStore().getCrosshair(),c=l.getStyles().crosshair;if(u.paneId!==void 0&&c.show){if(u.paneId===n.getId()){var h=u.y;this._drawLine(t,[{x:0,y:h},{x:s.width,y:h}],c.horizontal)}var v=u.realX;this._drawLine(t,[{x:v,y:0},{x:v,y:s.height}],c.vertical)}},e.prototype._drawLine=function(t,r,n){var s;if(n.show){var l=n.line;l.show&&((s=this.createFigure("line",{coordinates:r},l))===null||s===void 0||s.draw(t))}},e}(Oe),Fn=function(o){function e(){var t=o!==null&&o.apply(this,arguments)||this;return t._boundIconClickEvent=function(r,n){return function(){return t.getWidget().getPane().getChart().getChartStore().getActionStore().execute(a.ActionType.OnTooltipIconClick,j(j({},r),{iconId:n})),!0}},t._boundIconMouseMoveEvent=function(r,n){return function(){return t.getWidget().getPane().getChart().getChartStore().getTooltipStore().setActiveIcon(j(j({},r),{iconId:n})),!0}},t}return $(e,o),e.prototype.drawImp=function(t){var r=this.getWidget(),n=r.getPane(),s=n.getChart().getChartStore(),l=s.getTooltipStore().getCrosshair();if(l.kLineData!==void 0){var u=r.getBounding(),c=s.getCustomApi(),h=s.getThousandsSeparator(),v=s.getIndicatorStore().getInstances(n.getId()),p=s.getTooltipStore().getActiveIcon(),f=s.getStyles().indicator;this.drawIndicatorTooltip(t,n.getId(),s.getDataList(),l,p,v,c,h,u,f)}},e.prototype.drawIndicatorTooltip=function(t,r,n,s,l,u,c,h,v,p,f){var m=this,S=p.tooltip,I=0;if(this.isDrawTooltip(s,S)){var T=S.text,E=0,P=f??0,M=0;u.forEach(function(A){var L=m.getIndicatorTooltipData(n,s,A,c,h,p),R=L.name,O=L.calcParamsText,V=L.values,N=R.length>0,Y=V.length>0;if(N||Y){var W=ge(m.classifyTooltipIcons(L.icons),3),G=W[1],X=W[2],K=ge(m.drawStandardTooltipIcons(t,v,{paneId:r,indicatorName:A.name,iconId:""},l,W[0],E,P,M),4);if(E=K[0],P=K[1],I+=K[3],M=K[2],N){var J=R;O.length>0&&(J="".concat(J).concat(O));var ie=ge(m.drawStandardTooltipLabels(t,v,[{title:{text:"",color:T.color},value:{text:J,color:T.color}}],E,P,M,T),4);E=ie[0],P=ie[1],I+=ie[3],M=ie[2]}var ve=ge(m.drawStandardTooltipIcons(t,v,{paneId:r,indicatorName:A.name,iconId:""},l,G,E,P,M),4);if(E=ve[0],P=ve[1],I+=ve[3],M=ve[2],Y){var ae=ge(m.drawStandardTooltipLabels(t,v,V,E,P,M,T),4);E=ae[0],P=ae[1],I+=ae[3],M=ae[2]}var he=ge(m.drawStandardTooltipIcons(t,v,{paneId:r,indicatorName:A.name,iconId:""},l,X,E,P,M),4);E=0,I+=he[3],P=he[1]+he[2],M=0}})}return I},e.prototype.drawStandardTooltipIcons=function(t,r,n,s,l,u,c,h){var v=this,p=u,f=c,m=0,S=0,I=0;return l.length>0&&(l.forEach(function(T){var E=T.marginLeft,P=T.marginTop,M=T.marginRight,A=T.marginBottom,L=T.paddingLeft,R=T.paddingTop,O=T.paddingRight,V=T.paddingBottom,N=T.size,Y=T.icon;t.font=Ze(N,"normal",T.fontFamily),m+=E+L+t.measureText(Y).width+O+M,S=Math.max(S,P+R+N+V+A)}),p+m>r.width?(p=l[0].marginLeft,f+=h,I=S):I=Math.max(0,S-h),l.forEach(function(T){var E,P=T.marginRight,M=T.paddingLeft,A=T.paddingRight,L=T.icon,R=(s==null?void 0:s.paneId)===n.paneId&&(s==null?void 0:s.indicatorName)===n.indicatorName&&(s==null?void 0:s.iconId)===T.id;(E=v.createFigure("text",{text:L,x:p+=T.marginLeft,y:f+T.marginTop},{paddingLeft:M,paddingTop:T.paddingTop,paddingRight:A,paddingBottom:T.paddingBottom,color:R?T.activeColor:T.color,size:T.size,family:T.fontFamily,backgroundColor:R?T.activeBackgroundColor:T.backgroundColor},{mouseClickEvent:v._boundIconClickEvent(n,T.id),mouseMoveEvent:v._boundIconMouseMoveEvent(n,T.id)}))===null||E===void 0||E.draw(t),p+=M+t.measureText(L).width+A+P})),[p,f,Math.max(h,S),I]},e.prototype.drawStandardTooltipLabels=function(t,r,n,s,l,u,c){var h=this,v=s,p=l,f=0,m=0,S=u;if(n.length>0){var I=c.marginLeft,T=c.marginTop,E=c.marginRight,P=c.marginBottom,M=c.size,A=c.family,L=c.weight;t.font=Ze(M,L,A),n.forEach(function(R){var O,V,N=R.title,Y=R.value,W=t.measureText(N.text).width,G=t.measureText(Y.text).width,X=M+T+P;v+I+(W+G)+E>r.width?(v=I,p+=X,m+=X):(v+=I,m+=Math.max(0,X-S)),S=f=Math.max(S,X),N.text.length>0&&((O=h.createFigure("text",{x:v,y:p+T,text:N.text},{color:N.color,size:M,family:A,weight:L}))===null||O===void 0||O.draw(t),v+=W),(V=h.createFigure("text",{x:v,y:p+T,text:Y.text},{color:Y.color,size:M,family:A,weight:L}))===null||V===void 0||V.draw(t),v+=G+E})}return[v,p,f,m]},e.prototype.isDrawTooltip=function(t,r){var n=r.showRule;return n===a.TooltipShowRule.Always||n===a.TooltipShowRule.FollowCross&&t.paneId!==void 0},e.prototype.getIndicatorTooltipData=function(t,r,n,s,l,u){var c,h,v=u.tooltip,p=v.showName?n.shortName:"",f="",m=n.calcParams;m.length>0&&v.showParams&&(f="(".concat(m.join(","),")"));var S={name:p,calcParamsText:f,values:[],icons:v.icons},I=r.dataIndex,T=(c=n.result)!==null&&c!==void 0?c:[],E=[];if(n.visible){var P=(h=T[I])!==null&&h!==void 0?h:{};Kt(t,n,I,u,function(X,K){if(X.title!==void 0){var J=K.color,ie=P[X.key];q(ie)&&(ie=ne(ie,n.precision),n.shouldFormatBigNumber&&(ie=s.formatBigNumber(ie))),E.push({title:{text:X.title,color:J},value:{text:ue(ie??v.defaultValue,l),color:J}})}}),S.values=E}if(n.createTooltipDataSource!==null){var M=this.getWidget(),A=M.getPane(),L=A.getChart().getChartStore(),R=n.createTooltipDataSource({kLineDataList:t,indicator:n,visibleRange:L.getTimeScaleStore().getVisibleRange(),bounding:M.getBounding(),crosshair:r,defaultStyles:u,xAxis:A.getChart().getXAxisPane().getAxisComponent(),yAxis:A.getAxisComponent()}),O=R.name,V=R.calcParamsText,N=R.values,Y=R.icons;if(O!==void 0&&v.showName&&(S.name=O),V!==void 0&&v.showParams&&(S.calcParamsText=V),Y!==void 0&&(S.icons=Y),N!==void 0&&n.visible){var W=[],G=u.tooltip.text.color;N.forEach(function(X){var K={text:"",color:G};Z(X.title)?K=X.title:K.text=X.title;var J={text:"",color:G};Z(X.value)?J=X.value:J.text=X.value,J.text=ue(J.text,l),W.push({title:K,value:J})}),S.values=W}}return S},e.prototype.classifyTooltipIcons=function(t){var r=[],n=[],s=[];return t.forEach(function(l){switch(l.position){case a.TooltipIconPosition.Left:r.push(l);break;case a.TooltipIconPosition.Middle:n.push(l);break;case a.TooltipIconPosition.Right:s.push(l)}}),[r,n,s]},e}(Oe),Ln=function(o){function e(t){var r=o.call(this,t)||this;return r._initEvent(),r}return $(e,o),e.prototype._initEvent=function(){var t=this,r=this.getWidget().getPane(),n=r.getId(),s=r.getChart().getChartStore().getOverlayStore();this.registerEvent("mouseMoveEvent",function(l){var u,c=s.getProgressInstanceInfo();if(c!==null){var h=c.instance,v=c.paneId;h.isStart()&&(s.updateProgressInstanceInfo(n),v=n);var p=h.points.length-1,f="".concat(it,"point_").concat(p);return h.isDrawing()&&v===n&&(h.eventMoveForDrawing(t._coordinateToPoint(c.instance,l)),(u=h.onDrawing)===null||u===void 0||u.call(h,j({overlay:h,figureKey:f,figureIndex:p},l))),t._figureMouseMoveEvent(h,1,f,p,0)(l)}return s.setHoverInstanceInfo({paneId:n,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},l),!1}).registerEvent("mouseClickEvent",function(l){var u,c,h=s.getProgressInstanceInfo();if(h!==null){var v=h.instance,p=h.paneId;v.isStart()&&(s.updateProgressInstanceInfo(n,!0),p=n);var f=v.points.length-1,m="".concat(it,"point_").concat(f);return v.isDrawing()&&p===n&&(v.eventMoveForDrawing(t._coordinateToPoint(v,l)),(u=v.onDrawing)===null||u===void 0||u.call(v,j({overlay:v,figureKey:m,figureIndex:f},l)),v.nextStep(),v.isDrawing()||(s.progressInstanceComplete(),(c=v.onDrawEnd)===null||c===void 0||c.call(v,j({overlay:v,figureKey:m,figureIndex:f},l)))),t._figureMouseClickEvent(v,1,m,f,0)(l)}return s.setClickInstanceInfo({paneId:n,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},l),!1}).registerEvent("mouseDoubleClickEvent",function(l){var u,c=s.getProgressInstanceInfo();if(c!==null){var h=c.instance,v=c.paneId;if(h.isDrawing()&&v===n&&(h.forceComplete(),!h.isDrawing())){s.progressInstanceComplete();var p=h.points.length-1,f="".concat(it,"point_").concat(p);(u=h.onDrawEnd)===null||u===void 0||u.call(h,j({overlay:h,figureKey:f,figureIndex:p},l))}var m=h.points.length-1;return t._figureMouseClickEvent(h,1,"".concat(it,"point_").concat(m),m,0)(l)}return!1}).registerEvent("mouseRightClickEvent",function(l){var u=s.getProgressInstanceInfo();if(u!==null){var c=u.instance;if(c.isDrawing()){var h=c.points.length-1;return t._figureMouseRightClickEvent(c,1,"".concat(it,"point_").concat(h),h,0)(l)}}return!1}).registerEvent("mouseUpEvent",function(l){var u,c=s.getPressedInstanceInfo(),h=c.instance;return h!==null&&((u=h.onPressedMoveEnd)===null||u===void 0||u.call(h,j({overlay:h,figureKey:c.figureKey,figureIndex:c.figureIndex},l))),s.setPressedInstanceInfo({paneId:n,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1}),!1}).registerEvent("pressedMouseMoveEvent",function(l){var u,c,h=s.getPressedInstanceInfo(),v=h.instance,p=h.figureType,f=h.figureIndex;if(v!==null){if(!(v.lock||(c=(u=v.onPressedMoving)===null||u===void 0?void 0:u.call(v,j({overlay:v,figureIndex:f,figureKey:h.figureKey},l)))!==null&&c!==void 0&&c)){var m=t._coordinateToPoint(v,l);p===1?v.eventPressedPointMove(m,f):v.eventPressedOtherMove(m,t.getWidget().getPane().getChart().getChartStore().getTimeScaleStore())}return!0}return!1})},e.prototype._createFigureEvents=function(t,r,n,s,l,u){var c;if(!t.isDrawing()){var h=[];if(u!==void 0&&(fe(u)?u&&(h=["mouseClickEvent","mouseDoubleClickEvent","mouseRightClickEvent","tapEvent","doubleTapEvent","mouseDownEvent","touchStartEvent","mouseMoveEvent","touchMoveEvent"]):h=u),h.length===0)return{mouseMoveEvent:this._figureMouseMoveEvent(t,r,n,s,l),mouseDownEvent:this._figureMouseDownEvent(t,r,n,s,l),mouseClickEvent:this._figureMouseClickEvent(t,r,n,s,l),mouseRightClickEvent:this._figureMouseRightClickEvent(t,r,n,s,l),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(t,r,n,s,l)};c={},h.includes("mouseMoveEvent")||h.includes("touchMoveEvent")||(c.mouseMoveEvent=this._figureMouseMoveEvent(t,r,n,s,l)),h.includes("mouseDownEvent")||h.includes("touchStartEvent")||(c.mouseDownEvent=this._figureMouseDownEvent(t,r,n,s,l)),h.includes("mouseClickEvent")||h.includes("tapEvent")||(c.mouseClickEvent=this._figureMouseClickEvent(t,r,n,s,l)),h.includes("mouseDoubleClickEvent")||h.includes("doubleTapEvent")||(c.mouseDoubleClickEvent=this._figureMouseDoubleClickEvent(t,r,n,s,l)),h.includes("mouseRightClickEvent")||(c.mouseRightClickEvent=this._figureMouseRightClickEvent(t,r,n,s,l))}return c},e.prototype._figureMouseMoveEvent=function(t,r,n,s,l){var u=this;return function(c){var h=u.getWidget().getPane();return h.getChart().getChartStore().getOverlayStore().setHoverInstanceInfo({paneId:h.getId(),instance:t,figureType:r,figureKey:n,figureIndex:s,attrsIndex:l},c),!0}},e.prototype._figureMouseDownEvent=function(t,r,n,s,l){var u=this;return function(c){var h,v=u.getWidget().getPane(),p=v.getId(),f=v.getChart().getChartStore().getOverlayStore();return t.startPressedMove(u._coordinateToPoint(t,c)),(h=t.onPressedMoveStart)===null||h===void 0||h.call(t,j({overlay:t,figureIndex:s,figureKey:n},c)),f.setPressedInstanceInfo({paneId:p,instance:t,figureType:r,figureKey:n,figureIndex:s,attrsIndex:l}),!0}},e.prototype._figureMouseClickEvent=function(t,r,n,s,l){var u=this;return function(c){var h=u.getWidget().getPane(),v=h.getId();return h.getChart().getChartStore().getOverlayStore().setClickInstanceInfo({paneId:v,instance:t,figureType:r,figureKey:n,figureIndex:s,attrsIndex:l},c),!0}},e.prototype._figureMouseDoubleClickEvent=function(t,r,n,s,l){return function(u){var c;return(c=t.onDoubleClick)===null||c===void 0||c.call(t,j(j({},u),{figureIndex:s,figureKey:n,overlay:t})),!0}},e.prototype._figureMouseRightClickEvent=function(t,r,n,s,l){var u=this;return function(c){var h,v;return(v=(h=t.onRightClick)===null||h===void 0?void 0:h.call(t,j({overlay:t,figureIndex:s,figureKey:n},c)))!==null&&v!==void 0&&v||u.getWidget().getPane().getChart().getChartStore().getOverlayStore().removeInstance(t),!0}},e.prototype._coordinateToPoint=function(t,r){var n,s={},l=this.getWidget().getPane(),u=l.getChart(),c=l.getId(),h=u.getChartStore().getTimeScaleStore();if(this.coordinateToPointTimestampDataIndexFlag()){var v=u.getXAxisPane().getAxisComponent().convertFromPixel(r.x),p=(n=h.dataIndexToTimestamp(v))!==null&&n!==void 0?n:void 0;s.dataIndex=v,s.timestamp=p}if(this.coordinateToPointValueFlag()){var f=l.getAxisComponent(),m=f.convertFromPixel(r.y);if(t.mode!==a.OverlayMode.Normal&&c===_e&&s.dataIndex!==void 0){var S=h.getDataByDataIndex(s.dataIndex);if(S!==null){var I=t.modeSensitivity;if(m>S.high)if(t.mode===a.OverlayMode.WeakMagnet){var T=f.convertToPixel(S.high);f.convertFromPixel(T-I)>m&&(m=S.high)}else m=S.high;else if(S.low>m)if(t.mode===a.OverlayMode.WeakMagnet){var E=f.convertToPixel(S.low);m>f.convertFromPixel(E-I)&&(m=S.low)}else m=S.low;else{var P=Math.max(S.open,S.close),M=Math.min(S.open,S.close);m=m>P?S.high-m>m-P?P:S.high:M>m?M-m>m-S.low?S.low:M:m-M>P-m?P:M}}}s.value=m}return s},e.prototype.coordinateToPointValueFlag=function(){return!0},e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},e.prototype.dispatchEvent=function(t,r,n){return this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()?this.onEvent(t,r,n):o.prototype.dispatchEvent.call(this,t,r,n)},e.prototype.checkEventOn=function(){return!0},e.prototype.drawImp=function(t){var r=this,n=this.getWidget(),s=n.getPane(),l=s.getId(),u=s.getChart(),c=s.getAxisComponent(),h=u.getXAxisPane().getAxisComponent(),v=n.getBounding(),p=u.getChartStore(),f=p.getCustomApi(),m=p.getThousandsSeparator(),S=p.getTimeScaleStore(),I=S.getDateTimeFormat(),T=S.getBarSpace(),E=p.getPrecision(),P=p.getStyles().overlay,M=p.getOverlayStore(),A=M.getHoverInstanceInfo(),L=M.getClickInstanceInfo();this.getCompleteOverlays(M,l).forEach(function(V){V.visible&&r._drawOverlay(t,V,v,T,E,I,f,m,P,h,c,A,L,S)});var R=M.getProgressInstanceInfo();if(R!==null){var O=this.getProgressOverlay(R,l);O!==null&&O.visible&&this._drawOverlay(t,O,v,T,E,I,f,m,P,h,c,A,L,S)}},e.prototype._drawOverlay=function(t,r,n,s,l,u,c,h,v,p,f,m,S,I){var T=r.points.map(function(P){var M,A,L=P.dataIndex;P.timestamp!==void 0&&(L=I.timestampToDataIndex(P.timestamp));var R={x:0,y:0};return L!==void 0&&(R.x=(M=p==null?void 0:p.convertToPixel(L))!==null&&M!==void 0?M:0),P.value!==void 0&&(R.y=(A=f==null?void 0:f.convertToPixel(P.value))!==null&&A!==void 0?A:0),R});if(T.length>0){var E=[].concat(this.getFigures(r,T,n,s,l,h,u,v,p,f));this.drawFigures(t,r,E,v)}this.drawDefaultFigures(t,r,T,n,l,u,c,h,v,p,f,m,S)},e.prototype.drawFigures=function(t,r,n,s){var l=this;n.forEach(function(u,c){var h=u.type,v=u.styles,p=u.ignoreEvent;[].concat(u.attrs).forEach(function(f,m){var S,I,T,E=l._createFigureEvents(r,2,(S=u.key)!==null&&S!==void 0?S:"",c,m,p),P=j(j(j({},s[h]),(I=r.styles)===null||I===void 0?void 0:I[h]),v);(T=l.createFigure(h,f,P,E))===null||T===void 0||T.draw(t)})})},e.prototype.getCompleteOverlays=function(t,r){return t.getInstances(r)},e.prototype.getProgressOverlay=function(t,r){return t.paneId===r?t.instance:null},e.prototype.getFigures=function(t,r,n,s,l,u,c,h,v,p){var f,m;return(m=(f=t.createPointFigures)===null||f===void 0?void 0:f.call(t,{overlay:t,coordinates:r,bounding:n,barSpace:s,precision:l,thousandsSeparator:u,dateTimeFormat:c,defaultStyles:h,xAxis:v,yAxis:p}))!==null&&m!==void 0?m:[]},e.prototype.drawDefaultFigures=function(t,r,n,s,l,u,c,h,v,p,f,m,S){var I,T,E=this;if(r.needDefaultPointFigure&&(((I=m.instance)===null||I===void 0?void 0:I.id)===r.id&&m.figureType!==0||((T=S.instance)===null||T===void 0?void 0:T.id)===r.id&&S.figureType!==0)){var P=r.styles,M=j(j({},v.point),P==null?void 0:P.point);n.forEach(function(A,L){var R,O,V,N=A.x,Y=A.y,W=M.radius,G=M.color,X=M.borderColor,K=M.borderSize;((R=m.instance)===null||R===void 0?void 0:R.id)===r.id&&m.figureType===1&&m.figureIndex===L&&(W=M.activeRadius,G=M.activeColor,X=M.activeBorderColor,K=M.activeBorderSize),(O=E.createFigure("circle",{x:N,y:Y,r:W+K},{color:X},E._createFigureEvents(r,1,"".concat(it,"point_").concat(L),L,0)))===null||O===void 0||O.draw(t),(V=E.createFigure("circle",{x:N,y:Y,r:W},{color:G}))===null||V===void 0||V.draw(t)})}},e}(Oe),Bn=function(o){function e(t,r){var n=o.call(this,t,r)||this;return n._gridView=new os(n),n._indicatorView=new ss(n),n._crosshairLineView=new as(n),n._tooltipView=n.createTooltipView(),n._overlayView=new Ln(n),n.addChild(n._tooltipView),n.addChild(n._overlayView),n.getContainer().style.cursor="crosshair",n.registerEvent("mouseMoveEvent",function(){return r.getChart().getChartStore().getTooltipStore().setActiveIcon(),!1}),n}return $(e,o),e.prototype.getName=function(){return me},e.prototype.updateMain=function(t){this.updateMainContent(t),this._indicatorView.draw(t),this._gridView.draw(t)},e.prototype.createTooltipView=function(){return new Fn(this)},e.prototype.updateMainContent=function(t){},e.prototype.updateOverlay=function(t){this._overlayView.draw(t),this._crosshairLineView.draw(t),this._tooltipView.draw(t)},e}(rr),ls=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.drawImp=function(t){var r,n,s=this.getWidget(),l=s.getPane(),u=l.getChart(),c=s.getBounding(),h=l.getAxisComponent(),v=u.getStyles().candle.area,p=[],f=[],m=Number.MAX_SAFE_INTEGER;this.eachChildren(function(A,L,R){var O=A.x,V=L.halfGapBar,N=A.data[v.value];if(se(N)){var Y=h.convertToPixel(N);if(R===0){var W=O-V;f.push({x:W,y:c.height}),f.push({x:W,y:Y}),p.push({x:W,y:Y})}p.push({x:O,y:Y}),f.push({x:O,y:Y}),m=Math.min(m,Y)}});var S=f.length;if(S>0){var I=f[S-1],T=I.x;p.push({x:T,y:I.y}),f.push({x:T,y:I.y}),f.push({x:T,y:c.height})}if(p.length>0&&((r=this.createFigure("line",{coordinates:p},{color:v.lineColor,size:v.lineSize}))===null||r===void 0||r.draw(t)),f.length>0){var E=v.backgroundColor,P=void 0;if(H(E)){var M=t.createLinearGradient(0,c.height,0,m);try{E.forEach(function(A){M.addColorStop(A.offset,A.color)})}catch{}P=M}else P=E;(n=this.createFigure("polygon",{coordinates:f},{color:P}))===null||n===void 0||n.draw(t)}},e}(or),us=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.drawImp=function(t){var r=this.getWidget().getPane(),n=r.getChart().getChartStore(),s=n.getStyles().candle.priceMark,l=s.high,u=s.low;if(s.show&&(l.show||u.show)){var c=n.getThousandsSeparator(),h=n.getPrecision(),v=r.getAxisComponent(),p=Number.MIN_SAFE_INTEGER,f=0,m=Number.MAX_SAFE_INTEGER,S=0;this.eachChildren(function(E){var P=E.data,M=E.x;P.high>p&&(p=P.high,f=M),m>P.low&&(m=P.low,S=M)});var I=v.convertToPixel(p),T=v.convertToPixel(m);l.show&&p!==Number.MIN_SAFE_INTEGER&&this._drawMark(t,ue(ne(p,h.price),c),{x:f,y:I},T>I?[-2,-5]:[2,5],l),u.show&&m!==Number.MAX_SAFE_INTEGER&&this._drawMark(t,ue(ne(m,h.price),c),{x:S,y:T},T>I?[2,5]:[-2,-5],u)}},e.prototype._drawMark=function(t,r,n,s,l){var u,c,h,v,p,f,m=n.x,S=n.y+s[0];(u=this.createFigure("line",{coordinates:[{x:m-2,y:S+s[0]},{x:m,y:S},{x:m+2,y:S+s[0]}]},{color:l.color}))===null||u===void 0||u.draw(t),m>this.getWidget().getBounding().width/2?(p=(v=m-5)-l.textOffset,f="right"):(f="left",p=(v=m+5)+l.textOffset);var I=S+s[1];(c=this.createFigure("line",{coordinates:[{x:m,y:S},{x:m,y:I},{x:v,y:I}]},{color:l.color}))===null||c===void 0||c.draw(t),(h=this.createFigure("text",{x:p,y:I,text:r,align:f,baseline:"middle"},{color:l.color,size:l.textSize,family:l.textFamily,weight:l.textWeight}))===null||h===void 0||h.draw(t)},e}(or),cs=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.drawImp=function(t){var r,n=this.getWidget(),s=n.getPane(),l=n.getBounding(),u=s.getChart().getChartStore(),c=u.getStyles().candle.priceMark,h=c.last,v=h.line;if(c.show&&h.show&&v.show){var p=s.getAxisComponent(),f=u.getDataList(),m=f[f.length-1];if(m!=null){var S=m.close,I=m.open,T=p.convertToNicePixel(S);(r=this.createFigure("line",{coordinates:[{x:0,y:T},{x:l.width,y:T}]},{style:v.style,color:S>I?h.upColor:I>S?h.downColor:h.noChangeColor,size:v.size,dashedValue:v.dashedValue}))===null||r===void 0||r.draw(t)}}},e}(Oe),Ft={"zh-CN":{time:"时间：",open:"开：",high:"高：",low:"低：",close:"收：",volume:"成交量：",turnover:"成交额：",change:"涨幅："},"en-US":{time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",turnover:"Turnover: ",change:"Change: "}},hs=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.drawImp=function(t){var r,n=this.getWidget(),s=n.getPane(),l=s.getId(),u=s.getChart().getChartStore(),c=u.getTooltipStore().getCrosshair();if(c.kLineData!==void 0){var h=n.getBounding(),v=(r=s.getYAxisWidget())===null||r===void 0?void 0:r.getBounding(),p=u.getDataList(),f=u.getPrecision(),m=u.getLocale(),S=u.getCustomApi(),I=u.getThousandsSeparator(),T=u.getTooltipStore().getActiveIcon(),E=u.getIndicatorStore().getInstances(s.getId()),P=u.getTimeScaleStore().getDateTimeFormat(),M=u.getStyles(),A=M.candle,L=M.indicator;if(A.tooltip.showType===a.TooltipShowType.Rect&&L.tooltip.showType===a.TooltipShowType.Rect){var R=this.isDrawTooltip(c,A.tooltip),O=this.isDrawTooltip(c,L.tooltip);this._drawRectTooltip(t,p,E,h,v,c,f,P,m,S,I,R,O,M,0)}else if(A.tooltip.showType===a.TooltipShowType.Standard&&L.tooltip.showType===a.TooltipShowType.Standard){var V=this._drawCandleStandardTooltip(t,p,l,h,c,T,f,P,m,S,I,A);this.drawIndicatorTooltip(t,l,p,c,T,E,S,I,h,L,V)}else if(A.tooltip.showType===a.TooltipShowType.Rect&&L.tooltip.showType===a.TooltipShowType.Standard){var N=this.drawIndicatorTooltip(t,l,p,c,T,E,S,I,h,L,0);R=this.isDrawTooltip(c,A.tooltip),this._drawRectTooltip(t,p,E,h,v,c,f,P,m,S,I,R,!1,M,N)}else{var Y=this._drawCandleStandardTooltip(t,p,l,h,c,T,f,P,m,S,I,A);O=this.isDrawTooltip(c,L.tooltip),this._drawRectTooltip(t,p,E,h,v,c,f,P,m,S,I,!1,O,M,Y)}}},e.prototype._drawCandleStandardTooltip=function(t,r,n,s,l,u,c,h,v,p,f,m){var S,I,T,E=m.tooltip,P=E.text,M=0;if(this.isDrawTooltip(l,E)){var A=(S=l.dataIndex)!==null&&S!==void 0?S:0,L=this._getCandleTooltipData({prev:(I=r[A-1])!==null&&I!==void 0?I:null,current:l.kLineData,next:(T=r[A+1])!==null&&T!==void 0?T:null},c,h,v,p,f,m),R=0,O=0,V=0,N=ge(this.classifyTooltipIcons(E.icons),3),Y=N[1],W=N[2],G=ge(this.drawStandardTooltipIcons(t,s,{paneId:n,indicatorName:"",iconId:""},u,N[0],R,O,0),4);M+=G[3];var X=ge(this.drawStandardTooltipIcons(t,s,{paneId:n,indicatorName:"",iconId:""},u,Y,R=G[0],O=G[1],V=G[2]),4);if(R=X[0],O=X[1],M+=X[3],V=X[2],L.length>0){var K=ge(this.drawStandardTooltipLabels(t,s,L,R,O,V,P),4);R=K[0],O=K[1],M+=K[3],V=K[2]}var J=ge(this.drawStandardTooltipIcons(t,s,{paneId:n,indicatorName:"",iconId:""},u,W,R,O,V),4);R=J[0],O=J[1],M+=J[3],V=J[2]}return M},e.prototype._drawRectTooltip=function(t,r,n,s,l,u,c,h,v,p,f,m,S,I,T){var E,P,M,A,L,R=this,O=I.candle,V=I.indicator,N=O.tooltip,Y=V.tooltip;if(m||S){var W=(E=u.dataIndex)!==null&&E!==void 0?E:0,G=this._getCandleTooltipData({prev:(P=r[W-1])!==null&&P!==void 0?P:null,current:u.kLineData,next:(M=r[W+1])!==null&&M!==void 0?M:null},c,h,v,p,f,O),X=N.text,K=X.marginLeft,J=X.marginRight,ie=X.marginTop,ve=X.marginBottom,ae=X.size,he=X.weight,Ce=X.family,Q=N.rect,le=Q.position,Se=Q.paddingLeft,ye=Q.paddingRight,be=Q.paddingTop,He=Q.paddingBottom,Ie=Q.offsetLeft,Ke=Q.offsetRight,We=Q.offsetTop,Ve=Q.offsetBottom,Pe=Q.borderSize,Ds=Q.borderRadius,ks=Q.borderColor,As=Q.color,_t=0,Je=0,qe=0;m&&(t.font=Ze(ae,he,Ce),G.forEach(function(Ye){var Te=Ye.value,Ee="".concat(Ye.title.text).concat(Te.text),Me=t.measureText(Ee).width+K+J;_t=Math.max(_t,Me)}),qe+=(ve+ie+ae)*G.length);var Qe=Y.text,Xn=Qe.marginLeft,Gn=Qe.marginRight,Un=Qe.marginTop,Zn=Qe.marginBottom,wt=Qe.size,lr=Qe.weight,ur=Qe.family,$n=[];if(S&&(t.font=Ze(wt,lr,ur),n.forEach(function(Ye){var Te,Ee=(Te=R.getIndicatorTooltipData(r,u,Ye,p,f,V).values)!==null&&Te!==void 0?Te:[];$n.push(Ee),Ee.forEach(function(Me){var et=Me.value,Bt="".concat(Me.title.text).concat(et.text),Bs=t.measureText(Bt).width+Xn+Gn;_t=Math.max(_t,Bs),qe+=Un+Zn+wt})})),(Je+=_t)!==0&&qe!==0){Je+=2*Pe+Se+ye,qe+=2*Pe+be+He;var Kn=le===b.Pointer&&u.paneId===_e,Jn=((A=u.realX)!==null&&A!==void 0?A:0)>s.width/2,ze=0;if(Kn){var Qn=u.realX;ze=Jn?Qn-Ke-Je:Qn+Ie}else Jn?(ze=Ie,I.yAxis.inside&&I.yAxis.position===a.YAxisPosition.Left&&(ze+=l.width)):(ze=s.width-Ke-Je,I.yAxis.inside&&I.yAxis.position===a.YAxisPosition.Right&&(ze-=l.width));var st=T+We;Kn&&((st=u.y-qe/2)+qe>s.height-Ve&&(st=s.height-Ve-qe),T+We>st&&(st=T+We)),(L=this.createFigure("rect",{x:ze,y:st,width:Je,height:qe},{style:a.PolygonType.StrokeFill,color:As,borderColor:ks,borderSize:Pe,borderRadius:Ds}))===null||L===void 0||L.draw(t);var Fs=ze+Pe+Se+K,at=st+Pe+be;if(m&&G.forEach(function(Ye){var Te,Ee,Me=Ye.title;(Te=R.createFigure("text",{x:Fs,y:at+=ie,text:Me.text},{color:Me.color,size:ae,family:Ce,weight:he}))===null||Te===void 0||Te.draw(t);var et=Ye.value;(Ee=R.createFigure("text",{x:ze+Je-Pe-J-ye,y:at,text:et.text,align:"right"},{color:et.color,size:ae,family:Ce,weight:he}))===null||Ee===void 0||Ee.draw(t),at+=ae+ve}),S){var Ls=ze+Pe+Se+Xn;$n.forEach(function(Ye){Ye.forEach(function(Te){var Ee,Me,et=Te.title,Bt=Te.value;(Ee=R.createFigure("text",{x:Ls,y:at+=Un,text:et.text},{color:et.color,size:wt,family:ur,weight:lr}))===null||Ee===void 0||Ee.draw(t),(Me=R.createFigure("text",{x:ze+Je-Pe-Gn-ye,y:at,text:Bt.text,align:"right"},{color:Bt.color,size:wt,family:ur,weight:lr}))===null||Me===void 0||Me.draw(t),at+=wt+Zn})})}}}},e.prototype._getCandleTooltipData=function(t,r,n,s,l,u,c){var h,v,p,f,m,S,I=c.tooltip,T=I.text.color,E=t.current,P=(v=(h=t.prev)===null||h===void 0?void 0:h.close)!==null&&v!==void 0?v:E.close,M=E.close-P,A=r.price,L=r.volume,R={"{time}":l.formatDate(n,E.timestamp,"YYYY-MM-DD HH:mm",a.FormatDateType.Tooltip),"{open}":ue(ne(E.open,A),u),"{high}":ue(ne(E.high,A),u),"{low}":ue(ne(E.low,A),u),"{close}":ue(ne(E.close,A),u),"{volume}":ue(l.formatBigNumber(ne((p=E.volume)!==null&&p!==void 0?p:I.defaultValue,L)),u),"{turnover}":ue(ne((f=E.turnover)!==null&&f!==void 0?f:I.defaultValue,A),u),"{change}":P===0?I.defaultValue:"".concat(ne(M/P*100),"%")};return((S=U(I.custom)?(m=I.custom)===null||m===void 0?void 0:m.call(I,t,c):I.custom)!==null&&S!==void 0?S:[{title:"time",value:"{time}"},{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}]).map(function(O){var V,N=O.title,Y=O.value,W={text:"",color:""};Z(N)?W=j({},N):(W.text=N,W.color=T),W.text=function(J,ie){var ve,ae;return(ae=(ve=Ft[ie])===null||ve===void 0?void 0:ve[J])!==null&&ae!==void 0?ae:J}(W.text,s);var G={text:I.defaultValue,color:""};Z(Y)?G=j({},Y):(G.text=Y,G.color=T);var X=G.text.match(/{(\S*)}/);if(X!==null&&X.length>1){var K="{".concat(X[1],"}");G.text=G.text.replace(K,(V=R[K])!==null&&V!==void 0?V:I.defaultValue),K==="{change}"&&(G.color=M===0?c.priceMark.last.noChangeColor:M>0?c.priceMark.last.upColor:c.priceMark.last.downColor)}return{title:W,value:G}})},e}(Fn),ds=function(o){function e(t,r){var n=o.call(this,t,r)||this;return n._candleBarView=new An(n),n._candleAreaView=new ls(n),n._candleHighLowPriceView=new us(n),n._candleLastPriceLineView=new cs(n),n.addChild(n._candleBarView),n}return $(e,o),e.prototype.updateMainContent=function(t){this.getPane().getChart().getStyles().candle.type!==a.CandleType.Area?(this._candleBarView.draw(t),this._candleHighLowPriceView.draw(t)):this._candleAreaView.draw(t),this._candleLastPriceLineView.draw(t)},e.prototype.createTooltipView=function(){return new hs(this)},e}(Bn),Rn=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.drawImp=function(t){var r,n=this,s=this.getWidget(),l=s.getPane(),u=s.getBounding(),c=l.getAxisComponent(),h=this.getAxisStyles(l.getChart().getStyles());if(h.show){h.axisLine.show&&((r=this.createFigure("line",this.createAxisLine(u,h),h.axisLine))===null||r===void 0||r.draw(t));var v=c.getTicks();h.tickLine.show&&this.createTickLines(v,u,h).forEach(function(p){var f;(f=n.createFigure("line",p,h.tickLine))===null||f===void 0||f.draw(t)}),h.tickText.show&&this.createTickTexts(v,u,h).forEach(function(p){var f;(f=n.createFigure("text",p,h.tickText))===null||f===void 0||f.draw(t)})}},e}(Oe),vs=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.getAxisStyles=function(t){return t.yAxis},e.prototype.createAxisLine=function(t,r){var n,s=this.getWidget().getPane().getAxisComponent(),l=r.axisLine.size;return{coordinates:[{x:n=s.isFromZero()?l/2:t.width-l,y:0},{x:n,y:t.height}]}},e.prototype.createTickLines=function(t,r,n){var s=this.getWidget().getPane().getAxisComponent(),l=n.axisLine,u=n.tickLine,c=0,h=0;return s.isFromZero()?(c=0,l.show&&(c+=l.size),h=c+u.length):(c=r.width,l.show&&(c-=l.size),h=c-u.length),t.map(function(v){return{coordinates:[{x:c,y:v.coord},{x:h,y:v.coord}]}})},e.prototype.createTickTexts=function(t,r,n){var s=this.getWidget().getPane().getAxisComponent(),l=n.axisLine,u=n.tickLine,c=n.tickText,h=0;s.isFromZero()?(h=c.marginStart,l.show&&(h+=l.size),u.show&&(h+=u.length)):(h=r.width-c.marginEnd,l.show&&(h-=l.size),u.show&&(h-=u.length));var v=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return t.map(function(p){return{x:h,y:p.coord,text:p.text,align:v,baseline:"middle"}})},e}(Rn),ps=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.drawImp=function(t){var r,n=this.getWidget(),s=n.getPane(),l=n.getBounding(),u=s.getChart().getChartStore(),c=u.getStyles().candle.priceMark,h=c.last,v=h.text;if(c.show&&h.show&&v.show){var p=u.getPrecision(),f=s.getAxisComponent(),m=u.getDataList(),S=u.getVisibleDataList(),I=m[m.length-1];if(I!==void 0){var T=I.close,E=I.open,P=f.convertToNicePixel(T),M=void 0;M=T>E?h.upColor:E>T?h.downColor:h.noChangeColor;var A=void 0;if(f.getType()===a.YAxisType.Percentage){var L=S[0].data.close;A="".concat(((T-L)/L*100).toFixed(2),"%")}else A=ne(T,p.price);A=ue(A,u.getThousandsSeparator());var R=void 0,O=void 0;f.isFromZero()?(R=0,O="left"):(R=l.width,O="right"),(r=this.createFigure("text",{x:R,y:P,text:A,align:O,baseline:"middle"},j(j({},v),{backgroundColor:M})))===null||r===void 0||r.draw(t)}}},e}(Oe),gs=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.drawImp=function(t){var r=this,n=this.getWidget(),s=n.getPane(),l=n.getBounding(),u=s.getChart().getChartStore(),c=u.getCustomApi(),h=u.getStyles().indicator,v=h.lastValueMark,p=v.text;if(v.show){var f=s.getAxisComponent(),m=u.getDataList(),S=m.length-1,I=u.getIndicatorStore().getInstances(s.getId()),T=u.getThousandsSeparator();I.forEach(function(E){var P=E.result[S];if(P!==void 0&&E.visible){var M=E.precision;Kt(m,E,S,h,function(A,L){var R,O=P[A.key];if(q(O)){var V=f.convertToNicePixel(O),N=ne(O,M);E.shouldFormatBigNumber&&(N=c.formatBigNumber(N)),N=ue(N,T);var Y=void 0,W=void 0;f.isFromZero()?(Y=0,W="left"):(Y=l.width,W="right"),(R=r.createFigure("text",{x:Y,y:V,text:N,align:W,baseline:"middle"},j(j({},p),{backgroundColor:L.color})))===null||R===void 0||R.draw(t)}})}})}},e}(Oe),On=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},e.prototype.drawDefaultFigures=function(t,r,n,s,l,u,c,h,v,p,f,m,S){this.drawFigures(t,r,this.getDefaultFigures(r,n,s,l,u,c,h,p,f,S),v)},e.prototype.getDefaultFigures=function(t,r,n,s,l,u,c,h,v,p){var f,m,S=[];if(t.needDefaultYAxisFigure&&t.id===((f=p.instance)===null||f===void 0?void 0:f.id)&&p.paneId===this.getWidget().getPane().getId()){var I,T,E=Number.MAX_SAFE_INTEGER,P=Number.MIN_SAFE_INTEGER;(m=v==null?void 0:v.isFromZero())!==null&&m!==void 0&&m?(I="left",T=0):(I="right",T=n.width),r.forEach(function(M,A){var L=t.points[A];if(L.value!==void 0){E=Math.min(E,M.y),P=Math.max(P,M.y);var R=ue(ne(L.value,s.price),c);S.push({type:"text",attrs:{x:T,y:M.y,text:R,align:I,baseline:"middle"},ignoreEvent:!0})}}),r.length>1&&S.unshift({type:"rect",attrs:{x:0,y:E,width:n.width,height:P-E},ignoreEvent:!0})}return S},e.prototype.getFigures=function(t,r,n,s,l,u,c,h,v,p){var f,m;return(m=(f=t.createYAxisFigures)===null||f===void 0?void 0:f.call(t,{overlay:t,coordinates:r,bounding:n,barSpace:s,precision:l,thousandsSeparator:u,dateTimeFormat:c,defaultStyles:h,xAxis:v,yAxis:p}))!==null&&m!==void 0?m:[]},e}(Ln),Vn=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.drawImp=function(t){var r,n=this.getWidget(),s=n.getPane(),l=n.getBounding(),u=n.getPane().getChart().getChartStore(),c=u.getTooltipStore().getCrosshair(),h=u.getStyles().crosshair;if(c.paneId!==void 0&&this.compare(c,s.getId())&&h.show){var v=this.getDirectionStyles(h),p=v.text;if(v.show&&p.show){var f=s.getAxisComponent(),m=this.getText(c,u,f);t.font=Ze(p.size,p.weight,p.family),(r=this.createFigure("text",this.getTextAttrs(m,t.measureText(m).width,c,l,f,p),p))===null||r===void 0||r.draw(t)}}},e.prototype.compare=function(t,r){return t.paneId===r},e.prototype.getDirectionStyles=function(t){return t.horizontal},e.prototype.getText=function(t,r,n){var s,l,u,c=n,h=n.convertFromPixel(t.y);if(c.getType()===a.YAxisType.Percentage){var v=(l=(s=r.getVisibleDataList()[0])===null||s===void 0?void 0:s.data)!==null&&l!==void 0?l:{};u="".concat(((h-v.close)/v.close*100).toFixed(2),"%")}else{var p=r.getIndicatorStore().getInstances(t.paneId),f=0,m=!1;c.isInCandle()?f=r.getPrecision().price:p.forEach(function(S){f=Math.max(S.precision,f),m||(m=S.shouldFormatBigNumber)}),u=ne(h,f),m&&(u=r.getCustomApi().formatBigNumber(u))}return ue(u,r.getThousandsSeparator())},e.prototype.getTextAttrs=function(t,r,n,s,l,u){var c,h;return l.isFromZero()?(c=0,h="left"):(c=s.width,h="right"),{x:c,y:n.y,text:t,align:h,baseline:"middle"}},e}(Oe),fs=function(o){function e(t,r){var n=o.call(this,t,r)||this;return n._yAxisView=new vs(n),n._candleLastPriceLabelView=new ps(n),n._indicatorLastValueView=new gs(n),n._overlayYAxisView=new On(n),n._crosshairHorizontalLabelView=new Vn(n),n.getContainer().style.cursor="ns-resize",n.addChild(n._overlayYAxisView),n}return $(e,o),e.prototype.getName=function(){return Re},e.prototype.updateMain=function(t){this._yAxisView.draw(t),this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(t),this._indicatorLastValueView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayYAxisView.draw(t),this._crosshairHorizontalLabelView.draw(t)},e}(rr),zn=function(){function o(e){this._extremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._prevExtremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=e}return o.prototype.getParent=function(){return this._parent},o.prototype.buildTicks=function(e){return this._autoCalcTickFlag&&(this._extremum=this.calcExtremum()),!(this._prevExtremum.min===this._extremum.min&&this._prevExtremum.max===this._extremum.max&&!e)&&(this._prevExtremum=this._extremum,this._ticks=this.optimalTicks(this._calcTicks()),!0)},o.prototype.getTicks=function(){return this._ticks},o.prototype.getScrollZoomEnabled=function(){var e;return(e=this.getParent().getOptions().axisOptions.scrollZoomEnabled)===null||e===void 0||e},o.prototype.setExtremum=function(e){this._autoCalcTickFlag=!1,this._extremum=e},o.prototype.getExtremum=function(){return this._extremum},o.prototype.setAutoCalcTickFlag=function(e){this._autoCalcTickFlag=e},o.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},o.prototype._calcTicks=function(){var e=this._extremum,t=e.realMin,r=e.realMax,n=e.realRange,s=[];if(n>=0){var l=ge(this._calcTickInterval(n),2),u=l[0],c=l[1],h=an(Math.ceil(t/u)*u,c),v=an(Math.floor(r/u)*u,c),p=0,f=h;if(u!==0)for(;v>=f;){var m=f.toFixed(c);s[p]={text:m,coord:0,value:m},++p,f+=u}}return s},o.prototype._calcTickInterval=function(e){var t,r,n,s,l=(r=Math.floor(gt(t=e/8)),n=$e(r),t=(1.5>(s=t/n)?1:2.5>s?2:3.5>s?3:4.5>s?4:5.5>s?5:6.5>s?6:8)*n,-20>r?t:+t.toFixed(0>r?-r:0)),u=function(c){var h=""+c,v=h.indexOf("e");if(v>0){var p=+h.slice(v+1);return 0>p?-p:0}var f=h.indexOf(".");return 0>f?0:h.length-1-f}(l);return[l,u]},o}(),ms=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.calcExtremum=function(){var t,r,n,s,l,u=this.getParent(),c=u.getChart(),h=c.getChartStore(),v=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER,f=[],m=!1,S=Number.MAX_SAFE_INTEGER,I=Number.MIN_SAFE_INTEGER,T=Number.MAX_SAFE_INTEGER;h.getIndicatorStore().getInstances(u.getId()).forEach(function(le){var Se,ye,be;m||(m=(Se=le.shouldOhlc)!==null&&Se!==void 0&&Se),T=Math.min(T,le.precision),le.minValue!==null&&(S=Math.min(S,le.minValue)),le.maxValue!==null&&(I=Math.max(I,le.maxValue)),f.push({figures:(ye=le.figures)!==null&&ye!==void 0?ye:[],result:(be=le.result)!==null&&be!==void 0?be:[]})});var E=4,P=this.isInCandle();if(P){var M=h.getPrecision().price;E=T!==Number.MAX_SAFE_INTEGER?Math.min(T,M):M}else T!==Number.MAX_SAFE_INTEGER&&(E=T);var A=h.getVisibleDataList(),L=c.getStyles().candle,R=L.type===a.CandleType.Area,O=L.area.value,V=P&&!R||!P&&m;A.forEach(function(le){var Se=le.dataIndex,ye=le.data;if(V&&(v=Math.min(v,ye.low),p=Math.max(p,ye.high)),P&&R){var be=ye[O];v=Math.min(v,be),p=Math.max(p,be)}f.forEach(function(He){var Ie,Ke=(Ie=He.result[Se])!==null&&Ie!==void 0?Ie:{};He.figures.forEach(function(We){var Ve=Ke[We.key];q(Ve)&&(v=Math.min(v,Ve),p=Math.max(p,Ve))})})}),v!==Number.MAX_SAFE_INTEGER&&p!==Number.MIN_SAFE_INTEGER?(v=Math.min(S,v),p=Math.max(I,p)):(v=0,p=10);var N,Y=this.getType();switch(Y){case a.YAxisType.Percentage:var W=(t=A[0])===null||t===void 0?void 0:t.data;(W==null?void 0:W.close)!==void 0&&(v=(v-W.close)/W.close*100,p=(p-W.close)/W.close*100),N=.01;break;case a.YAxisType.Log:v=gt(v),p=gt(p),N=.05*$e(-E);break;default:N=$e(-E)}if(v===p||N>Math.abs(v-p)){var G=S===v,X=I===p;v=G?v:X?v-8*N:v-4*N,p=X?p:G?p+8*N:p+4*N}var K=(n=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&n!==void 0?n:0,J=u.getOptions().gap,ie=(s=J==null?void 0:J.top)!==null&&s!==void 0?s:.2;1>ie||(ie/=K);var ve=(l=J==null?void 0:J.bottom)!==null&&l!==void 0?l:.1;1>ve||(ve/=K);var ae,he,Ce,Q=Math.abs(p-v);return Q=Math.abs((p+=Q*ie)-(v-=Q*ve)),Y===a.YAxisType.Log?(ae=$e(v),he=$e(p),Ce=Math.abs(he-ae)):(ae=v,he=p,Ce=Q),{min:v,max:p,range:Q,realMin:ae,realMax:he,realRange:Ce}},e.prototype._innerConvertToPixel=function(t){var r,n,s=(n=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&n!==void 0?n:0,l=this.getExtremum(),u=(t-l.min)/l.range;return this.isReverse()?Math.round(u*s):Math.round((1-u)*s)},e.prototype.isInCandle=function(){return this.getParent().getId()===_e},e.prototype.getType=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.type:a.YAxisType.Normal},e.prototype.getPosition=function(){return this.getParent().getChart().getStyles().yAxis.position},e.prototype.isReverse=function(){return!!this.isInCandle()&&this.getParent().getChart().getStyles().yAxis.reverse},e.prototype.isFromZero=function(){var t=this.getParent().getChart().getStyles().yAxis,r=t.inside;return t.position===a.YAxisPosition.Left&&r||t.position===a.YAxisPosition.Right&&!r},e.prototype.optimalTicks=function(t){var r,n,s=this,l=this.getParent(),u=(n=(r=l.getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&n!==void 0?n:0,c=l.getChart().getChartStore(),h=c.getCustomApi(),v=[],p=this.getType(),f=c.getIndicatorStore().getInstances(l.getId()),m=c.getThousandsSeparator(),S=0,I=!1;this.isInCandle()?S=c.getPrecision().price:f.forEach(function(P){S=Math.max(S,P.precision),I||(I=P.shouldFormatBigNumber)});var T,E=c.getStyles().xAxis.tickText.size;return t.forEach(function(P){var M,A=P.value,L=s._innerConvertToPixel(+A);switch(p){case a.YAxisType.Percentage:M="".concat(ne(A,2),"%");break;case a.YAxisType.Log:L=s._innerConvertToPixel(gt(+A)),M=ne(A,S);break;default:M=ne(A,S),I&&(M=h.formatBigNumber(A))}M=ue(M,m),L>E&&u-E>L&&(T!==void 0&&Math.abs(T-L)>2*E||T===void 0)&&(v.push({text:M,coord:L,value:A}),T=L)}),v},e.prototype.getAutoSize=function(){var t=this.getParent(),r=t.getChart(),n=r.getStyles(),s=n.yAxis,l=s.size;if(l!=="auto")return l;var u=r.getChartStore(),c=u.getCustomApi(),h=0;if(s.show&&(s.axisLine.show&&(h+=s.axisLine.size),s.tickLine.show&&(h+=s.tickLine.length),s.tickText.show)){var v=0;this.getTicks().forEach(function(A){v=Math.max(v,pt(A.text,s.tickText.size,s.tickText.weight,s.tickText.family))}),h+=s.tickText.marginStart+s.tickText.marginEnd+v}var p=n.crosshair,f=0;if(p.show&&p.horizontal.show&&p.horizontal.text.show){var m=u.getIndicatorStore().getInstances(t.getId()),S=0,I=!1;m.forEach(function(A){S=Math.max(A.precision,S),I||(I=A.shouldFormatBigNumber)});var T=2;if(this.getType()!==a.YAxisType.Percentage)if(this.isInCandle()){var E=u.getPrecision().price,P=n.indicator.lastValueMark;T=P.show&&P.text.show?Math.max(S,E):E}else T=S;var M=ne(this.getExtremum().max,T);I&&(M=c.formatBigNumber(M)),f+=p.horizontal.text.paddingLeft+p.horizontal.text.paddingRight+2*p.horizontal.text.borderSize+pt(M,p.horizontal.text.size,p.horizontal.text.weight,p.horizontal.text.family)}return Math.max(h,f)},e.prototype.convertFromPixel=function(t){var r,n,s,l=(n=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&n!==void 0?n:0,u=this.getExtremum(),c=u.min,h=u.range,v=(this.isReverse()?t/l:1-t/l)*h+c;switch(this.getType()){case a.YAxisType.Percentage:var p=(s=this.getParent().getChart().getChartStore().getVisibleDataList()[0])===null||s===void 0?void 0:s.data;return(p==null?void 0:p.close)!==void 0?p.close*v/100+p.close:0;case a.YAxisType.Log:return $e(v);default:return v}},e.prototype.convertToRealValue=function(t){var r=t;return this.getType()===a.YAxisType.Log&&(r=$e(t)),r},e.prototype.convertToPixel=function(t){var r,n=t;switch(this.getType()){case a.YAxisType.Percentage:var s=(r=this.getParent().getChart().getChartStore().getVisibleDataList()[0])===null||r===void 0?void 0:r.data;(s==null?void 0:s.close)!==void 0&&(n=(t-s.close)/s.close*100);break;case a.YAxisType.Log:n=gt(t);break;default:n=t}return this._innerConvertToPixel(n)},e.prototype.convertToNicePixel=function(t){var r,n,s=(n=(r=this.getParent().getYAxisWidget())===null||r===void 0?void 0:r.getBounding().height)!==null&&n!==void 0?n:0,l=this.convertToPixel(t);return Math.round(Math.max(.05*s,Math.min(l,.98*s)))},e}(zn),Nn=function(){function o(e,t,r,n){this._bounding=xn(),this._chart=r,this._id=n,this._init(e,t)}return o.prototype._init=function(e,t){this._rootContainer=e,this._container=Le("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),t!==null?e.insertBefore(this._container,t):e.appendChild(this._container)},o.prototype.getContainer=function(){return this._container},o.prototype.getId=function(){return this._id},o.prototype.getChart=function(){return this._chart},o.prototype.getBounding=function(){return this._bounding},o.prototype.update=function(e){this._bounding.height!==this._container.offsetHeight&&(this._container.style.height="".concat(this._bounding.height,"px")),this.updateImp(e??3,this._container,this._bounding)},o.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},o}(),Hn=function(o){function e(t,r,n,s){var l=o.call(this,t,r,n,s)||this;l._yAxisWidget=null,l._axis=l.createAxisComponent(),l._options={minHeight:30,dragEnabled:!0,gap:{top:.2,bottom:.1},axisOptions:{scrollZoomEnabled:!0}};var u=l.getContainer();return l._mainWidget=l.createMainWidget(u),l._yAxisWidget=l.createYAxisWidget(u),l}return $(e,o),e.prototype.setOptions=function(t){var r,n,s,l,u;return B(this._options,t),this.getId()===we?(l=this.getMainWidget().getContainer(),u="ew-resize"):(l=(r=this.getYAxisWidget())===null||r===void 0?void 0:r.getContainer(),u="ns-resize"),l.style.cursor=(s=(n=t.axisOptions)===null||n===void 0?void 0:n.scrollZoomEnabled)===null||s===void 0||s?u:"default",this},e.prototype.getOptions=function(){return this._options},e.prototype.getAxisComponent=function(){return this._axis},e.prototype.setBounding=function(t,r,n){var s,l;B(this.getBounding(),t);var u={};return q(t.height)&&(u.height=t.height),q(t.top)&&(u.top=t.top),this._mainWidget.setBounding(u),(s=this._yAxisWidget)===null||s===void 0||s.setBounding(u),q(r)&&this._mainWidget.setBounding(r),q(n)&&((l=this._yAxisWidget)===null||l===void 0||l.setBounding(n)),this},e.prototype.getMainWidget=function(){return this._mainWidget},e.prototype.getYAxisWidget=function(){return this._yAxisWidget},e.prototype.updateImp=function(t){var r;this._mainWidget.update(t),(r=this._yAxisWidget)===null||r===void 0||r.update(t)},e.prototype.getImage=function(t){var r=this.getBounding(),n=r.width,s=r.height,l=Le("canvas",{width:"".concat(n,"px"),height:"".concat(s,"px"),boxSizing:"border-box"}),u=l.getContext("2d"),c=Ue(l);l.width=n*c,l.height=s*c,u.scale(c,c);var h=this._mainWidget.getBounding();if(u.drawImage(this._mainWidget.getImage(t),h.left,0,h.width,h.height),this._yAxisWidget!==null){var v=this._yAxisWidget.getBounding();u.drawImage(this._yAxisWidget.getImage(t),v.left,0,v.width,v.height)}return l},e.prototype.createYAxisWidget=function(t){return null},e}(Nn),Wn=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.createAxisComponent=function(){return new ms(this)},e.prototype.createMainWidget=function(t){return new Bn(t,this)},e.prototype.createYAxisWidget=function(t){return new fs(t,this)},e}(Hn),ys=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.createMainWidget=function(t){return new ds(t,this)},e}(Wn),xs=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.getAxisStyles=function(t){return t.xAxis},e.prototype.createAxisLine=function(t,r){var n=r.axisLine.size/2;return{coordinates:[{x:0,y:n},{x:t.width,y:n}]}},e.prototype.createTickLines=function(t,r,n){var s=n.tickLine,l=n.axisLine.size;return t.map(function(u){return{coordinates:[{x:u.coord,y:0},{x:u.coord,y:l+s.length}]}})},e.prototype.createTickTexts=function(t,r,n){var s=n.tickText,l=n.axisLine.size,u=n.tickLine.length;return t.map(function(c){return{x:c.coord,y:l+u+s.marginStart,text:c.text,align:"center",baseline:"top"}})},e}(Rn),_s=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},e.prototype.coordinateToPointValueFlag=function(){return!1},e.prototype.getCompleteOverlays=function(t){return t.getInstances()},e.prototype.getProgressOverlay=function(t){return t.instance},e.prototype.getDefaultFigures=function(t,r,n,s,l,u,c,h,v,p){var f,m=[];if(t.needDefaultXAxisFigure&&t.id===((f=p.instance)===null||f===void 0?void 0:f.id)){var S=Number.MAX_SAFE_INTEGER,I=Number.MIN_SAFE_INTEGER;r.forEach(function(T,E){S=Math.min(S,T.x),I=Math.max(I,T.x);var P=t.points[E];if(P.timestamp!==void 0){var M=u.formatDate(l,P.timestamp,"YYYY-MM-DD HH:mm",a.FormatDateType.Crosshair);m.push({type:"text",attrs:{x:T.x,y:0,text:M,align:"center"},ignoreEvent:!0})}}),r.length>1&&m.unshift({type:"rect",attrs:{x:S,y:0,width:I-S,height:n.height},ignoreEvent:!0})}return m},e.prototype.getFigures=function(t,r,n,s,l,u,c,h,v,p){var f,m;return(m=(f=t.createXAxisFigures)===null||f===void 0?void 0:f.call(t,{overlay:t,coordinates:r,bounding:n,barSpace:s,precision:l,thousandsSeparator:u,dateTimeFormat:c,defaultStyles:h,xAxis:v,yAxis:p}))!==null&&m!==void 0?m:[]},e}(On),ws=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.compare=function(t){return t.kLineData!==void 0&&t.dataIndex===t.realDataIndex},e.prototype.getDirectionStyles=function(t){return t.vertical},e.prototype.getText=function(t,r){var n,s=(n=t.kLineData)===null||n===void 0?void 0:n.timestamp;return r.getCustomApi().formatDate(r.getTimeScaleStore().getDateTimeFormat(),s,"YYYY-MM-DD HH:mm",a.FormatDateType.Crosshair)},e.prototype.getTextAttrs=function(t,r,n,s,l,u){var c,h=n.realX,v="center";return 0>h-r/2-u.paddingLeft?(c=0,v="left"):h+r/2+u.paddingRight>s.width?(c=s.width,v="right"):c=h,{x:c,y:0,text:t,align:v,baseline:"top"}},e}(Vn),Cs=function(o){function e(t,r){var n=o.call(this,t,r)||this;return n._xAxisView=new xs(n),n._overlayXAxisView=new _s(n),n._crosshairVerticalLabelView=new ws(n),n.getContainer().style.cursor="ew-resize",n.addChild(n._overlayXAxisView),n}return $(e,o),e.prototype.getName=function(){return Be},e.prototype.updateMain=function(t){this._xAxisView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayXAxisView.draw(t),this._crosshairVerticalLabelView.draw(t)},e}(rr),Ss=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.calcExtremum=function(){var t=this.getParent().getChart().getChartStore().getTimeScaleStore().getVisibleRange(),r=t.from,n=t.to,s=n-1,l=n-r;return{min:r,max:s,range:l,realMin:r,realMax:s,realRange:l}},e.prototype.optimalTicks=function(t){var r,n,s=this.getParent().getChart(),l=s.getChartStore(),u=l.getCustomApi().formatDate,c=[],h=t.length,v=l.getDataList();if(h>0){var p=l.getTimeScaleStore().getDateTimeFormat(),f=s.getStyles().xAxis.tickText,m=pt("00-00 00:00",f.size,f.weight,f.family),S=this.convertToPixel(parseInt(t[0].value,10)),I=1;if(h>1){var T=this.convertToPixel(parseInt(t[1].value,10)),E=Math.abs(T-S);m>E&&(I=Math.ceil(m/E))}for(var P=0;h>P;P+=I){var M=parseInt(t[P].value,10),A=v[M].timestamp,L=u(p,A,"HH:mm",a.FormatDateType.XAxis);P!==0&&(L=(r=this._optimalTickLabel(u,p,A,v[parseInt(t[P-I].value,10)].timestamp))!==null&&r!==void 0?r:L);var R=this.convertToPixel(M);c.push({text:L,coord:R,value:A})}if(c.length===1)c[0].text=u(p,c[0].value,"YYYY-MM-DD HH:mm",a.FormatDateType.XAxis);else{var O=c[0].value,V=c[1].value;if(c[2]!==void 0){var N=c[2].text;/^[0-9]{2}-[0-9]{2}$/.test(N)?c[0].text=u(p,O,"MM-DD",a.FormatDateType.XAxis):/^[0-9]{4}-[0-9]{2}$/.test(N)?c[0].text=u(p,O,"YYYY-MM",a.FormatDateType.XAxis):/^[0-9]{4}$/.test(N)&&(c[0].text=u(p,O,"YYYY",a.FormatDateType.XAxis))}else c[0].text=(n=this._optimalTickLabel(u,p,O,V))!==null&&n!==void 0?n:c[0].text}}return c},e.prototype._optimalTickLabel=function(t,r,n,s){var l=t(r,n,"YYYY",a.FormatDateType.XAxis),u=t(r,n,"YYYY-MM",a.FormatDateType.XAxis),c=t(r,n,"MM-DD",a.FormatDateType.XAxis);return l!==t(r,s,"YYYY",a.FormatDateType.XAxis)?l:u!==t(r,s,"YYYY-MM",a.FormatDateType.XAxis)?u:c!==t(r,s,"MM-DD",a.FormatDateType.XAxis)?c:null},e.prototype.getAutoSize=function(){var t=this.getParent().getChart().getStyles(),r=t.xAxis,n=r.size;if(n!=="auto")return n;var s=t.crosshair,l=0;r.show&&(r.axisLine.show&&(l+=r.axisLine.size),r.tickLine.show&&(l+=r.tickLine.length),r.tickText.show&&(l+=r.tickText.marginStart+r.tickText.marginEnd+r.tickText.size));var u=0;return s.show&&s.vertical.show&&s.vertical.text.show&&(u+=s.vertical.text.paddingTop+s.vertical.text.paddingBottom+2*s.vertical.text.borderSize+s.vertical.text.size),Math.max(l,u)},e.prototype.convertTimestampFromPixel=function(t){var r=this.getParent().getChart().getChartStore().getTimeScaleStore(),n=r.coordinateToDataIndex(t);return r.dataIndexToTimestamp(n)},e.prototype.convertTimestampToPixel=function(t){var r=this.getParent().getChart().getChartStore().getTimeScaleStore(),n=r.timestampToDataIndex(t);return r.dataIndexToCoordinate(n)},e.prototype.convertFromPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(t)},e.prototype.convertToPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(t)},e}(zn),bs=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return $(e,o),e.prototype.createAxisComponent=function(){return new Ss(this)},e.prototype.createMainWidget=function(t){return new Cs(t,this)},e}(Hn);function Yn(){var o;return typeof window<"u"&&((o=window.navigator.userAgent.toLowerCase().indexOf("firefox"))!==null&&o!==void 0?o:-1)>-1}function sr(){return typeof window<"u"&&/iPhone|iPad|iPod/.test(window.navigator.platform)}var Is=function(){function o(e,t,r){var n=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:-1/0,y:1/0},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:-1/0,y:1/0},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!sr(),this._onFirefoxOutsideMouseUp=function(s){n._mouseUpHandler(s)},this._onMobileSafariDoubleClick=function(s){n._firesTouchEvents(s)?(++n._tapCount,n._tapTimeoutId!==null&&n._tapCount>1&&(30>n._mouseTouchMoveWithDownInfo(n._getCoordinate(s),n._tapCoordinate).manhattanDistance&&!n._cancelTap&&n._processEvent(n._makeCompatEvent(s),n._handler.doubleTapEvent),n._resetTapTimeout())):(++n._clickCount,n._clickTimeoutId!==null&&n._clickCount>1&&(5>n._mouseTouchMoveWithDownInfo(n._getCoordinate(s),n._clickCoordinate).manhattanDistance&&!n._cancelClick&&n._processEvent(n._makeCompatEvent(s),n._handler.mouseDoubleClickEvent),n._resetClickTimeout()))},this._target=e,this._handler=t,this._options=r,this._init()}return o.prototype.destroy=function(){this._unsubscribeOutsideMouseEvents!==null&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),this._unsubscribeOutsideTouchEvents!==null&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),this._unsubscribeMousemove!==null&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),this._unsubscribeMouseWheel!==null&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),this._unsubscribeContextMenu!==null&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),this._unsubscribeMobileSafariEvents!==null&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},o.prototype._mouseEnterHandler=function(e){var t,r,n,s=this;(t=this._unsubscribeMousemove)===null||t===void 0||t.call(this),(r=this._unsubscribeMouseWheel)===null||r===void 0||r.call(this),(n=this._unsubscribeContextMenu)===null||n===void 0||n.call(this);var l=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){s._target.removeEventListener("mousemove",l)},this._target.addEventListener("mousemove",l);var u=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){s._target.removeEventListener("wheel",u)},this._target.addEventListener("wheel",u,{passive:!1});var c=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){s._target.removeEventListener("contextmenu",c)},this._target.addEventListener("contextmenu",c,{passive:!1}),this._firesTouchEvents(e)||(this._processEvent(this._makeCompatEvent(e),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},o.prototype._resetClickTimeout=function(){this._clickTimeoutId!==null&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:-1/0,y:1/0}},o.prototype._resetTapTimeout=function(){this._tapTimeoutId!==null&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:-1/0,y:1/0}},o.prototype._mouseMoveHandler=function(e){this._mousePressed||this._touchMoveStartCoordinate!==null||this._firesTouchEvents(e)||(this._processEvent(this._makeCompatEvent(e),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},o.prototype._mouseWheelHandler=function(e){if(Math.abs(e.deltaX)>Math.abs(e.deltaY)){if(this._handler.mouseWheelHortEvent===void 0||(this._preventDefault(e),Math.abs(e.deltaX)===0))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(e),-e.deltaX)}else{if(this._handler.mouseWheelVertEvent===void 0)return;var t=-e.deltaY/100;if(t===0)return;switch(this._preventDefault(e),e.deltaMode){case e.DOM_DELTA_PAGE:t*=120;break;case e.DOM_DELTA_LINE:t*=32}if(t!==0){var r=Math.sign(t)*Math.min(1,Math.abs(t));this._handler.mouseWheelVertEvent(this._makeCompatEvent(e),r)}}},o.prototype._contextMenuHandler=function(e){this._preventDefault(e)},o.prototype._touchMoveHandler=function(e){var t=this._touchWithId(e.changedTouches,this._activeTouchId);if(t!==null&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(e),this._startPinchMiddleCoordinate===null&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var r=this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._touchMoveStartCoordinate),n=r.yOffset;if(this._touchMoveExceededManhattanDistance||r.manhattanDistance>=5){if(!this._touchMoveExceededManhattanDistance){var s=.5*r.xOffset,l=n>=s&&!this._options.treatVertDragAsPageScroll(),u=s>n&&!this._options.treatHorzDragAsPageScroll();l||u||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(e,t),this._handler.touchMoveEvent)}}},o.prototype._mouseMoveWithDownHandler=function(e){e.button===0&&(5>this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._mouseMoveStartCoordinate).manhattanDistance||(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(e),this._handler.pressedMouseMoveEvent))},o.prototype._mouseTouchMoveWithDownInfo=function(e,t){var r=Math.abs(t.x-e.x),n=Math.abs(t.y-e.y);return{xOffset:r,yOffset:n,manhattanDistance:r+n}},o.prototype._touchEndHandler=function(e){var t=this._touchWithId(e.changedTouches,this._activeTouchId);if(t===null&&e.touches.length===0&&(t=e.changedTouches[0]),t!==null){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(e),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var r=this._makeCompatEvent(e,t);this._processEvent(r,this._handler.touchEndEvent),++this._tapCount,this._tapTimeoutId!==null&&this._tapCount>1?(30>this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._tapCoordinate).manhattanDistance&&!this._cancelTap&&this._processEvent(r,this._handler.doubleTapEvent),this._resetTapTimeout()):this._cancelTap||(this._processEvent(r,this._handler.tapEvent),this._handler.tapEvent!==void 0&&this._preventDefault(e)),this._tapCount===0&&this._preventDefault(e),e.touches.length===0&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(e))}},o.prototype._mouseUpHandler=function(e){if(e.button===0){var t=this._makeCompatEvent(e);this._mouseMoveStartCoordinate=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),Yn()&&this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._firesTouchEvents(e)||(this._processEvent(t,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId!==null&&this._clickCount>1?(5>this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._clickCoordinate).manhattanDistance&&!this._cancelClick&&this._processEvent(t,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()):this._cancelClick||this._processEvent(t,this._handler.mouseClickEvent))}},o.prototype._clearLongTapTimeout=function(){this._longTapTimeoutId!==null&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},o.prototype._touchStartHandler=function(e){if(this._activeTouchId===null){var t=e.changedTouches[0];this._activeTouchId=t.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(e);var r=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(t),this._unsubscribeRootTouchEvents!==null&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var n=this._touchMoveHandler.bind(this),s=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){r.removeEventListener("touchmove",n),r.removeEventListener("touchend",s)},r.addEventListener("touchmove",n,{passive:!1}),r.addEventListener("touchend",s,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,e),500),this._processEvent(this._makeCompatEvent(e,t),this._handler.touchStartEvent),this._tapTimeoutId===null&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(t))}},o.prototype._mouseDownHandler=function(e){if(e.button===2)return this._preventDefault(e),void this._processEvent(this._makeCompatEvent(e),this._handler.mouseRightClickEvent);if(e.button===0){var t=this._target.ownerDocument.documentElement;Yn()&&t.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(e),this._unsubscribeRootMouseEvents!==null&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);var r=this._mouseMoveWithDownHandler.bind(this),n=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){t.removeEventListener("mousemove",r),t.removeEventListener("mouseup",n)},t.addEventListener("mousemove",r),t.addEventListener("mouseup",n),this._mousePressed=!0,this._firesTouchEvents(e)||(this._processEvent(this._makeCompatEvent(e),this._handler.mouseDownEvent),this._clickTimeoutId===null&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(e)))}},o.prototype._init=function(){var e=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var t=this._target.ownerDocument,r=function(n){e._handler.mouseDownOutsideEvent!=null&&(n.composed&&e._target.contains(n.composedPath()[0])||n.target!==null&&e._target.contains(n.target)||e._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){t.removeEventListener("touchstart",r)},this._unsubscribeOutsideMouseEvents=function(){t.removeEventListener("mousedown",r)},t.addEventListener("mousedown",r),t.addEventListener("touchstart",r,{passive:!0}),sr()&&(this._unsubscribeMobileSafariEvents=function(){e._target.removeEventListener("dblclick",e._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",function(n){if(n.button===1)return n.preventDefault(),!1}),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",function(){},{passive:!1})},o.prototype._initPinch=function(){var e=this;this._handler.pinchStartEvent===void 0&&this._handler.pinchEvent===void 0&&this._handler.pinchEndEvent===void 0||(this._target.addEventListener("touchstart",function(t){return e._checkPinchState(t.touches)},{passive:!0}),this._target.addEventListener("touchmove",function(t){if(t.touches.length===2&&e._startPinchMiddleCoordinate!==null&&e._handler.pinchEvent!==void 0){var r=e._getTouchDistance(t.touches[0],t.touches[1])/e._startPinchDistance;e._handler.pinchEvent(j(j({},e._startPinchMiddleCoordinate),{pageX:0,pageY:0}),r),e._preventDefault(t)}},{passive:!1}),this._target.addEventListener("touchend",function(t){e._checkPinchState(t.touches)}))},o.prototype._checkPinchState=function(e){e.length===1&&(this._pinchPrevented=!1),e.length!==2||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(e)},o.prototype._startPinch=function(e){var t,r=(t=this._target.getBoundingClientRect())!==null&&t!==void 0?t:{left:0,top:0};this._startPinchMiddleCoordinate={x:(e[0].clientX-r.left+(e[1].clientX-r.left))/2,y:(e[0].clientY-r.top+(e[1].clientY-r.top))/2},this._startPinchDistance=this._getTouchDistance(e[0],e[1]),this._handler.pinchStartEvent!==void 0&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},o.prototype._stopPinch=function(){this._startPinchMiddleCoordinate!==null&&(this._startPinchMiddleCoordinate=null,this._handler.pinchEndEvent!==void 0&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},o.prototype._mouseLeaveHandler=function(e){var t,r,n;(t=this._unsubscribeMousemove)===null||t===void 0||t.call(this),(r=this._unsubscribeMouseWheel)===null||r===void 0||r.call(this),(n=this._unsubscribeContextMenu)===null||n===void 0||n.call(this),this._firesTouchEvents(e)||this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(e),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!sr())},o.prototype._longTapHandler=function(e){var t=this._touchWithId(e.touches,this._activeTouchId);t!==null&&(this._processEvent(this._makeCompatEvent(e,t),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},o.prototype._firesTouchEvents=function(e){var t;return((t=e.sourceCapabilities)===null||t===void 0?void 0:t.firesTouchEvents)!==void 0?e.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(e)<this._lastTouchEventTimeStamp+500},o.prototype._processEvent=function(e,t){t==null||t.call(this._handler,e)},o.prototype._makeCompatEvent=function(e,t){var r,n=this,s=t??e,l=(r=this._target.getBoundingClientRect())!==null&&r!==void 0?r:{left:0,top:0};return{x:s.clientX-l.left,y:s.clientY-l.top,pageX:s.pageX,pageY:s.pageY,isTouch:!e.type.startsWith("mouse")&&e.type!=="contextmenu"&&e.type!=="click",preventDefault:function(){e.type!=="touchstart"&&n._preventDefault(e)}}},o.prototype._getTouchDistance=function(e,t){var r=e.clientX-t.clientX,n=e.clientY-t.clientY;return Math.sqrt(r*r+n*n)},o.prototype._preventDefault=function(e){e.cancelable&&e.preventDefault()},o.prototype._getCoordinate=function(e){return{x:e.pageX,y:e.pageY}},o.prototype._eventTimeStamp=function(e){var t;return(t=e.timeStamp)!==null&&t!==void 0?t:performance.now()},o.prototype._touchWithId=function(e,t){for(var r=0;e.length>r;++r)if(e[r].identifier===t)return e[r];return null},o}(),Ts=function(){function o(e,t){var r=this;this._flingStartTime=new Date().getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(n){if(n.shiftKey)switch(n.code){case"Equal":r._chart.getChartStore().getTimeScaleStore().zoom(.5);break;case"Minus":r._chart.getChartStore().getTimeScaleStore().zoom(-.5);break;case"ArrowLeft":(s=r._chart.getChartStore().getTimeScaleStore()).startScroll(),s.scroll(-3*s.getBarSpace().bar);break;case"ArrowRight":var s;(s=r._chart.getChartStore().getTimeScaleStore()).startScroll(),s.scroll(3*s.getBarSpace().bar)}},this._container=e,this._chart=t,this._event=new Is(e,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),e.addEventListener("keydown",this._boundKeyBoardDownEvent)}return o.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},o.prototype.pinchEvent=function(e,t){var r=this._findWidgetByEvent(e),n=r.pane,s=r.widget;if((n==null?void 0:n.getId())!==we&&(s==null?void 0:s.getName())===me){var l=this._makeWidgetEvent(e,s),u=5*(t-this._pinchScale);return this._pinchScale=t,this._chart.getChartStore().getTimeScaleStore().zoom(u,{x:l.x,y:l.y}),!0}return!1},o.prototype.mouseWheelHortEvent=function(e,t){var r=this._chart.getChartStore().getTimeScaleStore();return r.startScroll(),r.scroll(t),!0},o.prototype.mouseWheelVertEvent=function(e,t){var r,n=this._findWidgetByEvent(e).widget,s=(r=e.isTouch)!==null&&r!==void 0&&r,l=this._makeWidgetEvent(e,n),u=null,c=n==null?void 0:n.getName();if(s)if(c===me||c===Be)u={x:l.x,y:l.y};else{var h=this._chart.getCandlePane().getBounding();u={x:h.width/2,y:h.height/2}}else c===me&&(u={x:l.x,y:l.y});return u!==null&&(this._chart.getChartStore().getTimeScaleStore().zoom(t,{x:l.x,y:l.y}),!0)},o.prototype.mouseDownEvent=function(e){var t,r,n=this._findWidgetByEvent(e),s=n.pane,l=n.widget;if(this._mouseDownWidget=l,l!==null){var u=this._makeWidgetEvent(e,l);switch(l.getName()){case yt:return l.dispatchEvent("mouseDownEvent",u);case me:var c=(t=s.getAxisComponent().getExtremum())!==null&&t!==void 0?t:null;return this._prevYAxisExtremum=c===null?c:j({},c),this._startScrollCoordinate={x:u.x,y:u.y},this._chart.getChartStore().getTimeScaleStore().startScroll(),l.dispatchEvent("mouseDownEvent",u);case Be:return(h=l.dispatchEvent("mouseDownEvent",u))&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:u.x,y:u.y},this._xAxisStartScaleDistance=u.pageX,h;case Re:var h;return(h=l.dispatchEvent("mouseDownEvent",u))&&this._chart.updatePane(1),c=(r=s.getAxisComponent().getExtremum())!==null&&r!==void 0?r:null,this._prevYAxisExtremum=c===null?c:j({},c),this._yAxisStartScaleDistance=u.pageY,h}}return!1},o.prototype.mouseMoveEvent=function(e){var t,r,n,s=this._findWidgetByEvent(e),l=s.pane,u=s.widget,c=this._makeWidgetEvent(e,u);if(((t=this._mouseMoveTriggerWidgetInfo.pane)===null||t===void 0?void 0:t.getId())===(l==null?void 0:l.getId())&&((r=this._mouseMoveTriggerWidgetInfo.widget)===null||r===void 0?void 0:r.getName())===(u==null?void 0:u.getName())||(u==null||u.dispatchEvent("mouseEnterEvent",c),(n=this._mouseMoveTriggerWidgetInfo.widget)===null||n===void 0||n.dispatchEvent("mouseLeaveEvent",c),this._mouseMoveTriggerWidgetInfo={pane:l,widget:u}),u!==null)switch(u.getName()){case me:var h=u.dispatchEvent("mouseMoveEvent",c),v=this._chart.getChartStore(),p={x:c.x,y:c.y,paneId:l==null?void 0:l.getId()};return h&&v.getTooltipStore().getActiveIcon()!==null&&(p=void 0,u!==null&&(u.getContainer().style.cursor="pointer")),this._chart.getChartStore().getTooltipStore().setCrosshair(p),h;case yt:case Be:case Re:return h=u.dispatchEvent("mouseMoveEvent",c),this._chart.getChartStore().getTooltipStore().setCrosshair(),h}return!1},o.prototype.pressedMouseMoveEvent=function(e){var t,r,n,s,l;if(this._mouseDownWidget!==null&&this._mouseDownWidget.getName()===yt)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",e);var u=this._findWidgetByEvent(e),c=u.pane,h=u.widget;if(h!==null&&((t=this._mouseDownWidget)===null||t===void 0?void 0:t.getPane().getId())===(c==null?void 0:c.getId())&&((r=this._mouseDownWidget)===null||r===void 0?void 0:r.getName())===h.getName()){var v=this._makeWidgetEvent(e,h);switch(h.getName()){case me:var p=h.getBounding();if(!(L=h.dispatchEvent("pressedMouseMoveEvent",v))&&this._startScrollCoordinate!==null){var f=c.getAxisComponent();if(this._prevYAxisExtremum!==null&&!f.getAutoCalcTickFlag()&&f.getScrollZoomEnabled()){var m=this._prevYAxisExtremum,S=m.min,I=m.max+(V=(R=m.range)*(O=((n=f==null?void 0:f.isReverse())!==null&&n!==void 0&&n?this._startScrollCoordinate.y-v.y:v.y-this._startScrollCoordinate.y)/p.height)),T=f.convertToRealValue(N=S+V),E=f.convertToRealValue(I);f.setExtremum({min:N,max:I,range:I-N,realMin:T,realMax:E,realRange:E-T})}var P=v.x-this._startScrollCoordinate.x;this._chart.getChartStore().getTimeScaleStore().scroll(P)}return this._chart.getChartStore().getTooltipStore().setCrosshair({x:v.x,y:v.y,paneId:c==null?void 0:c.getId()}),L;case Be:if(L=h.dispatchEvent("pressedMouseMoveEvent",v))this._chart.updatePane(1);else{var M=c.getAxisComponent();if((s=M==null?void 0:M.getScrollZoomEnabled())===null||s===void 0||s){var A=10*((O=this._xAxisStartScaleDistance/v.pageX)-this._xAxisScale);this._xAxisScale=O,this._chart.getChartStore().getTimeScaleStore().zoom(A,(l=this._xAxisStartScaleCoordinate)!==null&&l!==void 0?l:void 0)}}return L;case Re:var L;if(L=h.dispatchEvent("pressedMouseMoveEvent",v))this._chart.updatePane(1);else if(f=c.getAxisComponent(),this._prevYAxisExtremum!==null&&f.getScrollZoomEnabled()){var R,O,V,N,Y=this._prevYAxisExtremum,W=(R=Y.range)*(O=v.pageY/this._yAxisStartScaleDistance);I=Y.max+(V=(W-R)/2),T=f.convertToRealValue(N=(S=Y.min)-V),E=f.convertToRealValue(I),f.setExtremum({min:N,max:I,range:W,realMin:T,realMax:E,realRange:E-T}),this._chart.adjustPaneViewport(!1,!0,!0,!0)}return L}}return!1},o.prototype.mouseUpEvent=function(e){var t=this._findWidgetByEvent(e).widget,r=!1;if(t!==null){var n=this._makeWidgetEvent(e,t);switch(t.getName()){case me:case yt:case Be:case Re:r=t.dispatchEvent("mouseUpEvent",n)}r&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,r},o.prototype.mouseClickEvent=function(e){var t=this._findWidgetByEvent(e).widget;if(t!==null){var r=this._makeWidgetEvent(e,t);return t.dispatchEvent("mouseClickEvent",r)}return!1},o.prototype.mouseRightClickEvent=function(e){var t=this._findWidgetByEvent(e).widget,r=!1;if(t!==null){var n=this._makeWidgetEvent(e,t);switch(t.getName()){case me:case Be:case Re:r=t.dispatchEvent("mouseRightClickEvent",n)}r&&this._chart.updatePane(1)}return!1},o.prototype.mouseDoubleClickEvent=function(e){var t=this._findWidgetByEvent(e),r=t.pane,n=t.widget;if(n!==null)switch(n.getName()){case me:var s=this._makeWidgetEvent(e,n);return n.dispatchEvent("mouseDoubleClickEvent",s);case Re:var l=r.getAxisComponent();if(!l.getAutoCalcTickFlag())return l.setAutoCalcTickFlag(!0),this._chart.adjustPaneViewport(!1,!0,!0,!0),!0}return!1},o.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().getTooltipStore().setCrosshair(),!0},o.prototype.touchStartEvent=function(e){var t=this._findWidgetByEvent(e),r=t.pane,n=t.widget;if(n!==null){var s=this._makeWidgetEvent(e,n);switch(n.getName()){case me:var l=this._chart.getChartStore(),u=l.getTooltipStore();if(n.dispatchEvent("mouseDownEvent",s))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,u.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._flingScrollRequestId!==null&&(At(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=new Date().getTime(),this._startScrollCoordinate={x:s.x,y:s.y},l.getTimeScaleStore().startScroll(),this._touchZoomed=!1,this._touchCoordinate!==null){var c=s.x-this._touchCoordinate.x,h=s.y-this._touchCoordinate.y;10>Math.sqrt(c*c+h*h)?(this._touchCoordinate={x:s.x,y:s.y},u.setCrosshair({x:s.x,y:s.y,paneId:r==null?void 0:r.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,u.setCrosshair())}return!0;case Be:case Re:var v=n.dispatchEvent("mouseDownEvent",s);return v&&this._chart.updatePane(1),v}}return!1},o.prototype.touchMoveEvent=function(e){var t,r,n,s=this._findWidgetByEvent(e),l=s.pane,u=s.widget;if(u!==null){var c=this._makeWidgetEvent(e,u),h=u.getName(),v=this._chart.getChartStore(),p=v.getTooltipStore();switch(h){case me:if(u.dispatchEvent("pressedMouseMoveEvent",c))return(t=c.preventDefault)===null||t===void 0||t.call(c),p.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(this._touchCoordinate!==null)(r=c.preventDefault)===null||r===void 0||r.call(c),p.setCrosshair({x:c.x,y:c.y,paneId:l==null?void 0:l.getId()});else if(this._startScrollCoordinate!==null&&Math.abs(this._startScrollCoordinate.x-c.x)>this._startScrollCoordinate.y-c.y){var f=c.x-this._startScrollCoordinate.x;v.getTimeScaleStore().scroll(f)}return!0;case Be:case Re:var m=u.dispatchEvent("pressedMouseMoveEvent",c);return m&&((n=c.preventDefault)===null||n===void 0||n.call(c),this._chart.updatePane(1)),m}}return!1},o.prototype.touchEndEvent=function(e){var t=this,r=this._findWidgetByEvent(e).widget;if(r!==null){var n=this._makeWidgetEvent(e,r);switch(r.getName()){case me:if(r.dispatchEvent("mouseUpEvent",n),this._startScrollCoordinate!==null){var s=new Date().getTime()-this._flingStartTime,l=(n.x-this._startScrollCoordinate.x)/(s>0?s:1)*20;if(200>s&&Math.abs(l)>0){var u=this._chart.getChartStore().getTimeScaleStore(),c=function(){t._flingScrollRequestId=tr(function(){u.startScroll(),u.scroll(l),1>Math.abs(l*=.975)?t._flingScrollRequestId!==null&&(At(t._flingScrollRequestId),t._flingScrollRequestId=null):c()})};c()}}return!0;case Be:case Re:r.dispatchEvent("mouseUpEvent",n)&&this._chart.updatePane(1)}}return!1},o.prototype.tapEvent=function(e){var t=this._findWidgetByEvent(e),r=t.pane,n=t.widget,s=!1;if(n!==null){var l=this._makeWidgetEvent(e,n),u=n.dispatchEvent("mouseClickEvent",l);if(n.getName()===me){var c=this._makeWidgetEvent(e,n),h=this._chart.getChartStore().getTooltipStore();u?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,h.setCrosshair(void 0,!0),s=!0):(this._touchCancelCrosshair||this._touchZoomed||(this._touchCoordinate={x:c.x,y:c.y},h.setCrosshair({x:c.x,y:c.y,paneId:r==null?void 0:r.getId()},!0),s=!0),this._touchCancelCrosshair=!1)}(s||u)&&this._chart.updatePane(1)}return s},o.prototype.doubleTapEvent=function(e){return this.mouseDoubleClickEvent(e)},o.prototype.longTapEvent=function(e){var t=this._findWidgetByEvent(e),r=t.pane,n=t.widget;if(n!==null&&n.getName()===me){var s=this._makeWidgetEvent(e,n);return this._touchCoordinate={x:s.x,y:s.y},this._chart.getChartStore().getTooltipStore().setCrosshair({x:s.x,y:s.y,paneId:r==null?void 0:r.getId()}),!0}return!1},o.prototype._findWidgetByEvent=function(e){var t,r,n,s,l=e.x,u=e.y,c=this._chart.getAllSeparatorPanes(),h=this._chart.getChartStore().getStyles().separator.size;try{for(var v=Fe(c),p=v.next();!p.done;p=v.next()){var f=ge(p.value,2)[1],m=(P=f.getBounding()).top-Math.round((7-h)/2);if(!(P.left>l||l>P.left+P.width||m>u||u>m+7))return{pane:f,widget:f.getWidget()}}}catch(N){t={error:N}}finally{try{p&&!p.done&&(r=v.return)&&r.call(v)}finally{if(t)throw t.error}}var S=this._chart.getAllDrawPanes(),I=null;try{for(var T=Fe(S),E=T.next();!E.done;E=T.next()){var P,M=E.value;if(!((P=M.getBounding()).left>l||l>P.left+P.width||P.top>u||u>P.top+P.height)){I=M;break}}}catch(N){n={error:N}}finally{try{E&&!E.done&&(s=T.return)&&s.call(T)}finally{if(n)throw n.error}}var A=null;if(I!==null){if(A===null){var L=I.getMainWidget(),R=L.getBounding();R.left>l||l>R.left+R.width||R.top>u||u>R.top+R.height||(A=L)}if(A===null){var O=I.getYAxisWidget();if(O!==null){var V=O.getBounding();V.left>l||l>V.left+V.width||V.top>u||u>V.top+V.height||(A=O)}}}return{pane:I,widget:A}},o.prototype._makeWidgetEvent=function(e,t){var r,n,s,l=(r=t==null?void 0:t.getBounding())!==null&&r!==void 0?r:null;return j(j({},e),{x:e.x-((n=l==null?void 0:l.left)!==null&&n!==void 0?n:0),y:e.y-((s=l==null?void 0:l.top)!==null&&s!==void 0?s:0)})},o.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},o}(),ar,Es=function(o){function e(t,r){var n,s,l,u=o.call(this,t,r)||this;return u._dragFlag=!1,u._dragStartY=0,u._topPaneHeight=0,u._bottomPaneHeight=0,u._pressedMouseMoveEvent=(n=u._pressedTouchMouseMoveEvent,s=20,l=0,function(){var c=Date.now();c-l>(s??20)&&(n.apply(this,arguments),l=c)}),u.registerEvent("touchStartEvent",u._mouseDownEvent.bind(u)).registerEvent("touchMoveEvent",u._pressedMouseMoveEvent.bind(u)).registerEvent("touchEndEvent",u._mouseUpEvent.bind(u)).registerEvent("mouseDownEvent",u._mouseDownEvent.bind(u)).registerEvent("mouseUpEvent",u._mouseUpEvent.bind(u)).registerEvent("pressedMouseMoveEvent",u._pressedMouseMoveEvent.bind(u)).registerEvent("mouseEnterEvent",u._mouseEnterEvent.bind(u)).registerEvent("mouseLeaveEvent",u._mouseLeaveEvent.bind(u)),u}return $(e,o),e.prototype.getName=function(){return yt},e.prototype.checkEventOn=function(){return!0},e.prototype._mouseDownEvent=function(t){this._dragFlag=!0,this._dragStartY=t.pageY;var r=this.getPane();return this._topPaneHeight=r.getTopPane().getBounding().height,this._bottomPaneHeight=r.getBottomPane().getBounding().height,!0},e.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._mouseLeaveEvent()},e.prototype._pressedTouchMouseMoveEvent=function(t){var r=t.pageY-this._dragStartY,n=this.getPane(),s=n.getTopPane(),l=n.getBottomPane(),u=0>r;if(s!==null&&l!==null&&l.getOptions().dragEnabled){var c=void 0,h=void 0,v=void 0,p=void 0;u?(c=s,h=l,v=this._topPaneHeight,p=this._bottomPaneHeight):(c=l,h=s,v=this._bottomPaneHeight,p=this._topPaneHeight);var f=c.getOptions().minHeight;if(v>f){var m=Math.max(v-Math.abs(r),f),S=v-m;c.setBounding({height:m}),h.setBounding({height:p+S});var I=n.getChart();I.getChartStore().getActionStore().execute(a.ActionType.OnPaneDrag,{paneId:n.getId}),I.adjustPaneViewport(!0,!0,!0,!0,!0)}}return!0},e.prototype._mouseEnterEvent=function(){var t,r=this.getPane(),n=r.getBottomPane();if((t=n==null?void 0:n.getOptions().dragEnabled)!==null&&t!==void 0&&t){var s=r.getChart().getStyles().separator;return this.getContainer().style.background=s.activeBackgroundColor,!0}return!1},e.prototype._mouseLeaveEvent=function(){return!this._dragFlag&&(this.getContainer().style.background="",!0)},e.prototype.createContainer=function(){return Le("div",{width:"100%",height:"".concat(7,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"})},e.prototype.updateImp=function(t,r,n){if(n===4||n===2){var s=this.getPane().getChart().getStyles().separator;t.style.top="".concat(-Math.floor((7-s.size)/2),"px"),t.style.height="".concat(7,"px")}},e}(_n),qn=function(o){function e(t,r,n,s,l,u){var c=o.call(this,t,r,n,s)||this;return c.getContainer().style.overflow="",c._topPane=l,c._bottomPane=u,c._separatorWidget=new Es(c.getContainer(),c),c}return $(e,o),e.prototype.setBounding=function(t){return B(this.getBounding(),t),this},e.prototype.getTopPane=function(){return this._topPane},e.prototype.setTopPane=function(t){return this._topPane=t,this},e.prototype.getBottomPane=function(){return this._bottomPane},e.prototype.setBottomPane=function(t){return this._bottomPane=t,this},e.prototype.getWidget=function(){return this._separatorWidget},e.prototype.getImage=function(t){var r=this.getBounding(),n=r.width,s=r.height,l=this.getChart().getStyles().separator,u=Le("canvas",{width:"".concat(n,"px"),height:"".concat(s,"px"),boxSizing:"border-box"}),c=u.getContext("2d"),h=Ue(u);return u.width=n*h,u.height=s*h,c.scale(h,h),c.fillStyle=l.color,c.fillRect(0,0,n,s),u},e.prototype.updateImp=function(t,r,n){if(t===4||t===2){var s=this.getChart().getStyles().separator;r.style.backgroundColor=s.color,r.style.height="".concat(n.height,"px"),r.style.marginLeft="".concat(n.left,"px"),r.style.width="".concat(n.width,"px"),this._separatorWidget.update(t)}},e}(Nn);a.DomPosition=void 0,(ar=a.DomPosition||(a.DomPosition={})).Root="root",ar.Main="main",ar.YAxis="yAxis";var jn=function(){function o(e,t){this._drawPanes=[],this._separatorPanes=new Map,this._initContainer(e),this._chartEvent=new Ts(this._chartContainer,this),this._chartStore=new Qo(this,t),this._initPanes(t),this.adjustPaneViewport(!0,!0,!0)}return o.prototype._initContainer=function(e){this._container=e,this._chartContainer=Le("div",{position:"relative",width:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,e.appendChild(this._chartContainer)},o.prototype._initPanes=function(e){var t,r=this,n=(t=e==null?void 0:e.layout)!==null&&t!==void 0?t:[{type:"candle"}],s=!1,l=!1,u=function(c){if(!l){var h=r._createPane(bs,we,c??{});r._xAxisPane=h,l=!0}};n.forEach(function(c){var h,v,p;switch(c.type){case"candle":if(!s){var f=(h=c.options)!==null&&h!==void 0?h:{};B(f,{id:_e});var m=r._createPane(ys,_e,f);r._candlePane=m,(S=(v=c.content)!==null&&v!==void 0?v:[]).forEach(function(T){r.createIndicator(T,!0,f)}),s=!0}break;case"indicator":var S,I;(S=(p=c.content)!==null&&p!==void 0?p:[]).length>0&&S.forEach(function(T){q(I)?r.createIndicator(T,!0,{id:I}):I=r.createIndicator(T,!0,c.options)});break;case"xAxis":u(c.options)}}),u({position:"bottom"})},o.prototype._createPane=function(e,t,r){var n,s,l;switch(r==null?void 0:r.position){case"top":var u=this._drawPanes[0];q(u)&&(s=new e(this._chartContainer,u.getContainer(),this,t),n=0);break;case"bottom":break;default:for(var c=this._drawPanes.length-1;c>-1;c--){var h=this._drawPanes[c],v=this._drawPanes[c-1];(h==null?void 0:h.getOptions().position)==="bottom"&&(v==null?void 0:v.getOptions().position)!=="bottom"&&(s=new e(this._chartContainer,h.getContainer(),this,t),n=c)}}if(q(s)||(s=new e(this._chartContainer,null,this,t)),s.setOptions(r??{}),q(n)?(this._drawPanes.splice(n,0,s),l=n):(this._drawPanes.push(s),l=this._drawPanes.length-1),s.getId()!==we){var p=this._drawPanes[l+1];q(p)&&p.getId()===we&&(p=this._drawPanes[l+2]),q(p)&&(q(m=this._separatorPanes.get(p))?m.setTopPane(s):(m=new qn(this._chartContainer,p.getContainer(),this,"",s,p),this._separatorPanes.set(p,m)));var f=this._drawPanes[l-1];if(q(f)&&f.getId()===we&&(f=this._drawPanes[l-2]),q(f)){var m=new qn(this._chartContainer,s.getContainer(),this,"",f,s);this._separatorPanes.set(s,m)}}return s},o.prototype._measurePaneHeight=function(){var e,t=this,r=this._container.offsetHeight,n=this._chartStore.getStyles().separator.size,s=this._xAxisPane.getAxisComponent().getAutoSize(),l=r-s-this._separatorPanes.size*n;0>l&&(l=0);var u=0;this._drawPanes.forEach(function(h){if(h.getId()!==_e&&h.getId()!==we){var v=h.getBounding().height,p=h.getOptions().minHeight;p>v&&(v=p),u+v>l?v=Math.max(l-(u=l),0):u+=v,h.setBounding({height:v})}}),(e=this._candlePane)===null||e===void 0||e.setBounding({height:l-u}),this._xAxisPane.setBounding({height:s});var c=0;this._drawPanes.forEach(function(h){var v=t._separatorPanes.get(h);q(v)&&(v.setBounding({height:n,top:c}),c+=n),h.setBounding({top:c}),c+=h.getBounding().height})},o.prototype._measurePaneWidth=function(){var e=this,t=this._chartStore.getStyles(),r=t.yAxis,n=r.position===a.YAxisPosition.Left,s=!r.inside,l=this._container.offsetWidth,u=0,c=Number.MIN_SAFE_INTEGER,h=0,v=0;this._drawPanes.forEach(function(I){I.getId()!==we&&(c=Math.max(c,I.getAxisComponent().getAutoSize()))}),c>l&&(c=l),s?(u=l-c,n?(h=0,v=c):(h=l-c,v=0)):(u=l,v=0,h=n?0:l-c),this._chartStore.getTimeScaleStore().setTotalBarSpace(u);var p,f={width:l},m={width:u,left:v},S={width:c,left:h};p=s&&!t.separator.fill?m:f,this._drawPanes.forEach(function(I){var T;(T=e._separatorPanes.get(I))===null||T===void 0||T.setBounding(p),I.setBounding(f,m,S)})},o.prototype._setPaneOptions=function(e,t){var r;if(oe(e.id)){var n=this.getDrawPaneById(e.id),s=!1;if(n!==null){var l=t;if(e.id!==_e&&e.height!==void 0&&e.height>0){var u=Math.max((r=e.minHeight)!==null&&r!==void 0?r:n.getOptions().minHeight,0);n.setBounding({height:Math.max(u,e.height)}),l=!0,s=!0}n.setOptions(e),l&&this.adjustPaneViewport(s,!0,!0,!0,!0)}}},o.prototype.getDrawPaneById=function(e){if(e===_e)return this._candlePane;if(e===we)return this._xAxisPane;var t=this._drawPanes.find(function(r){return r.getId()===e});return t??null},o.prototype.getContainer=function(){return this._container},o.prototype.getChartStore=function(){return this._chartStore},o.prototype.getCandlePane=function(){return this._candlePane},o.prototype.getXAxisPane=function(){return this._xAxisPane},o.prototype.getAllDrawPanes=function(){return this._drawPanes},o.prototype.getAllSeparatorPanes=function(){return this._separatorPanes},o.prototype.adjustPaneViewport=function(e,t,r,n,s){e&&this._measurePaneHeight();var l=t,u=s!=null&&s;(n!=null&&n||u)&&this._drawPanes.forEach(function(c){var h=c.getAxisComponent().buildTicks(u);l||(l=h)}),l&&this._measurePaneWidth(),r!=null&&r&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4))},o.prototype.updatePane=function(e,t){if(q(t)){var r=this.getDrawPaneById(t);r==null||r.update(e)}else this._separatorPanes.forEach(function(n){n.update(e)}),this._drawPanes.forEach(function(n){n.update(e)})},o.prototype.crosshairChange=function(e){var t=this,r=this._chartStore.getActionStore();if(r.has(a.ActionType.OnCrosshairChange)){var n={};this._drawPanes.forEach(function(s){var l=s.getId(),u={};t._chartStore.getIndicatorStore().getInstances(l).forEach(function(c){var h,v=c.result;u[c.name]=v[(h=e.dataIndex)!==null&&h!==void 0?h:v.length-1]}),n[l]=u}),e.paneId!==void 0&&r.execute(a.ActionType.OnCrosshairChange,j(j({},e),{indicatorData:n}))}},o.prototype.getDom=function(e,t){var r,n;if(!q(e))return this._chartContainer;var s=this.getDrawPaneById(e);if(s!==null)switch(t??a.DomPosition.Root){case a.DomPosition.Root:return s.getContainer();case a.DomPosition.Main:return s.getMainWidget().getContainer();case a.DomPosition.YAxis:return(n=(r=s.getYAxisWidget())===null||r===void 0?void 0:r.getContainer())!==null&&n!==void 0?n:null}return null},o.prototype.getSize=function(e,t){var r,n;if(!q(e))return{width:this._chartContainer.offsetWidth,height:this._chartContainer.offsetHeight,left:0,top:0,right:0,bottom:0};var s=this.getDrawPaneById(e);if(s!==null)switch(t??a.DomPosition.Root){case a.DomPosition.Root:return s.getBounding();case a.DomPosition.Main:return s.getMainWidget().getBounding();case a.DomPosition.YAxis:return(n=(r=s.getYAxisWidget())===null||r===void 0?void 0:r.getBounding())!==null&&n!==void 0?n:null}return null},o.prototype.setStyles=function(e){var t,r,n;this._chartStore.setOptions({styles:e}),q((t=(n=oe(e)?yn(e):e)==null?void 0:n.yAxis)===null||t===void 0?void 0:t.type)&&((r=this._candlePane)===null||r===void 0||r.getAxisComponent().setAutoCalcTickFlag(!0)),this.adjustPaneViewport(!0,!0,!0,!0,!0)},o.prototype.getStyles=function(){return this._chartStore.getStyles()},o.prototype.setLocale=function(e){this._chartStore.setOptions({locale:e}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},o.prototype.getLocale=function(){return this._chartStore.getLocale()},o.prototype.setCustomApi=function(e){this._chartStore.setOptions({customApi:e}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},o.prototype.setPriceVolumePrecision=function(e,t){this._chartStore.setPrecision({price:e,volume:t})},o.prototype.getPriceVolumePrecision=function(){return this._chartStore.getPrecision()},o.prototype.setTimezone=function(e){this._chartStore.setOptions({timezone:e}),this._xAxisPane.getAxisComponent().buildTicks(!0),this._xAxisPane.update(3)},o.prototype.getTimezone=function(){return this._chartStore.getTimeScaleStore().getTimezone()},o.prototype.setOffsetRightDistance=function(e){this._chartStore.getTimeScaleStore().setOffsetRightDistance(e,!0)},o.prototype.getOffsetRightDistance=function(){return this._chartStore.getTimeScaleStore().getOffsetRightDistance()},o.prototype.setLeftMinVisibleBarCount=function(e){e>0&&this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(e))},o.prototype.setRightMinVisibleBarCount=function(e){e>0&&this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(e))},o.prototype.setBarSpace=function(e){this._chartStore.getTimeScaleStore().setBarSpace(e)},o.prototype.getBarSpace=function(){return this._chartStore.getTimeScaleStore().getBarSpace().bar},o.prototype.getVisibleRange=function(){return this._chartStore.getTimeScaleStore().getVisibleRange()},o.prototype.clearData=function(){this._chartStore.clear()},o.prototype.getDataList=function(){return this._chartStore.getDataList()},o.prototype.applyNewData=function(e,t,r){this._chartStore.clear(),e.length===0?this.adjustPaneViewport(!1,!0,!0,!0):this.applyMoreData(e,t,r)},o.prototype.applyMoreData=function(e,t,r){var n=this;this._chartStore.addData(e,0,t),e.length>0&&this._chartStore.getIndicatorStore().calcInstance().then(function(s){n.adjustPaneViewport(!1,!0,!0,!0),r==null||r()}).catch(function(s){})},o.prototype.updateData=function(e,t){var r=this,n=this._chartStore.getDataList(),s=n.length,l=e.timestamp,u=te(n[s-1],"timestamp",0);if(l>=u){var c=s;l===u&&(c=s-1),this._chartStore.addData(e,c),this._chartStore.getIndicatorStore().calcInstance().then(function(h){r.adjustPaneViewport(!1,!0,!0,!0),t==null||t()}).catch(function(h){})}},o.prototype.loadMore=function(e){this._chartStore.getTimeScaleStore().setLoadMoreCallback(e)},o.prototype.createIndicator=function(e,t,r,n){var s,l=this,u=oe(e)?{name:e}:e;if(cn(u.name)===null)return null;var c=r==null?void 0:r.id,h=this.getDrawPaneById(c??"");if(h!==null)this._chartStore.getIndicatorStore().addInstance(u,c??"",t!=null&&t).then(function(f){var m;l._setPaneOptions(r??{},(m=h.getAxisComponent().buildTicks(!0))!==null&&m!==void 0&&m)}).catch(function(f){});else{c!=null||(c=sn($o));var v=this._createPane(Wn,c,r??{}),p=(s=r==null?void 0:r.height)!==null&&s!==void 0?s:100;v.setBounding({height:p}),this._chartStore.getIndicatorStore().addInstance(u,c,t!=null&&t).finally(function(){l.adjustPaneViewport(!0,!0,!0,!0,!0),n==null||n()})}return c??null},o.prototype.overrideIndicator=function(e,t,r){var n=this;this._chartStore.getIndicatorStore().override(e,t??null).then(function(s){var l=ge(s,2),u=l[1];(l[0]||u)&&(n.adjustPaneViewport(!1,u,!0,u),r==null||r())}).catch(function(){})},o.prototype.getIndicatorByPaneId=function(e,t){return this._chartStore.getIndicatorStore().getInstanceByPaneId(e,t)},o.prototype.removeIndicator=function(e,t){var r,n,s,l=this._chartStore.getIndicatorStore();if(l.removeInstance(e,t)){var u=!1;if(e!==_e&&!l.hasInstances(e)){var c=this.getDrawPaneById(e),h=this._drawPanes.findIndex(function(T){return T.getId()===e});if(c!==null){u=!0;var v=this._separatorPanes.get(c);if(q(v)){var p=v==null?void 0:v.getTopPane();try{for(var f=Fe(this._separatorPanes),m=f.next();!m.done;m=f.next()){var S=m.value;if(S[1].getTopPane().getId()===c.getId()){S[1].setTopPane(p);break}}}catch(T){r={error:T}}finally{try{m&&!m.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}v.destroy(),this._separatorPanes.delete(c)}this._drawPanes.splice(h,1),c.destroy();var I=this._drawPanes[0];q(I)&&I.getId()===we&&(I=this._drawPanes[1]),(s=this._separatorPanes.get(I))===null||s===void 0||s.destroy(),this._separatorPanes.delete(I)}}this.adjustPaneViewport(u,!0,!0,!0,!0)}},o.prototype.createOverlay=function(e,t){var r=[];oe(e)?r=[{name:e}]:H(e)?r=e.map(function(l){return oe(l)?{name:l}:l}):r=[e];var n=!0;q(t)&&this.getDrawPaneById(t)!==null||(t=_e,n=!1);var s=this._chartStore.getOverlayStore().addInstances(r,t,n);return H(e)?s:s[0]},o.prototype.getOverlayById=function(e){return this._chartStore.getOverlayStore().getInstanceById(e)},o.prototype.overrideOverlay=function(e){this._chartStore.getOverlayStore().override(e)},o.prototype.removeOverlay=function(e){var t;e!==void 0&&(t=oe(e)?{id:e}:e),this._chartStore.getOverlayStore().removeInstance(t)},o.prototype.setPaneOptions=function(e){this._setPaneOptions(e,!1)},o.prototype.setZoomEnabled=function(e){this._chartStore.getTimeScaleStore().setZoomEnabled(e)},o.prototype.isZoomEnabled=function(){return this._chartStore.getTimeScaleStore().getZoomEnabled()},o.prototype.setScrollEnabled=function(e){this._chartStore.getTimeScaleStore().setScrollEnabled(e)},o.prototype.isScrollEnabled=function(){return this._chartStore.getTimeScaleStore().getScrollEnabled()},o.prototype.scrollByDistance=function(e,t){var r=t===void 0||0>t?0:t,n=this._chartStore.getTimeScaleStore();if(r>0){n.startScroll();var s=new Date().getTime(),l=function(){var u=(new Date().getTime()-s)/r,c=u>=1;n.scroll(c?e:e*u),c||requestAnimationFrame(l)};l()}else n.startScroll(),n.scroll(e)},o.prototype.scrollToRealTime=function(e){var t=this._chartStore.getTimeScaleStore(),r=t.getBarSpace().bar,n=t.getOffsetRightBarCount()-t.getInitialOffsetRightDistance()/r;this.scrollByDistance(n*r,e)},o.prototype.scrollToDataIndex=function(e,t){var r=this._chartStore.getTimeScaleStore(),n=(r.getOffsetRightBarCount()+(this.getDataList().length-1-e))*r.getBarSpace().bar;this.scrollByDistance(n,t)},o.prototype.scrollToTimestamp=function(e,t){var r=Zt(this.getDataList(),"timestamp",e);this.scrollToDataIndex(r,t)},o.prototype.zoomAtCoordinate=function(e,t,r){var n=r===void 0||0>r?0:r,s=this._chartStore.getTimeScaleStore();if(n>0){var l=s.getBarSpace().bar,u=l*e-l,c=new Date().getTime(),h=function(){var v=(new Date().getTime()-c)/n,p=v>=1;s.zoom((p?u:u*v)/l,t),p||requestAnimationFrame(h)};h()}else s.zoom(e,t)},o.prototype.zoomAtDataIndex=function(e,t,r){var n=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(t);this.zoomAtCoordinate(e,{x:n,y:0},r)},o.prototype.zoomAtTimestamp=function(e,t,r){var n=Zt(this.getDataList(),"timestamp",t);this.zoomAtDataIndex(e,n,r)},o.prototype.convertToPixel=function(e,t){var r,n=t.paneId,s=n===void 0?_e:n,l=t.absolute,u=l!==void 0&&l,c=[];if(s!==we){var h=this.getDrawPaneById(s);if(h!==null){var v=this._chartStore.getTimeScaleStore(),p=h.getBounding(),f=[].concat(e),m=this._xAxisPane.getAxisComponent(),S=h.getAxisComponent();c=f.map(function(I){var T={},E=I.dataIndex;if(I.timestamp!==void 0&&(E=v.timestampToDataIndex(I.timestamp)),E!==void 0&&(T.x=m==null?void 0:m.convertToPixel(E)),I.value!==void 0){var P=S==null?void 0:S.convertToPixel(I.value);T.y=u?p.top+P:P}return T})}}return H(e)?c:(r=c[0])!==null&&r!==void 0?r:{}},o.prototype.convertFromPixel=function(e,t){var r,n=t.paneId,s=n===void 0?_e:n,l=t.absolute,u=l!==void 0&&l,c=[];if(s!==we){var h=this.getDrawPaneById(s);if(h!==null){var v=this._chartStore.getTimeScaleStore(),p=h.getBounding(),f=[].concat(e),m=this._xAxisPane.getAxisComponent(),S=h.getAxisComponent();c=f.map(function(I){var T,E,P={};if(I.x!==void 0){var M=(T=m==null?void 0:m.convertFromPixel(I.x))!==null&&T!==void 0?T:-1;P.dataIndex=M,P.timestamp=(E=v.dataIndexToTimestamp(M))!==null&&E!==void 0?E:void 0}return I.y!==void 0&&(P.value=S.convertFromPixel(u?I.y-p.top:I.y)),P})}}return H(e)?c:(r=c[0])!==null&&r!==void 0?r:{}},o.prototype.executeAction=function(e,t){var r;if(e===a.ActionType.OnCrosshairChange){var n=j({},t);n.paneId=(r=n.paneId)!==null&&r!==void 0?r:_e,this._chartStore.getTooltipStore().setCrosshair(n)}},o.prototype.subscribeAction=function(e,t){this._chartStore.getActionStore().subscribe(e,t)},o.prototype.unsubscribeAction=function(e,t){this._chartStore.getActionStore().unsubscribe(e,t)},o.prototype.getConvertPictureUrl=function(e,t,r){var n=this,s=this._chartContainer.offsetWidth,l=this._chartContainer.offsetHeight,u=Le("canvas",{width:"".concat(s,"px"),height:"".concat(l,"px"),boxSizing:"border-box"}),c=u.getContext("2d"),h=Ue(u);u.width=s*h,u.height=l*h,c.scale(h,h),c.fillStyle=r??"#FFFFFF",c.fillRect(0,0,s,l);var v=e!=null&&e;return this._drawPanes.forEach(function(p){var f=n._separatorPanes.get(p);if(q(f)){var m=f.getBounding();c.drawImage(f.getImage(v),m.left,m.top,m.width,m.height)}var S=p.getBounding();c.drawImage(p.getImage(v),0,S.top,s,S.height)}),u.toDataURL("image/".concat(t??"jpeg"))},o.prototype.resize=function(){this.adjustPaneViewport(!0,!0,!0,!0,!0)},o.prototype.destroy=function(){this._chartEvent.destroy(),this._drawPanes.forEach(function(e){e.destroy()}),this._drawPanes=[],this._container.removeChild(this._chartContainer)},o}(),Lt=new Map,Ps=1,Ms={clone:z,merge:B,isString:oe,isNumber:se,isValid:q,isObject:Z,isArray:H,isFunction:U,isBoolean:fe,formatValue:te,formatPrecision:ne,formatBigNumber:vt,formatDate:ke,formatThousands:ue,calcTextWidth:pt,getLinearSlopeIntercept:kt,getLinearYFromSlopeIntercept:er,getLinearYFromCoordinates:ft,checkCoordinateOnArc:Dn,checkCoordinateOnCircle:wn,checkCoordinateOnLine:pn,checkCoordinateOnPolygon:Sn,checkCoordinateOnRect:Tn,checkCoordinateOnText:Pn,drawArc:kn,drawCircle:Cn,drawLine:gn,drawPolygon:bn,drawRect:nr,drawText:ir,drawRectText:ns};a.dispose=function(o){var e,t,r;if(o instanceof jn)r=o.id;else{var n=void 0;r=(e=(n=oe(o)?document.getElementById(o):o)==null?void 0:n.getAttribute("k-line-chart-id"))!==null&&e!==void 0?e:null}r!==null&&((t=Lt.get(r))===null||t===void 0||t.destroy(),Lt.delete(r))},a.getFigureClass=function(o){var e;return(e=xt[o])!==null&&e!==void 0?e:null},a.getOverlayClass=function(o){var e;return(e=mt[o])!==null&&e!==void 0?e:null},a.getSupportedFigures=function(){return Object.keys(xt)},a.getSupportedIndicators=function(){return Object.keys(Dt)},a.getSupportedLocales=function(){return Object.keys(Ft)},a.getSupportedOverlays=function(){return Object.keys(mt)},a.init=function(o,e){var t;if((t=oe(o)?document.getElementById(o):o)===null)return null;var r=Lt.get(t.id);if(r!==void 0)return r;var n="k_line_chart_".concat(Ps++);return(r=new jn(t,e)).id=n,t.setAttribute("k-line-chart-id",n),Lt.set(n,r),r},a.registerFigure=function(o){xt[o.name]=dn.extend(o)},a.registerIndicator=function(o){Dt[o.name]=un.extend(o)},a.registerLocale=function(o,e){Ft[o]=j(j({},Ft[o]),e)},a.registerOverlay=function(o){mt[o.name]=hn.extend(o)},a.registerStyles=function(o,e){mn[o]=e},a.utils=Ms,a.version=function(){return"9.6.0"}})})(fr,fr.exports);var ra=fr.exports;vi.exports=ra;var dr=vi.exports;const ut=[];function Nt(d,i=De){let a;const g=new Set;function w(_){if(mr(d,_)&&(d=_,a)){const b=!ut.length;for(const C of g)C[1](),ut.push(C,d);if(b){for(let C=0;C<ut.length;C+=2)ut[C][0](ut[C+1]);ut.length=0}}}function x(_){w(_(d))}function y(_,b=De){const C=[_,b];return g.add(C),g.size===1&&(a=i(w,x)||De),_(d),()=>{g.delete(C),g.size===0&&a&&(a(),a=null)}}return{set:w,update:x,subscribe:y}}let pi=Nt(0),gi=Nt(0),fi=Nt(0),mi=Nt(!1);async function na(){let d=await fetch("https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=15m"),a=await(await fetch("https://api.coinxgod.com/api/order")).json(),g=await d.json(),w=ia(g);console.log("historyData",w),gi.update(x=>w),fi.update(x=>a),mi.update(x=>!0)}function ia(d){let i=[];for(let a=0;a<d.length;a++){const g=+d[a][4],w=+d[a][2],x=+d[a][3],y=+d[a][1],_=+d[a][0],b=+d[a][5];let C={close:g,high:w,low:x,open:y,timestamp:_,volume:b,index:a};i.push(C)}return console.log("資料讀取完畢"),i}na();function oa(d){let i,a,g;return{c(){i=vr("div"),a=Hs(),g=vr("div"),g.innerHTML="",Ws(i,"id","chart"),ti(i,"width","90dvw"),ti(i,"height","90dvh")},m(w,x){Ot(w,i,x),Ot(w,a,x),Ot(w,g,x)},p:De,i:De,o:De,d(w){w&&(Ct(i),Ct(a),Ct(g))}}}function sa(d,i,a){let g,w,x,y;Rt(d,gi,k=>a(3,g=k)),Rt(d,fi,k=>a(4,w=k)),Rt(d,mi,k=>a(5,x=k)),Rt(d,pi,k=>a(6,y=k));let _=!1,b=!1,C;dr.registerLocale("zh-HK",{time:"時間：",open:"開：",high:"高：",low:"低：",close:"收：",volume:"成交量：",change:"",turnover:""}),js(()=>{console.log("onMount");const k=["🍏","🍎","🍐","🍊","🍋","🍌","🍉","🍇","🍓","🍈","🍒","🍑","🍍","🥥","🥝","🥭","🥑","🍏"];dr.registerIndicator({name:"Custom",figures:[{key:"emoji"}],calc:B=>(console.log("kLineDataList",B),fakerData.map(z=>({emoji:z.close,text:k[Math.floor(Math.random()*17)],timestamp:z.timestamp}))),draw:({ctx:B,barSpace:z,visibleRange:H,indicator:U,xAxis:Z,yAxis:se})=>{console.log("indicator",U),console.log("visibleRange",H),console.log("ctx",B),console.log("barSpace",z),console.log("xAxis",Z),B.font=z.gapBar+"pxHelvetica Neue",B.textAlign="center";const q=U.result;for(let fe=0;fe<q.length;fe++){const oe=q[fe],de=Z.convertToPixel(C.getDataList().findIndex(re=>re.timestamp===oe.timestamp)),xe=se.convertToPixel(oe.emoji);B.fillText(oe.text,de,xe)}return!1}}),a(0,_=!0),window.updateData=C==null?void 0:C.updateData,window.createOverlay=D});function D(k){console.log(k);for(let B=0;B<k.length;B++){let z=k[B].positionSide=="l"?"rgba(122,254,198,1)":"rgba(255,0,0,1)",H=k[B].positionSide=="l"?"rgba(122,254,198,0.3)":"rgba(255,0,0,0.3)";C.createOverlay({name:"priceLine",extendData:+k[B].positionBuy,styles:{line:{style:"dashed",dashedValue:[1,1],color:z,size:2},text:{color:"black",backgroundColor:H}},points:[{timestamp:+k[B].timestamp,value:+k[B].positionBuy}]})}}return d.$$.update=()=>{d.$$.dirty&62&&g!=0&&x&&b==!1&&(console.log("初始化資料",w),a(2,C=dr.init("chart",{locale:"zh-HK"})),C.applyNewData(g),C.createIndicator({name:"VOL",precision:3}),C.createIndicator({name:"MACD",precision:2}),a(1,b=!0)),d.$$.dirty&103&&y!=0&&x==!0&&_&&b==!0&&(console.log("更新數據"),C.updateData(y))},[_,b,C,g,w,x,y]}class aa extends di{constructor(i){super(),hi(this,i,sa,oa,mr,{})}}function la(d){let i,a,g;return a=new aa({}),{c(){i=vr("main"),Js(a.$$.fragment)},m(w,x){Ot(w,i,x),ui(a,i,null),g=!0},p:De,i(w){g||(li(a.$$.fragment,w),g=!0)},o(w){Ks(a.$$.fragment,w),g=!1},d(w){w&&Ct(i),ci(a)}}}class ua extends di{constructor(i){super(),hi(this,i,null,la,mr,{})}}let ca={method:"SUBSCRIBE",params:["btcusdt@kline_15m"],id:1},dt,ha="wss://stream.binance.com:9443/ws/BTCUSDT";dt=new WebSocket(ha);dt.onopen=function(d){console.log("open",d),dt.send(JSON.stringify(ca))};dt.onmessage=async function(d){let i=await JSON.parse(d.data);if(!i.e)return;let a=da(i);pi.update(g=>a)};dt.onclose=function(d){d.wasClean?console.log("關閉",d):alert("[close] Connection died")};dt.onerror=function(d){console.log(d)};function da(d){const i=+d.k.c,a=+d.k.h,g=+d.k.l,w=+d.k.o,x=+d.k.t,y=+d.k.v;return{close:i,high:a,low:g,open:w,timestamp:x,volume:y}}class ii{constructor(i,a,g){this.next=g,g&&(g.prev=this),this.prev=a,a&&(a.next=this),this.data=i}}class yr{constructor(){this._length=0}get head(){return this._head&&this._head.data}get tail(){return this._tail&&this._tail.data}get current(){return this._current&&this._current.data}get length(){return this._length}push(i){this._tail=new ii(i,this._tail),this._length===0&&(this._head=this._tail,this._current=this._head,this._next=this._head),this._length++}pop(){var i=this._tail;if(this._length!==0)return this._length--,this._length===0?(this._head=this._tail=this._current=this._next=void 0,i.data):(this._tail=i.prev,this._tail.next=void 0,this._current===i&&(this._current=this._tail,this._next=void 0),i.data)}shift(){var i=this._head;if(this._length!==0)return this._length--,this._length===0?(this._head=this._tail=this._current=this._next=void 0,i.data):(this._head=this._head.next,this._current===i&&(this._current=this._head,this._next=this._current.next),i.data)}unshift(i){this._head=new ii(i,void 0,this._head),this._length===0&&(this._tail=this._head,this._next=this._head),this._length++}unshiftCurrent(){var i=this._current;return i===this._head||this._length<2?i&&i.data:(i===this._tail?(this._tail=i.prev,this._tail.next=void 0,this._current=this._tail):(i.next.prev=i.prev,i.prev.next=i.next,this._current=i.prev),this._next=this._current.next,i.next=this._head,i.prev=void 0,this._head.prev=i,this._head=i,i.data)}removeCurrent(){var i=this._current;if(this._length!==0)return this._length--,this._length===0?(this._head=this._tail=this._current=this._next=void 0,i.data):(i===this._tail?(this._tail=i.prev,this._tail.next=void 0,this._current=this._tail):i===this._head?(this._head=i.next,this._head.prev=void 0,this._current=this._head):(i.next.prev=i.prev,i.prev.next=i.next,this._current=i.prev),this._next=this._current.next,i.data)}resetCursor(){return this._current=this._next=this._head,this}next(){var i=this._next;if(i!==void 0)return this._next=i.next,this._current=i,i.data}}class pe extends yr{constructor(i,a,g,w){if(super(),this.size=i,this.maintainHigh=a,this.maintainLow=g,this.maintainSum=w,this.totalPushed=0,this.periodHigh=0,this.periodLow=1/0,this.periodSum=0,!i||typeof i!="number")throw"Size required and should be a number.";this._push=this.push,this.push=function(x){this.add(x),this.totalPushed++}}add(i){this.length===this.size?(this.lastShift=this.shift(),this._push(i),this.maintainHigh&&this.lastShift==this.periodHigh&&this.calculatePeriodHigh(),this.maintainLow&&this.lastShift==this.periodLow&&this.calculatePeriodLow(),this.maintainSum&&(this.periodSum=this.periodSum-this.lastShift)):this._push(i),this.maintainHigh&&this.periodHigh<=i&&(this.periodHigh=i),this.maintainLow&&this.periodLow>=i&&(this.periodLow=i),this.maintainSum&&(this.periodSum=this.periodSum+i)}*iterator(){for(this.resetCursor();this.next();)yield this.current}calculatePeriodHigh(){for(this.resetCursor(),this.next()&&(this.periodHigh=this.current);this.next();)this.periodHigh<=this.current&&(this.periodHigh=this.current)}calculatePeriodLow(){for(this.resetCursor(),this.next()&&(this.periodLow=this.current);this.next();)this.periodLow>=this.current&&(this.periodLow=this.current)}}class va{}class xr{constructor(){this.open=[],this.high=[],this.low=[],this.close=[],this.volume=[],this.timestamp=[]}}let yi={};function pa(d,i){yi[d]=i}function xi(d){return yi[d]}function ga(d){let i=xi("precision");return i?parseFloat(d.toPrecision(i)):d}class Ht{}class F{constructor(i){this.format=i.format||ga}static reverseInputs(i){i.reversedInput&&(i.values&&i.values.reverse(),i.open&&i.open.reverse(),i.high&&i.high.reverse(),i.low&&i.low.reverse(),i.close&&i.close.reverse(),i.volume&&i.volume.reverse(),i.timestamp&&i.timestamp.reverse())}getResult(){return this.result}}class ce extends F{constructor(i){super(i),this.period=i.period,this.price=i.values;var a=function*(g){var w=new yr,x=0,y=1,_=yield,b;for(w.push(0);;)y<g?(y++,w.push(_),x=x+_):(x=x-w.shift()+_,b=x/g,w.push(_)),_=yield b};this.generator=a(this.period),this.generator.next(),this.result=[],this.price.forEach(g=>{var w=this.generator.next(g);w.value!==void 0&&this.result.push(this.format(w.value))})}nextValue(i){var a=this.generator.next(i).value;if(a!=null)return this.format(a)}}ce.calculate=_i;function _i(d){F.reverseInputs(d);var i=new ce(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Ne extends F{constructor(i){super(i);var a=i.period,g=i.values,w=2/(a+1),x;this.result=[],x=new ce({period:a,values:[]});var y=function*(){for(var _=yield,b;;)b!==void 0&&_!==void 0?(b=(_-b)*w+b,_=yield b):(_=yield,b=x.nextValue(_),b&&(_=yield b))};this.generator=y(),this.generator.next(),this.generator.next(),g.forEach(_=>{var b=this.generator.next(_);b.value!=null&&this.result.push(this.format(b.value))})}nextValue(i){var a=this.generator.next(i).value;if(a!=null)return this.format(a)}}Ne.calculate=wi;function wi(d){F.reverseInputs(d);var i=new Ne(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class _r extends F{constructor(i){super(i);var a=i.period,g=i.values;this.result=[],this.generator=function*(){let w=new yr,x=a*(a+1)/2;for(;;)if(w.length<a)w.push(yield);else{w.resetCursor();let _=0;for(let b=1;b<=a;b++)_=_+w.next()*b/x;var y=yield _;w.shift(),w.push(y)}}(),this.generator.next(),g.forEach((w,x)=>{var y=this.generator.next(w);y.value!=null&&this.result.push(this.format(y.value))})}nextValue(i){var a=this.generator.next(i).value;if(a!=null)return this.format(a)}}_r.calculate=Ci;function Ci(d){F.reverseInputs(d);var i=new _r(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Tt extends F{constructor(i){super(i);var a=i.period,g=i.values,w=1/a,x;this.result=[],x=new ce({period:a,values:[]});var y=function*(){for(var _=yield,b;;)b!==void 0&&_!==void 0?(b=(_-b)*w+b,_=yield b):(_=yield,b=x.nextValue(_),b!==void 0&&(_=yield b))};this.generator=y(),this.generator.next(),this.generator.next(),g.forEach(_=>{var b=this.generator.next(_);b.value!=null&&this.result.push(this.format(b.value))})}nextValue(i){var a=this.generator.next(i).value;if(a!=null)return this.format(a)}}Tt.calculate=Si;function Si(d){F.reverseInputs(d);var i=new Tt(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class wr extends F{constructor(i){super(i);var a=i.SimpleMAOscillator?ce:Ne,g=i.SimpleMASignal?ce:Ne,w=new a({period:i.fastPeriod,values:[],format:b=>b}),x=new a({period:i.slowPeriod,values:[],format:b=>b}),y=new g({period:i.signalPeriod,values:[],format:b=>b}),_=this.format;this.result=[],this.generator=function*(){for(var b=0,C,D,k,B,z,H;;){if(b<i.slowPeriod){C=yield,z=w.nextValue(C),H=x.nextValue(C),b++;continue}z&&H&&(D=z-H,k=y.nextValue(D)),B=D-k,C=yield{MACD:_(D),signal:k?_(k):void 0,histogram:isNaN(B)?void 0:_(B)},z=w.nextValue(C),H=x.nextValue(C)}}(),this.generator.next(),i.values.forEach(b=>{var C=this.generator.next(b);C.value!=null&&this.result.push(C.value)})}nextValue(i){var a=this.generator.next(i).value;return a}}wr.calculate=bi;function bi(d){F.reverseInputs(d);var i=new wr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Wt extends F{constructor(i){super(i);let a=i.values,g=i.period,w=this.format;this.generator=function*(x){var y=yield,_=1,b=0,C,D,k=y;for(y=yield;;)D=y-k,D=D>0?D:0,D>0&&(b=b+D),_<x?_++:C===void 0?C=b/x:C=(C*(x-1)+D)/x,k=y,C=C!==void 0?w(C):void 0,y=yield C}(g),this.generator.next(),this.result=[],a.forEach(x=>{var y=this.generator.next(x);y.value!==void 0&&this.result.push(y.value)})}nextValue(i){return this.generator.next(i).value}}Wt.calculate=tt;function tt(d){F.reverseInputs(d);var i=new Wt(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Yt extends F{constructor(i){super(i);let a=i.values,g=i.period,w=this.format;this.generator=function*(x){var y=yield,_=1,b=0,C,D,k=y;for(y=yield;;)D=k-y,D=D>0?D:0,D>0&&(b=b+D),_<x?_++:C===void 0?C=b/x:C=(C*(x-1)+D)/x,k=y,C=C!==void 0?w(C):void 0,y=yield C}(g),this.generator.next(),this.result=[],a.forEach(x=>{var y=this.generator.next(x);y.value!==void 0&&this.result.push(y.value)})}nextValue(i){return this.generator.next(i).value}}Yt.calculate=rt;function rt(d){F.reverseInputs(d);var i=new Yt(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class qt extends F{constructor(i){super(i);var a=i.period,g=i.values,w=new Wt({period:a,values:[]}),x=new Yt({period:a,values:[]});this.generator=function*(y){for(var _=yield,b,C,D,k;;)b=w.nextValue(_),C=x.nextValue(_),b!==void 0&&C!==void 0&&(C===0?k=100:b===0?k=0:(D=b/C,D=isNaN(D)?0:D,k=parseFloat((100-100/(1+D)).toFixed(2)))),_=yield k}(),this.generator.next(),this.result=[],g.forEach(y=>{var _=this.generator.next(y);_.value!==void 0&&this.result.push(_.value)})}nextValue(i){return this.generator.next(i).value}}qt.calculate=Ii;function Ii(d){F.reverseInputs(d);var i=new qt(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class jt extends F{constructor(i){super(i);var a=i.period,g=i.values,w=new ce({period:a,values:[],format:x=>x});this.result=[],this.generator=function*(){var x,y,_=new pe(a);x=yield;for(var b;;){if(_.push(x),y=w.nextValue(x),y){let C=0;for(let D of _.iterator())C=C+Math.pow(D-y,2);b=Math.sqrt(C/a)}x=yield b}}(),this.generator.next(),g.forEach(x=>{var y=this.generator.next(x);y.value!=null&&this.result.push(this.format(y.value))})}nextValue(i){var a=this.generator.next(i);if(a.value!=null)return this.format(a.value)}}jt.calculate=Ti;function Ti(d){F.reverseInputs(d);var i=new jt(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Cr extends F{constructor(i){super(i);var a=i.period,g=i.values,w=i.stdDev,x=this.format,y,_;this.result=[],y=new ce({period:a,values:[],format:b=>b}),_=new jt({period:a,values:[],format:b=>b}),this.generator=function*(){var b,C,D,k;for(C=yield;;){if(D=y.nextValue(C),k=_.nextValue(C),D){let B=x(D),z=x(D+k*w),H=x(D-k*w),U=x((C-H)/(z-H));b={middle:B,upper:z,lower:H,pb:U}}C=yield b}}(),this.generator.next(),g.forEach(b=>{var C=this.generator.next(b);C.value!=null&&this.result.push(C.value)})}nextValue(i){return this.generator.next(i).value}}Cr.calculate=Ei;function Ei(d){F.reverseInputs(d);var i=new Cr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class bt extends F{constructor(i){super(i),this.period=i.period,this.price=i.values;var a=function*(g){for(var w=0,x=1,y=yield,_=0;;)x<g?(x++,w=w+y,_=void 0):x==g?(x++,w=w+y,_=w):_=_-_/g+y,y=yield _};this.generator=a(this.period),this.generator.next(),this.result=[],this.price.forEach(g=>{var w=this.generator.next(g);w.value!=null&&this.result.push(this.format(w.value))})}nextValue(i){var a=this.generator.next(i).value;if(a!=null)return this.format(a)}}bt.calculate=fa;function fa(d){F.reverseInputs(d);var i=new bt(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Sr extends F{constructor(i){super(i);var a=i.low,g=i.high,w=this.format;if(a.length!=g.length)throw"Inputs(low,high) not of equal size";this.result=[],this.generator=function*(){for(var x,y=yield,_;;){if(_){let b=y.high-_.high,C=_.low-y.low;x=w(C>b&&C>0?C:0)}_=y,y=yield x}}(),this.generator.next(),a.forEach((x,y)=>{var _=this.generator.next({high:g[y],low:a[y]});_.value!==void 0&&this.result.push(_.value)})}static calculate(i){F.reverseInputs(i);var a=new Sr(i).result;return i.reversedInput&&a.reverse(),F.reverseInputs(i),a}nextValue(i){return this.generator.next(i).value}}class br extends F{constructor(i){super(i);var a=i.low,g=i.high,w=this.format;if(a.length!=g.length)throw"Inputs(low,high) not of equal size";this.result=[],this.generator=function*(){for(var x,y=yield,_;;){if(_){let b=y.high-_.high,C=_.low-y.low;x=w(b>C&&b>0?b:0)}_=y,y=yield x}}(),this.generator.next(),a.forEach((x,y)=>{var _=this.generator.next({high:g[y],low:a[y]});_.value!==void 0&&this.result.push(_.value)})}static calculate(i){F.reverseInputs(i);var a=new br(i).result;return i.reversedInput&&a.reverse(),F.reverseInputs(i),a}nextValue(i){return this.generator.next(i).value}}class Et extends F{constructor(i){super(i);var a=i.low,g=i.high,w=i.close,x=this.format;if(a.length!=g.length)throw"Inputs(low,high) not of equal size";this.result=[],this.generator=function*(){for(var y=yield,_,b;;)_===void 0&&(_=y.close,y=yield b),b=Math.max(y.high-y.low,isNaN(Math.abs(y.high-_))?0:Math.abs(y.high-_),isNaN(Math.abs(y.low-_))?0:Math.abs(y.low-_)),_=y.close,b!=null&&(b=x(b)),y=yield b}(),this.generator.next(),a.forEach((y,_)=>{var b=this.generator.next({high:g[_],low:a[_],close:w[_]});b.value!=null&&this.result.push(b.value)})}nextValue(i){return this.generator.next(i).value}}Et.calculate=Pi;function Pi(d){F.reverseInputs(d);var i=new Et(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Ir extends F{constructor(i){super(i);var a=i.low,g=i.high,w=i.close,x=i.period,y=this.format,_=new br({high:[],low:[]}),b=new Sr({high:[],low:[]}),C=new bt({period:x,values:[],format:H=>H}),D=new bt({period:x,values:[],format:H=>H}),k=new bt({period:x,values:[],format:H=>H}),B=new Tt({period:x,values:[],format:H=>H}),z=new Et({low:[],high:[],close:[]});if(!(a.length===g.length&&g.length===w.length))throw"Inputs(low,high, close) not of equal size";this.result=[],this.generator=function*(){for(var H=yield,U,Z,se,q;;){let fe=z.nextValue(H),oe=_.nextValue(H),de=b.nextValue(H);if(fe===void 0){H=yield;continue}let xe=k.nextValue(fe),re=C.nextValue(oe),te=D.nextValue(de);if(xe!=null&&re!=null&&te!=null){U=re*100/xe,Z=te*100/xe;let ke=Math.abs(U-Z),ne=U+Z;se=ke/ne*100,q=B.nextValue(se)}H=yield{adx:q,pdi:U,mdi:Z}}}(),this.generator.next(),a.forEach((H,U)=>{var Z=this.generator.next({high:g[U],low:a[U],close:w[U]});Z.value!=null&&Z.value.adx!=null&&this.result.push({adx:y(Z.value.adx),pdi:y(Z.value.pdi),mdi:y(Z.value.mdi)})})}nextValue(i){let a=this.generator.next(i).value;if(a!=null&&a.adx!=null)return{adx:this.format(a.adx),pdi:this.format(a.pdi),mdi:this.format(a.mdi)}}}Ir.calculate=Mi;function Mi(d){F.reverseInputs(d);var i=new Ir(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Pt extends F{constructor(i){super(i);var a=i.low,g=i.high,w=i.close,x=i.period,y=this.format;if(!(a.length===g.length&&g.length===w.length))throw"Inputs(low,high, close) not of equal size";var _=new Et({low:[],high:[],close:[]}),b=new Tt({period:x,values:[],format:C=>C});this.result=[],this.generator=function*(){for(var C=yield,D,k;;)k=_.nextValue({low:C.low,high:C.high,close:C.close}),k===void 0?D=void 0:D=b.nextValue(k),C=yield D}(),this.generator.next(),a.forEach((C,D)=>{var k=this.generator.next({high:g[D],low:a[D],close:w[D]});k.value!==void 0&&this.result.push(y(k.value))})}nextValue(i){return this.generator.next(i).value}}Pt.calculate=Tr;function Tr(d){F.reverseInputs(d);var i=new Pt(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class je extends F{constructor(i){super(i);var a=i.period,g=i.values;this.result=[],this.generator=function*(){let w=1;for(var x=new pe(a),y=yield,_;;)x.push(y),w<a?w++:_=(y-x.lastShift)/x.lastShift*100,y=yield _}(),this.generator.next(),g.forEach(w=>{var x=this.generator.next(w);x.value!=null&&!isNaN(x.value)&&this.result.push(this.format(x.value))})}nextValue(i){var a=this.generator.next(i);if(a.value!=null&&!isNaN(a.value))return this.format(a.value)}}je.calculate=Di;function Di(d){F.reverseInputs(d);var i=new je(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Er extends F{constructor(i){super(i);let a=i.values,g=i.ROCPer1,w=i.ROCPer2,x=i.ROCPer3,y=i.ROCPer4,_=i.SMAROCPer1,b=i.SMAROCPer2,C=i.SMAROCPer3,D=i.SMAROCPer4,k=i.signalPeriod,B=new je({period:g,values:[]}),z=new je({period:w,values:[]}),H=new je({period:x,values:[]}),U=new je({period:y,values:[]}),Z=new ce({period:_,values:[],format:re=>re}),se=new ce({period:b,values:[],format:re=>re}),q=new ce({period:C,values:[],format:re=>re}),fe=new ce({period:D,values:[],format:re=>re}),oe=new ce({period:k,values:[],format:re=>re});var de=this.format;this.result=[];let xe=Math.max(g+_,w+b,x+C,y+D);this.generator=function*(){let re=1,te=yield,ke,ne,vt,ue,nt,$,Ae;for(;;){let j=B.nextValue(te),Xe=z.nextValue(te),Ge=H.nextValue(te),Fe=U.nextValue(te);ne=j!==void 0?Z.nextValue(j):void 0,vt=Xe!==void 0?se.nextValue(Xe):void 0,ue=Ge!==void 0?q.nextValue(Ge):void 0,nt=Fe!==void 0?fe.nextValue(Fe):void 0,re<xe?re++:ke=ne*1+vt*2+ue*3+nt*4,$=ke!==void 0?oe.nextValue(ke):void 0,Ae=ke!==void 0?{kst:de(ke),signal:$?de($):void 0}:void 0,te=yield Ae}}(),this.generator.next(),a.forEach(re=>{let te=this.generator.next(re);te.value!=null&&this.result.push(te.value)})}nextValue(i){let a=this.generator.next(i);if(a.value!=null)return a.value}}Er.calculate=ki;function ki(d){F.reverseInputs(d);var i=new Er(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Pr extends F{constructor(i){super(i);let a=i.high||[],g=i.low||[];var w=function*(x,y){let _,b,C,D,k=!0,B=x,z=yield;for(;;)_?(C=C+B*(b-C),k?(C=Math.min(C,D.low,z.low),_.high>b&&(b=_.high,B=Math.min(B+x,y))):(C=Math.max(C,D.high,z.high),_.low<b&&(b=_.low,B=Math.min(B+x,y))),(k&&_.low<C||!k&&_.high>C)&&(B=x,C=b,k=!k,b=k?_.high:_.low)):(C=z.low,b=z.high),D=z,_&&(z=_),_=yield C};this.result=[],this.generator=w(i.step,i.max),this.generator.next(),g.forEach((x,y)=>{var _=this.generator.next({high:a[y],low:g[y]});_.value!==void 0&&this.result.push(_.value)})}nextValue(i){let a=this.generator.next(i);if(a.value!==void 0)return a.value}}Pr.calculate=Ai;function Ai(d){F.reverseInputs(d);var i=new Pr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Xt extends F{constructor(i){super(i);let a=i.low,g=i.high,w=i.close,x=i.period,y=i.signalPeriod,_=this.format;if(!(a.length===g.length&&g.length===w.length))throw"Inputs(low,high, close) not of equal size";this.result=[],this.generator=function*(){let b=1,C=new pe(x,!0,!1),D=new pe(x,!1,!0),k=new ce({period:y,values:[],format:U=>U}),B,z;for(var H=yield;;){if(C.push(H.high),D.push(H.low),b<x){b++,H=yield;continue}let U=D.periodLow;B=(H.close-U)/(C.periodHigh-U)*100,B=isNaN(B)?0:B,z=k.nextValue(B),H=yield{k:_(B),d:z!==void 0?_(z):void 0}}}(),this.generator.next(),a.forEach((b,C)=>{var D=this.generator.next({high:g[C],low:a[C],close:w[C]});D.value!==void 0&&this.result.push(D.value)})}nextValue(i){let a=this.generator.next(i);if(a.value!==void 0)return a.value}}Xt.calculate=Fi;function Fi(d){F.reverseInputs(d);var i=new Xt(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Mr extends F{constructor(i){super(i);let a=i.low,g=i.high,w=i.close,x=i.period,y=this.format;if(!(a.length===g.length&&g.length===w.length))throw"Inputs(low,high, close) not of equal size";this.result=[],this.generator=function*(){let _=1,b=new pe(x,!0,!1),C=new pe(x,!1,!0),D,k;var B=yield;let z;for(;;){if(b.push(B.high),C.push(B.low),_<x){_++,B=yield;continue}D=C.periodLow,k=b.periodHigh,z=y((k-B.close)/(k-D)*-100),B=yield z}}(),this.generator.next(),a.forEach((_,b)=>{var C=this.generator.next({high:g[b],low:a[b],close:w[b]});C.value!==void 0&&this.result.push(C.value)})}nextValue(i){var a=this.generator.next(i);if(a.value!=null)return this.format(a.value)}}Mr.calculate=Li;function Li(d){F.reverseInputs(d);var i=new Mr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Dr extends F{constructor(i){super(i);var a=i.high,g=i.low,w=i.close,x=i.volume;if(!(g.length===a.length&&a.length===w.length&&a.length===x.length))throw"Inputs(low,high, close, volumes) not of equal size";this.result=[],this.generator=function*(){var y=0,_;for(_=yield;;){let b=(_.close-_.low-(_.high-_.close))/(_.high-_.low);b=isNaN(b)?1:b;let C=b*_.volume;y=y+C,_=yield Math.round(y)}}(),this.generator.next(),a.forEach((y,_)=>{var b={high:y,low:g[_],close:w[_],volume:x[_]},C=this.generator.next(b);C.value!=null&&this.result.push(C.value)})}nextValue(i){return this.generator.next(i).value}}Dr.calculate=Bi;function Bi(d){F.reverseInputs(d);var i=new Dr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class kr extends F{constructor(i){super(i);var a=i.close,g=i.volume;this.result=[],this.generator=function*(){var w=0,x,y;for(x=yield,x.close&&typeof x.close=="number"&&(y=x.close,x=yield);;)y<x.close?w=w+x.volume:x.close<y&&(w=w-x.volume),y=x.close,x=yield w}(),this.generator.next(),a.forEach((w,x)=>{let y={close:a[x],volume:g[x]},_=this.generator.next(y);_.value!=null&&this.result.push(_.value)})}nextValue(i){return this.generator.next(i).value}}kr.calculate=Ri;function Ri(d){F.reverseInputs(d);var i=new kr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Ar extends F{constructor(i){super(i);let a=i.values,g=i.period,w=this.format,x=new Ne({period:g,values:[],format:C=>C}),y=new Ne({period:g,values:[],format:C=>C}),_=new Ne({period:g,values:[],format:C=>C}),b=new je({period:1,values:[],format:C=>C});this.result=[],this.generator=function*(){let C=yield;for(;;){let D=x.nextValue(C),k=D?y.nextValue(D):void 0,B=k?_.nextValue(k):void 0,z=B?b.nextValue(B):void 0;C=yield z?w(z):void 0}}(),this.generator.next(),a.forEach(C=>{let D=this.generator.next(C);D.value!==void 0&&this.result.push(D.value)})}nextValue(i){let a=this.generator.next(i);if(a.value!==void 0)return a.value}}Ar.calculate=Oi;function Oi(d){F.reverseInputs(d);var i=new Ar(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Fr extends F{constructor(i){super(i);var a=i.close,g=i.volume,w=i.period||1;if(g.length!==a.length)throw"Inputs(volume, close) not of equal size";let x=new Ne({values:[],period:w});this.result=[],this.generator=function*(){var y=yield,_=yield;let b;for(;;)b=(_.close-y.close)*_.volume,y=_,_=yield x.nextValue(b)}(),this.generator.next(),g.forEach((y,_)=>{var b=this.generator.next({close:a[_],volume:g[_]});b.value!=null&&this.result.push(b.value)})}nextValue(i){let a=this.generator.next(i).value;if(a!=null)return a}}Fr.calculate=Vi;function Vi(d){F.reverseInputs(d);var i=new Fr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Lr extends F{constructor(i){super(i);var a=i.low,g=i.high,w=i.close,x=i.period;this.format;let y=.015;var _=new pe(x),b=new ce({period:x,values:[],format:C=>C});if(!(a.length===g.length&&g.length===w.length))throw"Inputs(low,high, close) not of equal size";this.result=[],this.generator=function*(){for(var C=yield;;){let D=(C.high+C.low+C.close)/3;_.push(D);let k=b.nextValue(D),B=null,z,H=0;if(k!=null){for(let U of _.iterator())H=H+Math.abs(U-k);B=H/x,z=(D-k)/(y*B)}C=yield z}}(),this.generator.next(),a.forEach((C,D)=>{var k=this.generator.next({high:g[D],low:a[D],close:w[D]});k.value!=null&&this.result.push(k.value)})}nextValue(i){let a=this.generator.next(i).value;if(a!=null)return a}}Lr.calculate=zi;function zi(d){F.reverseInputs(d);var i=new Lr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Br extends F{constructor(i){super(i);var a=i.high,g=i.low,w=i.fastPeriod,x=i.slowPeriod,y=new ce({values:[],period:x}),_=new ce({values:[],period:w});this.result=[],this.generator=function*(){var b,C,D,k,B;for(C=yield;;)D=(C.high+C.low)/2,k=y.nextValue(D),B=_.nextValue(D),k!==void 0&&B!==void 0&&(b=B-k),C=yield b}(),this.generator.next(),a.forEach((b,C)=>{var D={high:b,low:g[C]},k=this.generator.next(D);k.value!=null&&this.result.push(this.format(k.value))})}nextValue(i){var a=this.generator.next(i);if(a.value!=null)return this.format(a.value)}}Br.calculate=Ni;function Ni(d){F.reverseInputs(d);var i=new Br(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Rr extends F{constructor(i){super(i);var a=i.low,g=i.high,w=i.close,x=i.volume;if(this.format,!(a.length===g.length&&g.length===w.length))throw"Inputs(low,high, close) not of equal size";this.result=[],this.generator=function*(){var y=yield;let _=0,b=0;for(;;){let C=(y.high+y.low+y.close)/3,D=y.volume*C;_=_+D,b=b+y.volume,y=yield _/b}}(),this.generator.next(),a.forEach((y,_)=>{var b=this.generator.next({high:g[_],low:a[_],close:w[_],volume:x[_]});b.value!=null&&this.result.push(b.value)})}nextValue(i){let a=this.generator.next(i).value;if(a!=null)return a}}Rr.calculate=Hi;function Hi(d){F.reverseInputs(d);var i=new Rr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}function ma(d,i,a,g){return d<=a&&i>=a||a<=d&&g>=d}class Or extends F{constructor(i){super(i);var a=i.high,g=i.low,w=i.close,x=i.open,y=i.volume,_=i.noOfBars;if(!(g.length===a.length&&a.length===w.length&&a.length===y.length))throw"Inputs(low,high, close, volumes) not of equal size";this.result=[];var b=Math.max(...a,...g,...w,...x),C=Math.min(...a,...g,...w,...x),D=(b-C)/_,k=C;for(let B=0;B<_;B++){let z=k,H=z+D;k=H;let U=0,Z=0,se=0;for(let q=0;q<a.length;q++){let fe=g[q],oe=a[q],de=x[q],xe=w[q],re=y[q];ma(z,H,fe,oe)&&(se=se+re,de>xe?Z=Z+re:U=U+re)}this.result.push({rangeStart:z,rangeEnd:H,bullishVolume:U,bearishVolume:Z,totalVolume:se})}}nextValue(i){throw"Next value not supported for volume profile"}}Or.calculate=Wi;function Wi(d){F.reverseInputs(d);var i=new Or(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Vr extends F{constructor(i){super(i),this.result=[],this.generator=function*(){let a=yield;for(;;)a=yield(a.high+a.low+a.close)/3}(),this.generator.next(),i.low.forEach((a,g)=>{var w=this.generator.next({high:i.high[g],low:i.low[g],close:i.close[g]});this.result.push(w.value)})}nextValue(i){var a=this.generator.next(i).value;return a}}Vr.calculate=ya;function ya(d){F.reverseInputs(d);var i=new Vr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class zr extends F{constructor(i){super(i);var a=i.high,g=i.low,w=i.close,x=i.volume,y=i.period,_=new Vr({low:[],high:[],close:[]}),b=new pe(y,!1,!1,!0),C=new pe(y,!1,!1,!0);if(!(g.length===a.length&&a.length===w.length&&a.length===x.length))throw"Inputs(low,high, close, volumes) not of equal size";this.result=[],this.generator=function*(){var D,k,B,z=0,H,U;let Z=null,se=null;for(k=yield,k.close,k=yield;;){var{high:q,low:fe,close:oe,volume:de}=k,xe=0,re=0;Z=_.nextValue({high:q,low:fe,close:oe}),z=Z*de,Z!=null&&se!=null&&(Z>se?xe=z:re=z,b.push(xe),C.push(re),B=b.periodSum,U=C.periodSum,b.totalPushed>=y&&b.totalPushed>=y&&(H=B/U,D=100-100/(1+H))),se=Z,k=yield D}}(),this.generator.next(),a.forEach((D,k)=>{var B={high:D,low:g[k],close:w[k],volume:x[k]},z=this.generator.next(B);z.value!=null&&this.result.push(parseFloat(z.value.toFixed(2)))})}nextValue(i){var a=this.generator.next(i);if(a.value!=null)return parseFloat(a.value.toFixed(2))}}zr.calculate=Yi;function Yi(d){F.reverseInputs(d);var i=new zr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Nr extends F{constructor(i){super(i);let a=i.values,g=i.rsiPeriod,w=i.stochasticPeriod,x=i.kPeriod,y=i.dPeriod;this.format,this.result=[],this.generator=function*(){let _=new qt({period:g,values:[]}),b=new Xt({period:w,high:[],low:[],close:[],signalPeriod:x}),C=new ce({period:y,values:[],format:Z=>Z}),D,k,B,z;for(var H=yield;;){if(D=_.nextValue(H),D!==void 0){var U={high:D,low:D,close:D};k=b.nextValue(U),k!==void 0&&k.d!==void 0&&(B=C.nextValue(k.d),B!==void 0&&(z={stochRSI:k.k,k:k.d,d:B}))}H=yield z}}(),this.generator.next(),a.forEach((_,b)=>{var C=this.generator.next(_);C.value!==void 0&&this.result.push(C.value)})}nextValue(i){let a=this.generator.next(i);if(a.value!==void 0)return a.value}}Nr.calculate=qi;function qi(d){F.reverseInputs(d);var i=new Nr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Hr extends F{constructor(i){super(i);var a=i.values,g=i.period;this.result=[];var w=new pe(g,!0,!1,!1);this.generator=function*(){var x,y;for(x=yield;;)w.push(x),w.totalPushed>=g&&(y=w.periodHigh),x=yield y}(),this.generator.next(),a.forEach((x,y)=>{var _=this.generator.next(x);_.value!=null&&this.result.push(_.value)})}nextValue(i){var a=this.generator.next(i);if(a.value!=null)return a.value}}Hr.calculate=ji;function ji(d){F.reverseInputs(d);var i=new Hr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Wr extends F{constructor(i){super(i);var a=i.values,g=i.period;this.result=[];var w=new pe(g,!1,!0,!1);this.generator=function*(){var x,y;for(x=yield;;)w.push(x),w.totalPushed>=g&&(y=w.periodLow),x=yield y}(),this.generator.next(),a.forEach((x,y)=>{var _=this.generator.next(x);_.value!=null&&this.result.push(_.value)})}nextValue(i){var a=this.generator.next(i);if(a.value!=null)return a.value}}Wr.calculate=Xi;function Xi(d){F.reverseInputs(d);var i=new Wr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Yr extends F{constructor(i){super(i);var a=i.values,g=i.period;this.result=[];var w=new pe(g,!1,!1,!0);this.generator=function*(){var x,y;for(x=yield;;)w.push(x),w.totalPushed>=g&&(y=w.periodSum),x=yield y}(),this.generator.next(),a.forEach((x,y)=>{var _=this.generator.next(x);_.value!=null&&this.result.push(_.value)})}nextValue(i){var a=this.generator.next(i);if(a.value!=null)return a.value}}Yr.calculate=Gi;function Gi(d){F.reverseInputs(d);var i=new Yr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class Ui extends F{constructor(i){super(i),this.format;let a=i.useATR,g=i.brickSize||0;if(a){let C=Tr(Object.assign({},i));g=C[C.length-1]}if(this.result=new xr,g===0){console.error("Not enough data to calculate brickSize for renko when using ATR");return}let w=0,x=0,y=1/0,_=0,b=0;this.generator=function*(){let C=yield;for(;;){if(w===0){w=C.close,x=C.high,y=C.low,_=C.close,b=C.volume,C.timestamp,C=yield;continue}let D=Math.abs(C.close-_),k=Math.abs(C.close-w);if(D>=g&&k>=g){let B=D>k?w:_,z={open:B,high:x>C.high?x:C.high,low:y<C.Low?y:C.low,close:B>C.close?B-g:B+g,volume:b+C.volume,timestamp:C.timestamp};w=z.open,x=z.close,y=z.close,_=z.close,b=0,C=yield z}else x=x>C.high?x:C.high,y=y<C.Low?y:C.low,b=b+C.volume,C.timestamp,C=yield}}(),this.generator.next(),i.low.forEach((C,D)=>{var k=this.generator.next({open:i.open[D],high:i.high[D],low:i.low[D],close:i.close[D],volume:i.volume[D],timestamp:i.timestamp[D]});k.value&&(this.result.open.push(k.value.open),this.result.high.push(k.value.high),this.result.low.push(k.value.low),this.result.close.push(k.value.close),this.result.volume.push(k.value.volume),this.result.timestamp.push(k.value.timestamp))})}nextValue(i){return console.error("Cannot calculate next value on Renko, Every value has to be recomputed for every change, use calcualte method"),null}}Ui.calculate=Zi;function Zi(d){F.reverseInputs(d);var i=new Ui(d).result;return d.reversedInput&&(i.open.reverse(),i.high.reverse(),i.low.reverse(),i.close.reverse(),i.volume.reverse(),i.timestamp.reverse()),F.reverseInputs(d),i}class qr extends F{constructor(i){super(i),this.format,this.result=new xr;let a=null,g=0,w=1/0,x=0;this.generator=function*(){let y=yield,_=null;for(;;){if(a===null)a=(y.close+y.open)/2,g=y.high,w=y.low,x=(y.close+y.open+y.high+y.low)/4,y.volume,y.timestamp,_={open:a,high:g,low:w,close:x,volume:y.volume||0,timestamp:y.timestamp||0};else{let b=(y.close+y.open+y.high+y.low)/4,C=(a+x)/2,D=Math.max(C,b,y.high),k=Math.min(y.low,C,b);_={close:b,open:C,high:D,low:k,volume:y.volume||0,timestamp:y.timestamp||0},x=b,a=C,g=D,w=k}y=yield _}}(),this.generator.next(),i.low.forEach((y,_)=>{var b=this.generator.next({open:i.open[_],high:i.high[_],low:i.low[_],close:i.close[_],volume:i.volume?i.volume[_]:i.volume,timestamp:i.timestamp?i.timestamp[_]:i.timestamp});b.value&&(this.result.open.push(b.value.open),this.result.high.push(b.value.high),this.result.low.push(b.value.low),this.result.close.push(b.value.close),this.result.volume.push(b.value.volume),this.result.timestamp.push(b.value.timestamp))})}nextValue(i){var a=this.generator.next(i).value;return a}}qr.calculate=$i;function $i(d){F.reverseInputs(d);var i=new qr(d).result;return d.reversedInput&&(i.open.reverse(),i.high.reverse(),i.low.reverse(),i.close.reverse(),i.volume.reverse(),i.timestamp.reverse()),F.reverseInputs(d),i}class ee{constructor(){}approximateEqual(i,a){let g=parseFloat(Math.abs(i-a).toPrecision(4))*1,w=parseFloat((i*.001).toPrecision(4))*1;return g<=w}logic(i){throw"this has to be implemented"}getAllPatternIndex(i){if(i.close.length<this.requiredCount)return console.warn("Data count less than data required for the strategy ",this.name),[];i.reversedInput&&(i.open.reverse(),i.high.reverse(),i.low.reverse(),i.close.reverse());let a=this.logic;return this._generateDataForCandleStick(i).map((g,w)=>a.call(this,g)?w:void 0).filter(g=>g)}hasPattern(i){return i.close.length<this.requiredCount?(console.warn("Data count less than data required for the strategy ",this.name),!1):(i.reversedInput&&(i.open.reverse(),i.high.reverse(),i.low.reverse(),i.close.reverse()),this.logic.call(this,this._getLastDataForCandleStick(i)))}_getLastDataForCandleStick(i){let a=this.requiredCount;if(i.close.length===a)return i;{let g={open:[],high:[],low:[],close:[]},w=0,x=i.close.length-a;for(;w<a;)g.open.push(i.open[x+w]),g.high.push(i.high[x+w]),g.low.push(i.low[x+w]),g.close.push(i.close[x+w]),w++;return g}}_generateDataForCandleStick(i){let a=this.requiredCount;return i.close.map(function(w,x){let y=0,_={open:[],high:[],low:[],close:[]};for(;y<a;)_.open.push(i.open[x+y]),_.high.push(i.high[x+y]),_.low.push(i.low[x+y]),_.close.push(i.close[x+y]),y++;return _}).filter((w,x)=>x<=i.close.length-a)}}class Ki extends ee{constructor(){super(),this.name="MorningStar",this.requiredCount=3}logic(i){let a=i.open[0],g=i.close[0];i.high[0];let w=i.low[0];i.open[1];let x=i.close[1],y=i.high[1],_=i.low[1],b=i.open[2],C=i.close[2];i.high[2],i.low[2];let D=(a+g)/2,k=g<a,B=w>_&&w>y,z=b<C,H=y<w&&_<w&&b>y&&x<b,U=C>D;return k&&B&&H&&z&&U}}function xa(d){return new Ki().hasPattern(d)}class Ji extends ee{constructor(){super(),this.name="BullishEngulfingPattern",this.requiredCount=2}logic(i){let a=i.open[0],g=i.close[0];i.high[0],i.low[0];let w=i.open[1],x=i.close[1];return i.high[1],i.low[1],g<a&&a>w&&g>w&&a<x}}function _a(d){return new Ji().hasPattern(d)}class Qi extends ee{constructor(){super(),this.requiredCount=2,this.name="BullishHarami"}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0];i.low[0];let x=i.open[1],y=i.close[1],_=i.high[1],b=i.low[1];return a>x&&g<x&&g<y&&a>b&&w>_}}function wa(d){return new Qi().hasPattern(d)}class eo extends ee{constructor(){super(),this.requiredCount=2,this.name="BullishHaramiCross"}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0];i.low[0];let x=i.open[1],y=i.close[1],_=i.high[1],b=i.low[1],C=a>x&&g<x&&g<y&&a>b&&w>_,D=this.approximateEqual(x,y);return C&&D}}function Ca(d){return new eo().hasPattern(d)}class Gt extends ee{constructor(){super(),this.name="Doji",this.requiredCount=1}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0],x=i.low[0],y=this.approximateEqual(a,g),_=y&&this.approximateEqual(a,w),b=y&&this.approximateEqual(g,x);return y&&_==b}}function Sa(d){return new Gt().hasPattern(d)}class to extends ee{constructor(){super(),this.name="MorningDojiStar",this.requiredCount=3}logic(i){let a=i.open[0],g=i.close[0];i.high[0];let w=i.low[0],x=i.open[1],y=i.close[1],_=i.high[1],b=i.low[1],C=i.open[2],D=i.close[2];i.high[2],i.low[2];let k=(a+g)/2,B=g<a,z=new Gt().hasPattern({open:[x],close:[y],high:[_],low:[b]}),H=C<D,U=_<w&&b<w&&C>_&&y<C,Z=D>k;return B&&z&&H&&U&&Z}}function ba(d){return new to().hasPattern(d)}class ro extends ee{constructor(){super(),this.requiredCount=3,this.name="DownsideTasukiGap"}logic(i){let a=i.open[0],g=i.close[0];i.high[0];let w=i.low[0],x=i.open[1],y=i.close[1],_=i.high[1];i.low[1];let b=i.open[2],C=i.close[2];i.high[2],i.low[2];let D=g<a,k=y<x,B=C>b,z=_<w,H=x>b&&y<b&&C>x&&C<g;return D&&k&&B&&z&&H}}function Ia(d){return new ro().hasPattern(d)}class no extends ee{constructor(){super(),this.name="BullishMarubozu",this.requiredCount=1}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0],x=i.low[0];return this.approximateEqual(g,w)&&this.approximateEqual(x,a)&&a<g&&a<w}}function Ta(d){return new no().hasPattern(d)}class io extends ee{constructor(){super(),this.requiredCount=2,this.name="PiercingLine"}logic(i){let a=i.open[0],g=i.close[0];i.high[0];let w=i.low[0],x=i.open[1],y=i.close[1];i.high[1];let _=i.low[1],b=(a+g)/2,C=_<w,D=g<a,k=y>x,B=w>x&&y>b;return C&&D&&B&&k}}function Ea(d){return new io().hasPattern(d)}class oo extends ee{constructor(){super(),this.name="ThreeWhiteSoldiers",this.requiredCount=3}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0];i.low[0];let x=i.open[1],y=i.close[1],_=i.high[1];i.low[1];let b=i.open[2],C=i.close[2],D=i.high[2];i.low[2];let k=_>w&&D>_,B=a<g&&x<y&&b<C,z=g>x&&x<w&&_>b&&b<y;return k&&B&&z}}function Pa(d){return new oo().hasPattern(d)}class so extends ee{constructor(){super(),this.name="BullishHammerStick",this.requiredCount=1}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0],x=i.low[0],y=g>a;return y=y&&this.approximateEqual(g,w),y=y&&g-a<=2*(a-x),y}}function jr(d){return new so().hasPattern(d)}class ao extends ee{constructor(){super(),this.name="BullishInvertedHammerStick",this.requiredCount=1}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0],x=i.low[0],y=g>a;return y=y&&this.approximateEqual(a,x),y=y&&g-a<=2*(w-g),y}}function Xr(d){return new ao().hasPattern(d)}class lo extends ee{constructor(){super(),this.name="BearishHammerStick",this.requiredCount=1}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0],x=i.low[0],y=a>g;return y=y&&this.approximateEqual(a,w),y=y&&a-g<=2*(g-x),y}}function Gr(d){return new lo().hasPattern(d)}class uo extends ee{constructor(){super(),this.name="BearishInvertedHammerStick",this.requiredCount=1}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0],x=i.low[0],y=a>g;return y=y&&this.approximateEqual(g,x),y=y&&a-g<=2*(w-a),y}}function Ur(d){return new uo().hasPattern(d)}class Zr extends ee{constructor(){super(),this.name="HammerPattern",this.requiredCount=5}logic(i){let a=this.downwardTrend(i);return a=a&&this.includesHammer(i),a=a&&this.hasConfirmation(i),a}downwardTrend(i,a=!0){let g=a?3:4,w=tt({values:i.close.slice(0,g),period:g-1});return rt({values:i.close.slice(0,g),period:g-1})>w}includesHammer(i,a=!0){let g=a?3:4,w=a?4:void 0,x={open:i.open.slice(g,w),close:i.close.slice(g,w),low:i.low.slice(g,w),high:i.high.slice(g,w)},y=Gr(x);return y=y||Ur(x),y=y||jr(x),y=y||Xr(x),y}hasConfirmation(i){let a={open:i.open[3],close:i.close[3],low:i.low[3],high:i.high[3]},g={open:i.open[4],close:i.close[4],low:i.low[4],high:i.high[4]};return g.open<g.close&&a.close<g.close}}function Ma(d){return new Zr().hasPattern(d)}class co extends Zr{constructor(){super(),this.name="HammerPatternUnconfirmed"}logic(i){let a=this.downwardTrend(i,!1);return a=a&&this.includesHammer(i,!1),a}}function Da(d){return new co().hasPattern(d)}class ho extends ee{constructor(){super(),this.name="TweezerBottom",this.requiredCount=5}logic(i){return this.downwardTrend(i)&&i.low[3]==i.low[4]}downwardTrend(i){let a=tt({values:i.close.slice(0,3),period:2});return rt({values:i.close.slice(0,3),period:2})>a}}function ka(d){return new ho().hasPattern(d)}let Aa=[new Ji,new ro,new Qi,new eo,new to,new Ki,new no,new io,new oo,new so,new ao,new Zr,new co,new ho];class Fa extends ee{constructor(){super(),this.name="Bullish Candlesticks"}hasPattern(i){return Aa.reduce(function(a,g){let w=g.hasPattern(i);return a||w},!1)}}function La(d){return new Fa().hasPattern(d)}class vo extends ee{constructor(){super(),this.name="BearishEngulfingPattern",this.requiredCount=2}logic(i){let a=i.open[0],g=i.close[0];i.high[0],i.low[0];let w=i.open[1],x=i.close[1];return i.high[1],i.low[1],g>a&&a<w&&g<w&&a>x}}function Ba(d){return new vo().hasPattern(d)}class po extends ee{constructor(){super(),this.requiredCount=2,this.name="BearishHarami"}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0];i.low[0];let x=i.open[1],y=i.close[1],_=i.high[1],b=i.low[1];return a<x&&g>x&&g>y&&a<b&&w>_}}function Ra(d){return new po().hasPattern(d)}class go extends ee{constructor(){super(),this.requiredCount=2,this.name="BearishHaramiCross"}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0];i.low[0];let x=i.open[1],y=i.close[1],_=i.high[1],b=i.low[1],C=a<x&&g>x&&g>y&&a<b&&w>_,D=this.approximateEqual(x,y);return C&&D}}function Oa(d){return new go().hasPattern(d)}class fo extends ee{constructor(){super(),this.name="EveningDojiStar",this.requiredCount=3}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0];i.low[0];let x=i.open[1],y=i.close[1],_=i.high[1],b=i.low[1],C=i.open[2],D=i.close[2];i.high[2],i.low[2];let k=(a+g)/2,B=g>a,z=new Gt().hasPattern({open:[x],close:[y],high:[_],low:[b]}),H=C>D,U=_>w&&b>w&&C<b&&y>C,Z=D<k;return B&&z&&U&&H&&Z}}function Va(d){return new fo().hasPattern(d)}class mo extends ee{constructor(){super(),this.name="EveningStar",this.requiredCount=3}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0];i.low[0],i.open[1];let x=i.close[1],y=i.high[1],_=i.low[1],b=i.open[2],C=i.close[2];i.high[2],i.low[2];let D=(a+g)/2,k=g>a,B=w<_&&w<y,z=b>C,H=y>w&&_>w&&b<_&&x>b,U=C<D;return k&&B&&H&&z&&U}}function za(d){return new mo().hasPattern(d)}class yo extends ee{constructor(){super(),this.name="BearishMarubozu",this.requiredCount=1}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0],x=i.low[0];return this.approximateEqual(a,w)&&this.approximateEqual(x,g)&&a>g&&a>x}}function Na(d){return new yo().hasPattern(d)}class xo extends ee{constructor(){super(),this.name="ThreeBlackCrows",this.requiredCount=3}logic(i){let a=i.open[0],g=i.close[0];i.high[0];let w=i.low[0],x=i.open[1],y=i.close[1];i.high[1];let _=i.low[1],b=i.open[2],C=i.close[2];i.high[2];let D=i.low[2],k=w>_&&_>D,B=a>g&&x>y&&b>C,z=a>x&&x>g&&x>b&&b>y;return k&&B&&z}}function Ha(d){return new xo().hasPattern(d)}class $r extends ee{constructor(){super(),this.name="HangingMan",this.requiredCount=5}logic(i){let a=this.upwardTrend(i);return a=a&&this.includesHammer(i),a=a&&this.hasConfirmation(i),a}upwardTrend(i,a=!0){let g=a?3:4,w=tt({values:i.close.slice(0,g),period:g-1}),x=rt({values:i.close.slice(0,g),period:g-1});return w>x}includesHammer(i,a=!0){let g=a?3:4,w=a?4:void 0,x={open:i.open.slice(g,w),close:i.close.slice(g,w),low:i.low.slice(g,w),high:i.high.slice(g,w)},y=Gr(x);return y=y||jr(x),y}hasConfirmation(i){let a={open:i.open[3],close:i.close[3],low:i.low[3],high:i.high[3]},g={open:i.open[4],close:i.close[4],low:i.low[4],high:i.high[4]};return g.open>g.close&&a.close>g.close}}function Wa(d){return new $r().hasPattern(d)}class _o extends $r{constructor(){super(),this.name="HangingManUnconfirmed"}logic(i){let a=this.upwardTrend(i,!1);return a=a&&this.includesHammer(i,!1),a}}function Ya(d){return new _o().hasPattern(d)}class Kr extends ee{constructor(){super(),this.name="ShootingStar",this.requiredCount=5}logic(i){let a=this.upwardTrend(i);return a=a&&this.includesHammer(i),a=a&&this.hasConfirmation(i),a}upwardTrend(i,a=!0){let g=a?3:4,w=tt({values:i.close.slice(0,g),period:g-1}),x=rt({values:i.close.slice(0,g),period:g-1});return w>x}includesHammer(i,a=!0){let g=a?3:4,w=a?4:void 0,x={open:i.open.slice(g,w),close:i.close.slice(g,w),low:i.low.slice(g,w),high:i.high.slice(g,w)},y=Ur(x);return y=y||Xr(x),y}hasConfirmation(i){let a={open:i.open[3],close:i.close[3],low:i.low[3],high:i.high[3]},g={open:i.open[4],close:i.close[4],low:i.low[4],high:i.high[4]};return g.open>g.close&&a.close>g.close}}function qa(d){return new Kr().hasPattern(d)}class wo extends Kr{constructor(){super(),this.name="ShootingStarUnconfirmed"}logic(i){let a=this.upwardTrend(i,!1);return a=a&&this.includesHammer(i,!1),a}}function ja(d){return new wo().hasPattern(d)}class Co extends ee{constructor(){super(),this.name="TweezerTop",this.requiredCount=5}logic(i){return this.upwardTrend(i)&&i.high[3]==i.high[4]}upwardTrend(i){let a=tt({values:i.close.slice(0,3),period:2}),g=rt({values:i.close.slice(0,3),period:2});return a>g}}function Xa(d){return new Co().hasPattern(d)}let Ga=[new vo,new po,new go,new fo,new mo,new yo,new xo,new lo,new uo,new $r,new _o,new Kr,new wo,new Co];class Ua extends ee{constructor(){super(),this.name="Bearish Candlesticks"}hasPattern(i){return Ga.reduce(function(a,g){return a||g.hasPattern(i)},!1)}}function Za(d){return new Ua().hasPattern(d)}class $a extends ee{constructor(){super(),this.name="AbandonedBaby",this.requiredCount=3}logic(i){let a=i.open[0],g=i.close[0];i.high[0];let w=i.low[0],x=i.open[1],y=i.close[1],_=i.high[1],b=i.low[1],C=i.open[2],D=i.close[2],k=i.high[2],B=i.low[2],z=g<a,H=new Gt().hasPattern({open:[x],close:[y],high:[_],low:[b]}),U=_<w&&B>_&&D>C,Z=k<a;return z&&H&&U&&Z}}function Ka(d){return new $a().hasPattern(d)}class Ja extends ee{constructor(){super(),this.name="DarkCloudCover",this.requiredCount=2}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0];i.low[0];let x=i.open[1],y=i.close[1];i.high[1],i.low[1];let _=(g+a)/2,b=g>a,C=y<x,D=x>w&&y<_&&y>a;return b&&C&&D}}function Qa(d){return new Ja().hasPattern(d)}class el extends ee{constructor(){super(),this.requiredCount=1,this.name="DragonFlyDoji"}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0],x=i.low[0],y=this.approximateEqual(a,g),_=y&&this.approximateEqual(a,w),b=y&&this.approximateEqual(g,x);return y&&_&&!b}}function tl(d){return new el().hasPattern(d)}class rl extends ee{constructor(){super(),this.requiredCount=1,this.name="GraveStoneDoji"}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0],x=i.low[0],y=this.approximateEqual(a,g),_=y&&this.approximateEqual(a,w),b=y&&this.approximateEqual(g,x);return y&&b&&!_}}function nl(d){return new rl().hasPattern(d)}class il extends ee{constructor(){super(),this.name="BullishSpinningTop",this.requiredCount=1}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0],x=i.low[0],y=Math.abs(g-a),_=Math.abs(w-g),b=Math.abs(a-x);return y<_&&y<b}}function ol(d){return new il().hasPattern(d)}class sl extends ee{constructor(){super(),this.name="BearishSpinningTop",this.requiredCount=1}logic(i){let a=i.open[0],g=i.close[0],w=i.high[0],x=i.low[0],y=Math.abs(g-a),_=Math.abs(w-a),b=Math.abs(w-x);return y<_&&y<b}}function al(d){return new sl().hasPattern(d)}function ll(d,i){let a=[0,23.6,38.2,50,61.8,78.6,100,127.2,161.8,261.8,423.6],g;return d<i?g=a.map(function(w){let x=i-Math.abs(d-i)*w/100;return x>0?x:0}):g=a.map(function(w){let x=i+Math.abs(d-i)*w/100;return x>0?x:0}),g}class Jr extends F{constructor(i){super(i),this.result=[];var a={conversionPeriod:9,basePeriod:26,spanPeriod:52,displacement:26},g=Object.assign({},a,i),w=new pe(g.conversionPeriod*2,!0,!0,!1),x=new pe(g.basePeriod*2,!0,!0,!1),y=new pe(g.spanPeriod*2,!0,!0,!1);this.generator=function*(){let _,b,C=Math.max(g.conversionPeriod,g.basePeriod,g.spanPeriod,g.displacement),D=1;for(b=yield;;){if(w.push(b.high),w.push(b.low),x.push(b.high),x.push(b.low),y.push(b.high),y.push(b.low),D<C)D++;else{let k=(w.periodHigh+w.periodLow)/2,B=(x.periodHigh+x.periodLow)/2,z=(k+B)/2,H=(y.periodHigh+y.periodLow)/2;_={conversion:k,base:B,spanA:z,spanB:H}}b=yield _}}(),this.generator.next(),i.low.forEach((_,b)=>{var C=this.generator.next({high:i.high[b],low:i.low[b]});C.value&&this.result.push(C.value)})}nextValue(i){return this.generator.next(i).value}}Jr.calculate=So;function So(d){F.reverseInputs(d);var i=new Jr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class ul extends Ht{constructor(){super(...arguments),this.maPeriod=20,this.atrPeriod=10,this.useSMA=!1,this.multiplier=1}}class cl extends Ht{}class Qr extends F{constructor(i){super(i);var a=i.useSMA?ce:Ne,g=new a({period:i.maPeriod,values:[],format:_=>_}),w=new Pt({period:i.atrPeriod,high:[],low:[],close:[],format:_=>_}),x;this.result=[],this.generator=function*(){var _;for(x=yield;;){var{close:b}=x,C=g.nextValue(b),D=w.nextValue(x);C!=null&&D!=null&&(_={middle:C,upper:C+i.multiplier*D,lower:C-i.multiplier*D}),x=yield _}}(),this.generator.next();var y=i.high;y.forEach((_,b)=>{var C={high:_,low:i.low[b],close:i.close[b]},D=this.generator.next(C);D.value!=null&&this.result.push(D.value)})}nextValue(i){var a=this.generator.next(i);if(a.value!=null)return a.value}}Qr.calculate=bo;function bo(d){F.reverseInputs(d);var i=new Qr(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class hl extends Ht{constructor(){super(...arguments),this.period=22,this.multiplier=3}}class dl extends Ht{}class en extends F{constructor(i){super(i);var a=i.high,g=i.low,w=i.close;this.result=[];var x=new Pt({period:i.period,high:[],low:[],close:[],format:_=>_}),y=new pe(i.period*2,!0,!0,!1);this.generator=function*(){for(var _,b=yield,C;;){var{high:D,low:k}=b;y.push(D),y.push(k),C=x.nextValue(b),y.totalPushed>=2*i.period&&C!=null&&(_={exitLong:y.periodHigh-C*i.multiplier,exitShort:y.periodLow+C*i.multiplier}),b=yield _}}(),this.generator.next(),a.forEach((_,b)=>{var C={high:_,low:g[b],close:w[b]},D=this.generator.next(C);D.value!=null&&this.result.push(D.value)})}nextValue(i){var a=this.generator.next(i);if(a.value!=null)return a.value}}en.calculate=Io;function Io(d){F.reverseInputs(d);var i=new en(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class tn extends F{constructor(i){super(i),this.lineA=i.lineA,this.lineB=i.lineB;var a=[],g=[];const w=function*(){for(var x=yield,y=!1;;){a.unshift(x.valueA),g.unshift(x.valueB),y=x.valueA>x.valueB;for(var _=1;y===!0&&a[_]>=g[_];)a[_]>g[_]?y=!1:a[_]<g[_]?y=!0:a[_]===g[_]&&(_+=1);y===!0&&(a=[x.valueA],g=[x.valueB]),x=yield y}};this.generator=w(),this.generator.next(),this.result=[],this.lineA.forEach((x,y)=>{var _=this.generator.next({valueA:this.lineA[y],valueB:this.lineB[y]});_.value!==void 0&&this.result.push(_.value)})}static reverseInputs(i){i.reversedInput&&(i.lineA&&i.lineA.reverse(),i.lineB&&i.lineB.reverse())}nextValue(i,a){return this.generator.next({valueA:i,valueB:a}).value}}tn.calculate=To;function To(d){F.reverseInputs(d);var i=new tn(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}class rn extends F{constructor(i){super(i),this.lineA=i.lineA,this.lineB=i.lineB;var a=[],g=[];const w=function*(){for(var x=yield,y=!1;;){a.unshift(x.valueA),g.unshift(x.valueB),y=x.valueA<x.valueB;for(var _=1;y===!0&&a[_]<=g[_];)a[_]<g[_]?y=!1:a[_]>g[_]?y=!0:a[_]===g[_]&&(_+=1);y===!0&&(a=[x.valueA],g=[x.valueB]),x=yield y}};this.generator=w(),this.generator.next(),this.result=[],this.lineA.forEach((x,y)=>{var _=this.generator.next({valueA:this.lineA[y],valueB:this.lineB[y]});_.value!==void 0&&this.result.push(_.value)})}static reverseInputs(i){i.reversedInput&&(i.lineA&&i.lineA.reverse(),i.lineB&&i.lineB.reverse())}nextValue(i,a){return this.generator.next({valueA:i,valueB:a}).value}}rn.calculate=Eo;function Eo(d){F.reverseInputs(d);var i=new rn(d).result;return d.reversedInput&&i.reverse(),F.reverseInputs(d),i}const vl=Object.freeze(Object.defineProperty({__proto__:null,ADL:Dr,ADX:Ir,ATR:Pt,AverageGain:Wt,AverageLoss:Yt,AwesomeOscillator:Br,BollingerBands:Cr,CCI:Lr,CandleData:va,CandleList:xr,ChandelierExit:en,ChandelierExitInput:hl,ChandelierExitOutput:dl,CrossDown:rn,CrossUp:tn,EMA:Ne,FixedSizeLinkedList:pe,ForceIndex:Fr,HeikinAshi:qr,Highest:Hr,IchimokuCloud:Jr,KST:Er,KeltnerChannels:Qr,KeltnerChannelsInput:ul,KeltnerChannelsOutput:cl,Lowest:Wr,MACD:wr,MFI:zr,OBV:kr,PSAR:Pr,ROC:je,RSI:qt,SD:jt,SMA:ce,Stochastic:Xt,StochasticRSI:Nr,Sum:Yr,TRIX:Ar,TrueRange:Et,VWAP:Rr,VolumeProfile:Or,WEMA:Tt,WMA:_r,WilliamsR:Mr,abandonedbaby:Ka,adl:Bi,adx:Mi,atr:Tr,averagegain:tt,averageloss:rt,awesomeoscillator:Ni,bearish:Za,bearishengulfingpattern:Ba,bearishhammerstick:Gr,bearishharami:Ra,bearishharamicross:Oa,bearishinvertedhammerstick:Ur,bearishmarubozu:Na,bearishspinningtop:al,bollingerbands:Ei,bullish:La,bullishengulfingpattern:_a,bullishhammerstick:jr,bullishharami:wa,bullishharamicross:Ca,bullishinvertedhammerstick:Xr,bullishmarubozu:Ta,bullishspinningtop:ol,cci:zi,chandelierexit:Io,crossDown:Eo,crossUp:To,darkcloudcover:Qa,doji:Sa,downsidetasukigap:Ia,dragonflydoji:tl,ema:wi,eveningdojistar:Va,eveningstar:za,fibonacciretracement:ll,forceindex:Vi,getConfig:xi,gravestonedoji:nl,hammerpattern:Ma,hammerpatternunconfirmed:Da,hangingman:Wa,hangingmanunconfirmed:Ya,heikinashi:$i,highest:ji,ichimokucloud:So,keltnerchannels:bo,kst:ki,lowest:Xi,macd:bi,mfi:Yi,morningdojistar:ba,morningstar:xa,obv:Ri,piercingline:Ea,psar:Ai,renko:Zi,roc:Di,rsi:Ii,sd:Ti,setConfig:pa,shootingstar:qa,shootingstarunconfirmed:ja,sma:_i,stochastic:Fi,stochasticrsi:qi,sum:Gi,threeblackcrows:Ha,threewhitesoldiers:Pa,trix:Oi,truerange:Pi,tweezerbottom:ka,tweezertop:Xa,volumeprofile:Wi,vwap:Hi,wema:Si,williamsr:Li,wma:Ci},Symbol.toStringTag,{value:"Module"}));new ua({target:document.getElementById("app")});window.technical=vl;
